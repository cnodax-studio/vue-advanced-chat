(function(fr,si){typeof exports=="object"&&typeof module!="undefined"?si(exports):typeof define=="function"&&define.amd?define(["exports"],si):(fr=typeof globalThis!="undefined"?globalThis:fr||self,si(fr["vue-advanced-chat"]={}))})(this,function(fr){"use strict";function si(e,t){const n=Object.create(null),r=e.split(",");for(let a=0;a<r.length;a++)n[r[a]]=!0;return t?a=>!!n[a.toLowerCase()]:a=>!!n[a]}const x1=()=>{},y1=Object.assign,w1=Object.prototype.hasOwnProperty,Gi=(e,t)=>w1.call(e,t),Wn=Array.isArray,Wi=e=>$o(e)==="[object Map]",k1=e=>typeof e=="function",S1=e=>typeof e=="string",ts=e=>typeof e=="symbol",Zi=e=>e!==null&&typeof e=="object",A1=Object.prototype.toString,$o=e=>A1.call(e),M1=e=>$o(e).slice(8,-1),ns=e=>S1(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,el=(e,t)=>!Object.is(e,t),E1=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})};let Sn;class T1{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Sn&&(this.parent=Sn,this.index=(Sn.scopes||(Sn.scopes=[])).push(this)-1)}run(t){if(this.active){const n=Sn;try{return Sn=this,t()}finally{Sn=n}}}on(){Sn=this}off(){Sn=this.parent}stop(t){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function R1(e,t=Sn){t&&t.active&&t.effects.push(e)}const rs=e=>{const t=new Set(e);return t.w=0,t.n=0,t},tl=e=>(e.w&Zn)>0,nl=e=>(e.n&Zn)>0,C1=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Zn},I1=e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const a=t[r];tl(a)&&!nl(a)?a.delete(e):t[n++]=a,a.w&=~Zn,a.n&=~Zn}t.length=n}},is=new WeakMap;let oi=0,Zn=1;const as=30;let pn;const mr=Symbol(""),ss=Symbol("");class os{constructor(t,n=null,r){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,R1(this,r)}run(){if(!this.active)return this.fn();let t=pn,n=Qn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=pn,pn=this,Qn=!0,Zn=1<<++oi,oi<=as?C1(this):rl(this),this.fn()}finally{oi<=as&&I1(this),Zn=1<<--oi,pn=this.parent,Qn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){pn===this?this.deferStop=!0:this.active&&(rl(this),this.onStop&&this.onStop(),this.active=!1)}}function rl(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Qn=!0;const il=[];function Dr(){il.push(Qn),Qn=!1}function Hr(){const e=il.pop();Qn=e===void 0?!0:e}function tn(e,t,n){if(Qn&&pn){let r=is.get(e);r||is.set(e,r=new Map);let a=r.get(n);a||r.set(n,a=rs()),al(a)}}function al(e,t){let n=!1;oi<=as?nl(e)||(e.n|=Zn,n=!tl(e)):n=!e.has(pn),n&&(e.add(pn),pn.deps.push(e))}function Dn(e,t,n,r,a,i){const s=is.get(e);if(!s)return;let l=[];if(t==="clear")l=[...s.values()];else if(n==="length"&&Wn(e))s.forEach((f,u)=>{(u==="length"||u>=r)&&l.push(f)});else switch(n!==void 0&&l.push(s.get(n)),t){case"add":Wn(e)?ns(n)&&l.push(s.get("length")):(l.push(s.get(mr)),Wi(e)&&l.push(s.get(ss)));break;case"delete":Wn(e)||(l.push(s.get(mr)),Wi(e)&&l.push(s.get(ss)));break;case"set":Wi(e)&&l.push(s.get(mr));break}if(l.length===1)l[0]&&ls(l[0]);else{const f=[];for(const u of l)u&&f.push(...u);ls(rs(f))}}function ls(e,t){const n=Wn(e)?e:[...e];for(const r of n)r.computed&&sl(r);for(const r of n)r.computed||sl(r)}function sl(e,t){(e!==pn||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const B1=si("__proto__,__v_isRef,__isVue"),ol=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ts)),O1=cs(),L1=cs(!1,!0),F1=cs(!0),ll=j1();function j1(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const r=mt(this);for(let i=0,s=this.length;i<s;i++)tn(r,"get",i+"");const a=r[t](...n);return a===-1||a===!1?r[t](...n.map(mt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Dr();const r=mt(this)[t].apply(this,n);return Hr(),r}}),e}function cs(e=!1,t=!1){return function(r,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?J1:_l:t?pl:vl).get(r))return r;const s=Wn(r);if(!e&&s&&Gi(ll,a))return Reflect.get(ll,a,i);const l=Reflect.get(r,a,i);return(ts(a)?ol.has(a):B1(a))||(e||tn(r,"get",a),t)?l:qt(l)?s&&ns(a)?l:l.value:Zi(l)?e?gl(l):fs(l):l}}const N1=cl(),D1=cl(!0);function cl(e=!1){return function(n,r,a,i){let s=n[r];if(li(s)&&qt(s)&&!qt(a))return!1;if(!e&&!li(a)&&(hs(a)||(a=mt(a),s=mt(s)),!Wn(n)&&qt(s)&&!qt(a)))return s.value=a,!0;const l=Wn(n)&&ns(r)?Number(r)<n.length:Gi(n,r),f=Reflect.set(n,r,a,i);return n===mt(i)&&(l?el(a,s)&&Dn(n,"set",r,a):Dn(n,"add",r,a)),f}}function H1(e,t){const n=Gi(e,t);e[t];const r=Reflect.deleteProperty(e,t);return r&&n&&Dn(e,"delete",t,void 0),r}function z1(e,t){const n=Reflect.has(e,t);return(!ts(t)||!ol.has(t))&&tn(e,"has",t),n}function P1(e){return tn(e,"iterate",Wn(e)?"length":mr),Reflect.ownKeys(e)}const ul={get:O1,set:N1,deleteProperty:H1,has:z1,ownKeys:P1},V1={get:F1,set(e,t){return!0},deleteProperty(e,t){return!0}},U1=y1({},ul,{get:L1,set:D1}),us=e=>e,Qi=e=>Reflect.getPrototypeOf(e);function Ji(e,t,n=!1,r=!1){e=e.__v_raw;const a=mt(e),i=mt(t);n||(t!==i&&tn(a,"get",t),tn(a,"get",i));const{has:s}=Qi(a),l=r?us:n?ps:vs;if(s.call(a,t))return l(e.get(t));if(s.call(a,i))return l(e.get(i));e!==a&&e.get(t)}function $i(e,t=!1){const n=this.__v_raw,r=mt(n),a=mt(e);return t||(e!==a&&tn(r,"has",e),tn(r,"has",a)),e===a?n.has(e):n.has(e)||n.has(a)}function ea(e,t=!1){return e=e.__v_raw,!t&&tn(mt(e),"iterate",mr),Reflect.get(e,"size",e)}function dl(e){e=mt(e);const t=mt(this);return Qi(t).has.call(t,e)||(t.add(e),Dn(t,"add",e,e)),this}function fl(e,t){t=mt(t);const n=mt(this),{has:r,get:a}=Qi(n);let i=r.call(n,e);i||(e=mt(e),i=r.call(n,e));const s=a.call(n,e);return n.set(e,t),i?el(t,s)&&Dn(n,"set",e,t):Dn(n,"add",e,t),this}function ml(e){const t=mt(this),{has:n,get:r}=Qi(t);let a=n.call(t,e);a||(e=mt(e),a=n.call(t,e)),r&&r.call(t,e);const i=t.delete(e);return a&&Dn(t,"delete",e,void 0),i}function hl(){const e=mt(this),t=e.size!==0,n=e.clear();return t&&Dn(e,"clear",void 0,void 0),n}function ta(e,t){return function(r,a){const i=this,s=i.__v_raw,l=mt(s),f=t?us:e?ps:vs;return!e&&tn(l,"iterate",mr),s.forEach((u,m)=>r.call(a,f(u),f(m),i))}}function na(e,t,n){return function(...r){const a=this.__v_raw,i=mt(a),s=Wi(i),l=e==="entries"||e===Symbol.iterator&&s,f=e==="keys"&&s,u=a[e](...r),m=n?us:t?ps:vs;return!t&&tn(i,"iterate",f?ss:mr),{next(){const{value:c,done:b}=u.next();return b?{value:c,done:b}:{value:l?[m(c[0]),m(c[1])]:m(c),done:b}},[Symbol.iterator](){return this}}}}function Jn(e){return function(...t){return e==="delete"?!1:this}}function q1(){const e={get(i){return Ji(this,i)},get size(){return ea(this)},has:$i,add:dl,set:fl,delete:ml,clear:hl,forEach:ta(!1,!1)},t={get(i){return Ji(this,i,!1,!0)},get size(){return ea(this)},has:$i,add:dl,set:fl,delete:ml,clear:hl,forEach:ta(!1,!0)},n={get(i){return Ji(this,i,!0)},get size(){return ea(this,!0)},has(i){return $i.call(this,i,!0)},add:Jn("add"),set:Jn("set"),delete:Jn("delete"),clear:Jn("clear"),forEach:ta(!0,!1)},r={get(i){return Ji(this,i,!0,!0)},get size(){return ea(this,!0)},has(i){return $i.call(this,i,!0)},add:Jn("add"),set:Jn("set"),delete:Jn("delete"),clear:Jn("clear"),forEach:ta(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=na(i,!1,!1),n[i]=na(i,!0,!1),t[i]=na(i,!1,!0),r[i]=na(i,!0,!0)}),[e,n,t,r]}const[X1,Y1,K1,G1]=q1();function ds(e,t){const n=t?e?G1:K1:e?Y1:X1;return(r,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?r:Reflect.get(Gi(n,a)&&a in r?n:r,a,i)}const W1={get:ds(!1,!1)},Z1={get:ds(!1,!0)},Q1={get:ds(!0,!1)},vl=new WeakMap,pl=new WeakMap,_l=new WeakMap,J1=new WeakMap;function $1(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ed(e){return e.__v_skip||!Object.isExtensible(e)?0:$1(M1(e))}function fs(e){return li(e)?e:ms(e,!1,ul,W1,vl)}function td(e){return ms(e,!1,U1,Z1,pl)}function gl(e){return ms(e,!0,V1,Q1,_l)}function ms(e,t,n,r,a){if(!Zi(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=ed(e);if(s===0)return e;const l=new Proxy(e,s===2?r:n);return a.set(e,l),l}function zr(e){return li(e)?zr(e.__v_raw):!!(e&&e.__v_isReactive)}function li(e){return!!(e&&e.__v_isReadonly)}function hs(e){return!!(e&&e.__v_isShallow)}function bl(e){return zr(e)||li(e)}function mt(e){const t=e&&e.__v_raw;return t?mt(t):e}function xl(e){return E1(e,"__v_skip",!0),e}const vs=e=>Zi(e)?fs(e):e,ps=e=>Zi(e)?gl(e):e;function nd(e){Qn&&pn&&(e=mt(e),al(e.dep||(e.dep=rs())))}function rd(e,t){e=mt(e),e.dep&&ls(e.dep)}function qt(e){return!!(e&&e.__v_isRef===!0)}function id(e){return qt(e)?e.value:e}const ad={get:(e,t,n)=>id(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const a=e[t];return qt(a)&&!qt(n)?(a.value=n,!0):Reflect.set(e,t,n,r)}};function yl(e){return zr(e)?e:new Proxy(e,ad)}class sd{constructor(t,n,r,a){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new os(t,()=>{this._dirty||(this._dirty=!0,rd(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=r}get value(){const t=mt(this);return nd(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function od(e,t,n=!1){let r,a;const i=k1(e);return i?(r=e,a=x1):(r=e.get,a=e.set),new sd(r,a,i||!a,n)}function ld(e,t){const n=Object.create(null),r=e.split(",");for(let a=0;a<r.length;a++)n[r[a]]=!0;return t?a=>!!n[a.toLowerCase()]:a=>!!n[a]}function St(e){if(ot(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],a=Xt(r)?dd(r):St(r);if(a)for(const i in a)t[i]=a[i]}return t}else{if(Xt(e))return e;if(Yt(e))return e}}const cd=/;(?![^(]*\))/g,ud=/:(.+)/;function dd(e){const t={};return e.split(cd).forEach(n=>{if(n){const r=n.split(ud);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function nt(e){let t="";if(Xt(e))t=e;else if(ot(e))for(let n=0;n<e.length;n++){const r=nt(e[n]);r&&(t+=r+" ")}else if(Yt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function pt(e){if(!e)return null;let{class:t,style:n}=e;return t&&!Xt(t)&&(e.class=nt(t)),n&&(e.style=St(n)),e}const Qe=e=>Xt(e)?e:e==null?"":ot(e)||Yt(e)&&(e.toString===El||!it(e.toString))?JSON.stringify(e,wl,2):String(e),wl=(e,t)=>t&&t.__v_isRef?wl(e,t.value):Sl(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[r,a])=>(n[`${r} =>`]=a,n),{})}:Al(t)?{[`Set(${t.size})`]:[...t.values()]}:Yt(t)&&!ot(t)&&!Tl(t)?String(t):t,bt={},Pr=[],An=()=>{},fd=()=>!1,md=/^on[^a-z]/,_s=e=>md.test(e),kl=e=>e.startsWith("onUpdate:"),nn=Object.assign,gs=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},hd=Object.prototype.hasOwnProperty,ht=(e,t)=>hd.call(e,t),ot=Array.isArray,Sl=e=>bs(e)==="[object Map]",Al=e=>bs(e)==="[object Set]",it=e=>typeof e=="function",Xt=e=>typeof e=="string",Yt=e=>e!==null&&typeof e=="object",Ml=e=>Yt(e)&&it(e.then)&&it(e.catch),El=Object.prototype.toString,bs=e=>El.call(e),Tl=e=>bs(e)==="[object Object]",ra=ld(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ia=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},vd=/-(\w)/g,Mn=ia(e=>e.replace(vd,(t,n)=>n?n.toUpperCase():"")),pd=/\B([A-Z])/g,aa=ia(e=>e.replace(pd,"-$1").toLowerCase()),xs=ia(e=>e.charAt(0).toUpperCase()+e.slice(1)),ys=ia(e=>e?`on${xs(e)}`:""),Rl=(e,t)=>!Object.is(e,t),ws=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},ks=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},_d=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Cl;const gd=()=>Cl||(Cl=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function $n(e,t,n,r){let a;try{a=r?e(...r):e()}catch(i){sa(i,t,n)}return a}function un(e,t,n,r){if(it(e)){const i=$n(e,t,n,r);return i&&Ml(i)&&i.catch(s=>{sa(s,t,n)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(un(e[i],t,n,r));return a}function sa(e,t,n,r=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,l=n;for(;i;){const u=i.ec;if(u){for(let m=0;m<u.length;m++)if(u[m](e,s,l)===!1)return}i=i.parent}const f=t.appContext.config.errorHandler;if(f){$n(f,null,10,[e,s,l]);return}}bd(e,n,a,r)}function bd(e,t,n,r=!0){console.error(e)}let oa=!1,Ss=!1;const rn=[];let Hn=0;const ci=[];let ui=null,Vr=0;const di=[];let er=null,Ur=0;const Il=Promise.resolve();let As=null,Ms=null;function Bl(e){const t=As||Il;return e?t.then(this?e.bind(this):e):t}function xd(e){let t=Hn+1,n=rn.length;for(;t<n;){const r=t+n>>>1;fi(rn[r])<e?t=r+1:n=r}return t}function Ol(e){(!rn.length||!rn.includes(e,oa&&e.allowRecurse?Hn+1:Hn))&&e!==Ms&&(e.id==null?rn.push(e):rn.splice(xd(e.id),0,e),Ll())}function Ll(){!oa&&!Ss&&(Ss=!0,As=Il.then(Nl))}function yd(e){const t=rn.indexOf(e);t>Hn&&rn.splice(t,1)}function Fl(e,t,n,r){ot(e)?n.push(...e):(!t||!t.includes(e,e.allowRecurse?r+1:r))&&n.push(e),Ll()}function wd(e){Fl(e,ui,ci,Vr)}function kd(e){Fl(e,er,di,Ur)}function la(e,t=null){if(ci.length){for(Ms=t,ui=[...new Set(ci)],ci.length=0,Vr=0;Vr<ui.length;Vr++)ui[Vr]();ui=null,Vr=0,Ms=null,la(e,t)}}function jl(e){if(la(),di.length){const t=[...new Set(di)];if(di.length=0,er){er.push(...t);return}for(er=t,er.sort((n,r)=>fi(n)-fi(r)),Ur=0;Ur<er.length;Ur++)er[Ur]();er=null,Ur=0}}const fi=e=>e.id==null?1/0:e.id;function Nl(e){Ss=!1,oa=!0,la(e),rn.sort((n,r)=>fi(n)-fi(r));const t=An;try{for(Hn=0;Hn<rn.length;Hn++){const n=rn[Hn];n&&n.active!==!1&&$n(n,null,14)}}finally{Hn=0,rn.length=0,jl(),oa=!1,As=null,(rn.length||ci.length||di.length)&&Nl(e)}}function Sd(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||bt;let a=n;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in r){const m=`${s==="modelValue"?"model":s}Modifiers`,{number:c,trim:b}=r[m]||bt;b&&(a=n.map(_=>_.trim())),c&&(a=n.map(_d))}let l,f=r[l=ys(t)]||r[l=ys(Mn(t))];!f&&i&&(f=r[l=ys(aa(t))]),f&&un(f,e,6,a);const u=r[l+"Once"];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,un(u,e,6,a)}}function Dl(e,t,n=!1){const r=t.emitsCache,a=r.get(e);if(a!==void 0)return a;const i=e.emits;let s={},l=!1;if(!it(e)){const f=u=>{const m=Dl(u,t,!0);m&&(l=!0,nn(s,m))};!n&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}return!i&&!l?(r.set(e,null),null):(ot(i)?i.forEach(f=>s[f]=null):nn(s,i),r.set(e,s),s)}function ca(e,t){return!e||!_s(t)?!1:(t=t.slice(2).replace(/Once$/,""),ht(e,t[0].toLowerCase()+t.slice(1))||ht(e,aa(t))||ht(e,t))}let Ht=null,Hl=null;function ua(e){const t=Ht;return Ht=e,Hl=e&&e.type.__scopeId||null,t}function Ke(e,t=Ht,n){if(!t||e._n)return e;const r=(...a)=>{r._d&&_0(-1);const i=ua(t),s=e(...a);return ua(i),r._d&&_0(1),s};return r._n=!0,r._c=!0,r._d=!0,r}function B5(){}function Es(e){const{type:t,vnode:n,proxy:r,withProxy:a,props:i,propsOptions:[s],slots:l,attrs:f,emit:u,render:m,renderCache:c,data:b,setupState:_,ctx:o,inheritAttrs:B}=e;let T,C;const p=ua(e);try{if(n.shapeFlag&4){const F=a||r;T=En(m.call(F,F,c,i,_,b,o)),C=f}else{const F=t;T=En(F.length>1?F(i,{attrs:f,slots:l,emit:u}):F(i,null)),C=t.props?f:Ad(f)}}catch(F){pi.length=0,sa(F,e,1),T=Oe(fn)}let A=T;if(C&&B!==!1){const F=Object.keys(C),{shapeFlag:R}=A;F.length&&R&7&&(s&&F.some(kl)&&(C=Md(C,s)),A=tr(A,C))}return n.dirs&&(A=tr(A),A.dirs=A.dirs?A.dirs.concat(n.dirs):n.dirs),n.transition&&(A.transition=n.transition),T=A,ua(p),T}const Ad=e=>{let t;for(const n in e)(n==="class"||n==="style"||_s(n))&&((t||(t={}))[n]=e[n]);return t},Md=(e,t)=>{const n={};for(const r in e)(!kl(r)||!(r.slice(9)in t))&&(n[r]=e[r]);return n};function Ed(e,t,n){const{props:r,children:a,component:i}=e,{props:s,children:l,patchFlag:f}=t,u=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&f>=0){if(f&1024)return!0;if(f&16)return r?zl(r,s,u):!!s;if(f&8){const m=t.dynamicProps;for(let c=0;c<m.length;c++){const b=m[c];if(s[b]!==r[b]&&!ca(u,b))return!0}}}else return(a||l)&&(!l||!l.$stable)?!0:r===s?!1:r?s?zl(r,s,u):!0:!!s;return!1}function zl(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let a=0;a<r.length;a++){const i=r[a];if(t[i]!==e[i]&&!ca(n,i))return!0}return!1}function Td({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const Rd=e=>e.__isSuspense;function Cd(e,t){t&&t.pendingBranch?ot(e)?t.effects.push(...e):t.effects.push(e):kd(e)}function Id(e,t){if(Ft){let n=Ft.provides;const r=Ft.parent&&Ft.parent.provides;r===n&&(n=Ft.provides=Object.create(r)),n[e]=t}}function Ts(e,t,n=!1){const r=Ft||Ht;if(r){const a=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return n&&it(t)?t.call(r.proxy):t}}const Pl={};function Rs(e,t,n){return Vl(e,t,n)}function Vl(e,t,{immediate:n,deep:r,flush:a,onTrack:i,onTrigger:s}=bt){const l=Ft;let f,u=!1,m=!1;if(qt(e)?(f=()=>e.value,u=hs(e)):zr(e)?(f=()=>e,r=!0):ot(e)?(m=!0,u=e.some(C=>zr(C)||hs(C)),f=()=>e.map(C=>{if(qt(C))return C.value;if(zr(C))return hr(C);if(it(C))return $n(C,l,2)})):it(e)?t?f=()=>$n(e,l,2):f=()=>{if(!(l&&l.isUnmounted))return c&&c(),un(e,l,3,[b])}:f=An,t&&r){const C=f;f=()=>hr(C())}let c,b=C=>{c=T.onStop=()=>{$n(C,l,4)}};if(gi)return b=An,t?n&&un(t,l,3,[f(),m?[]:void 0,b]):f(),An;let _=m?[]:Pl;const o=()=>{if(!!T.active)if(t){const C=T.run();(r||u||(m?C.some((p,A)=>Rl(p,_[A])):Rl(C,_)))&&(c&&c(),un(t,l,3,[C,_===Pl?void 0:_,b]),_=C)}else T.run()};o.allowRecurse=!!t;let B;a==="sync"?B=o:a==="post"?B=()=>Wt(o,l&&l.suspense):B=()=>wd(o);const T=new os(f,B);return t?n?o():_=T.run():a==="post"?Wt(T.run.bind(T),l&&l.suspense):T.run(),()=>{T.stop(),l&&l.scope&&gs(l.scope.effects,T)}}function Bd(e,t,n){const r=this.proxy,a=Xt(e)?e.includes(".")?Ul(r,e):()=>r[e]:e.bind(r,r);let i;it(t)?i=t:(i=t.handler,n=t);const s=Ft;qr(this);const l=Vl(a,i.bind(r),n);return s?qr(s):br(),l}function Ul(e,t){const n=t.split(".");return()=>{let r=e;for(let a=0;a<n.length&&r;a++)r=r[n[a]];return r}}function hr(e,t){if(!Yt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),qt(e))hr(e.value,t);else if(ot(e))for(let n=0;n<e.length;n++)hr(e[n],t);else if(Al(e)||Sl(e))e.forEach(n=>{hr(n,t)});else if(Tl(e))for(const n in e)hr(e[n],t);return e}function ql(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wl(()=>{e.isMounted=!0}),Ql(()=>{e.isUnmounting=!0}),e}const dn=[Function,Array],Xl={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:dn,onEnter:dn,onAfterEnter:dn,onEnterCancelled:dn,onBeforeLeave:dn,onLeave:dn,onAfterLeave:dn,onLeaveCancelled:dn,onBeforeAppear:dn,onAppear:dn,onAfterAppear:dn,onAppearCancelled:dn},setup(e,{slots:t}){const n=x0(),r=ql();let a;return()=>{const i=t.default&&Is(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const B of i)if(B.type!==fn){s=B;break}}const l=mt(e),{mode:f}=l;if(r.isLeaving)return Cs(s);const u=Kl(s);if(!u)return Cs(s);const m=mi(u,l,r,n);hi(u,m);const c=n.subTree,b=c&&Kl(c);let _=!1;const{getTransitionKey:o}=u.type;if(o){const B=o();a===void 0?a=B:B!==a&&(a=B,_=!0)}if(b&&b.type!==fn&&(!gr(u,b)||_)){const B=mi(b,l,r,n);if(hi(b,B),f==="out-in")return r.isLeaving=!0,B.afterLeave=()=>{r.isLeaving=!1,n.update()},Cs(s);f==="in-out"&&u.type!==fn&&(B.delayLeave=(T,C,p)=>{const A=Yl(r,b);A[String(b.key)]=b,T._leaveCb=()=>{C(),T._leaveCb=void 0,delete m.delayedLeave},m.delayedLeave=p})}return s}}};function Yl(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function mi(e,t,n,r){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:l,onEnter:f,onAfterEnter:u,onEnterCancelled:m,onBeforeLeave:c,onLeave:b,onAfterLeave:_,onLeaveCancelled:o,onBeforeAppear:B,onAppear:T,onAfterAppear:C,onAppearCancelled:p}=t,A=String(e.key),F=Yl(n,e),R=(M,S)=>{M&&un(M,r,9,S)},I=(M,S)=>{const v=S[1];R(M,S),ot(M)?M.every(y=>y.length<=1)&&v():M.length<=1&&v()},h={mode:i,persisted:s,beforeEnter(M){let S=l;if(!n.isMounted)if(a)S=B||l;else return;M._leaveCb&&M._leaveCb(!0);const v=F[A];v&&gr(e,v)&&v.el._leaveCb&&v.el._leaveCb(),R(S,[M])},enter(M){let S=f,v=u,y=m;if(!n.isMounted)if(a)S=T||f,v=C||u,y=p||m;else return;let x=!1;const w=M._enterCb=k=>{x||(x=!0,k?R(y,[M]):R(v,[M]),h.delayedLeave&&h.delayedLeave(),M._enterCb=void 0)};S?I(S,[M,w]):w()},leave(M,S){const v=String(e.key);if(M._enterCb&&M._enterCb(!0),n.isUnmounting)return S();R(c,[M]);let y=!1;const x=M._leaveCb=w=>{y||(y=!0,S(),w?R(o,[M]):R(_,[M]),M._leaveCb=void 0,F[v]===e&&delete F[v])};F[v]=e,b?I(b,[M,x]):x()},clone(M){return mi(M,t,n,r)}};return h}function Cs(e){if(da(e))return e=tr(e),e.children=null,e}function Kl(e){return da(e)?e.children?e.children[0]:void 0:e}function hi(e,t){e.shapeFlag&6&&e.component?hi(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Is(e,t=!1,n){let r=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const l=n==null?s.key:String(n)+String(s.key!=null?s.key:i);s.type===st?(s.patchFlag&128&&a++,r=r.concat(Is(s.children,t,l))):(t||s.type!==fn)&&r.push(l!=null?tr(s,{key:l}):s)}if(a>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function Od(e){return it(e)?{setup:e,name:e.name}:e}const vi=e=>!!e.type.__asyncLoader,da=e=>e.type.__isKeepAlive;function Ld(e,t){Gl(e,"a",t)}function Fd(e,t){Gl(e,"da",t)}function Gl(e,t,n=Ft){const r=e.__wdc||(e.__wdc=()=>{let a=n;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(fa(t,r,n),n){let a=n.parent;for(;a&&a.parent;)da(a.parent.vnode)&&jd(r,t,n,a),a=a.parent}}function jd(e,t,n,r){const a=fa(t,e,r,!0);Jl(()=>{gs(r[t],a)},n)}function fa(e,t,n=Ft,r=!1){if(n){const a=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(n.isUnmounted)return;Dr(),qr(n);const l=un(t,n,e,s);return br(),Hr(),l});return r?a.unshift(i):a.push(i),i}}const zn=e=>(t,n=Ft)=>(!gi||e==="sp")&&fa(e,t,n),Nd=zn("bm"),Wl=zn("m"),Dd=zn("bu"),Zl=zn("u"),Ql=zn("bum"),Jl=zn("um"),Hd=zn("sp"),zd=zn("rtg"),Pd=zn("rtc");function Vd(e,t=Ft){fa("ec",e,t)}function Pn(e,t){const n=Ht;if(n===null)return e;const r=ba(n)||n.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,l,f,u=bt]=t[i];it(s)&&(s={mounted:s,updated:s}),s.deep&&hr(l),a.push({dir:s,instance:r,value:l,oldValue:void 0,arg:f,modifiers:u})}return e}function vr(e,t,n,r){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const l=a[s];i&&(l.oldValue=i[s].value);let f=l.dir[r];f&&(Dr(),un(f,n,8,[e.el,l,e,t]),Hr())}}const Bs="components",Ud="directives";function Xe(e,t){return Os(Bs,e,!0,t)||e}const $l=Symbol();function qd(e){return Xt(e)?Os(Bs,e,!1)||e:e||$l}function ma(e){return Os(Ud,e)}function Os(e,t,n=!0,r=!1){const a=Ht||Ft;if(a){const i=a.type;if(e===Bs){const l=gf(i,!1);if(l&&(l===t||l===Mn(t)||l===xs(Mn(t))))return i}const s=e0(a[e]||i[e],t)||e0(a.appContext[e],t);return!s&&r?i:s}}function e0(e,t){return e&&(e[t]||e[Mn(t)]||e[xs(Mn(t))])}function $e(e,t,n,r){let a;const i=n&&n[r];if(ot(e)||Xt(e)){a=new Array(e.length);for(let s=0,l=e.length;s<l;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if(Yt(e))if(e[Symbol.iterator])a=Array.from(e,(s,l)=>t(s,l,void 0,i&&i[l]));else{const s=Object.keys(e);a=new Array(s.length);for(let l=0,f=s.length;l<f;l++){const u=s[l];a[l]=t(e[u],u,l,i&&i[l])}}else a=[];return n&&(n[r]=a),a}function _t(e,t){for(let n=0;n<t.length;n++){const r=t[n];if(ot(r))for(let a=0;a<r.length;a++)e[r[a].name]=r[a].fn;else r&&(e[r.name]=r.fn)}return e}function Re(e,t,n={},r,a){if(Ht.isCE||Ht.parent&&vi(Ht.parent)&&Ht.parent.isCE)return Oe("slot",t==="default"?null:{name:t},r&&r());let i=e[t];i&&i._c&&(i._d=!1),Q();const s=i&&t0(i(n)),l=dt(st,{key:n.key||`_${t}`},s||(r?r():[]),s&&e._===1?64:-2);return!a&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function t0(e){return e.some(t=>pa(t)?!(t.type===fn||t.type===st&&!t0(t.children)):!0)?e:null}const Ls=e=>e?y0(e)?ba(e)||e.proxy:Ls(e.parent):null,ha=nn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ls(e.parent),$root:e=>Ls(e.root),$emit:e=>e.emit,$options:e=>i0(e),$forceUpdate:e=>e.f||(e.f=()=>Ol(e.update)),$nextTick:e=>e.n||(e.n=Bl.bind(e.proxy)),$watch:e=>Bd.bind(e)}),Xd={get({_:e},t){const{ctx:n,setupState:r,data:a,props:i,accessCache:s,type:l,appContext:f}=e;let u;if(t[0]!=="$"){const _=s[t];if(_!==void 0)switch(_){case 1:return r[t];case 2:return a[t];case 4:return n[t];case 3:return i[t]}else{if(r!==bt&&ht(r,t))return s[t]=1,r[t];if(a!==bt&&ht(a,t))return s[t]=2,a[t];if((u=e.propsOptions[0])&&ht(u,t))return s[t]=3,i[t];if(n!==bt&&ht(n,t))return s[t]=4,n[t];Fs&&(s[t]=0)}}const m=ha[t];let c,b;if(m)return t==="$attrs"&&tn(e,"get",t),m(e);if((c=l.__cssModules)&&(c=c[t]))return c;if(n!==bt&&ht(n,t))return s[t]=4,n[t];if(b=f.config.globalProperties,ht(b,t))return b[t]},set({_:e},t,n){const{data:r,setupState:a,ctx:i}=e;return a!==bt&&ht(a,t)?(a[t]=n,!0):r!==bt&&ht(r,t)?(r[t]=n,!0):ht(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:a,propsOptions:i}},s){let l;return!!n[s]||e!==bt&&ht(e,s)||t!==bt&&ht(t,s)||(l=i[0])&&ht(l,s)||ht(r,s)||ht(ha,s)||ht(a.config.globalProperties,s)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ht(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let Fs=!0;function Yd(e){const t=i0(e),n=e.proxy,r=e.ctx;Fs=!1,t.beforeCreate&&n0(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:l,provide:f,inject:u,created:m,beforeMount:c,mounted:b,beforeUpdate:_,updated:o,activated:B,deactivated:T,beforeDestroy:C,beforeUnmount:p,destroyed:A,unmounted:F,render:R,renderTracked:I,renderTriggered:h,errorCaptured:M,serverPrefetch:S,expose:v,inheritAttrs:y,components:x,directives:w,filters:k}=t;if(u&&Kd(u,r,null,e.appContext.config.unwrapInjectedRef),s)for(const Y in s){const z=s[Y];it(z)&&(r[Y]=z.bind(n))}if(a){const Y=a.call(n,n);Yt(Y)&&(e.data=fs(Y))}if(Fs=!0,i)for(const Y in i){const z=i[Y],U=it(z)?z.bind(n,n):it(z.get)?z.get.bind(n,n):An,d=!it(z)&&it(z.set)?z.set.bind(n):An,E=xf({get:U,set:d});Object.defineProperty(r,Y,{enumerable:!0,configurable:!0,get:()=>E.value,set:W=>E.value=W})}if(l)for(const Y in l)r0(l[Y],r,n,Y);if(f){const Y=it(f)?f.call(n):f;Reflect.ownKeys(Y).forEach(z=>{Id(z,Y[z])})}m&&n0(m,e,"c");function D(Y,z){ot(z)?z.forEach(U=>Y(U.bind(n))):z&&Y(z.bind(n))}if(D(Nd,c),D(Wl,b),D(Dd,_),D(Zl,o),D(Ld,B),D(Fd,T),D(Vd,M),D(Pd,I),D(zd,h),D(Ql,p),D(Jl,F),D(Hd,S),ot(v))if(v.length){const Y=e.exposed||(e.exposed={});v.forEach(z=>{Object.defineProperty(Y,z,{get:()=>n[z],set:U=>n[z]=U})})}else e.exposed||(e.exposed={});R&&e.render===An&&(e.render=R),y!=null&&(e.inheritAttrs=y),x&&(e.components=x),w&&(e.directives=w)}function Kd(e,t,n=An,r=!1){ot(e)&&(e=js(e));for(const a in e){const i=e[a];let s;Yt(i)?"default"in i?s=Ts(i.from||a,i.default,!0):s=Ts(i.from||a):s=Ts(i),qt(s)&&r?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:l=>s.value=l}):t[a]=s}}function n0(e,t,n){un(ot(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,n)}function r0(e,t,n,r){const a=r.includes(".")?Ul(n,r):()=>n[r];if(Xt(e)){const i=t[e];it(i)&&Rs(a,i)}else if(it(e))Rs(a,e.bind(n));else if(Yt(e))if(ot(e))e.forEach(i=>r0(i,t,n,r));else{const i=it(e.handler)?e.handler.bind(n):t[e.handler];it(i)&&Rs(a,i,e)}}function i0(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,l=i.get(t);let f;return l?f=l:!a.length&&!n&&!r?f=t:(f={},a.length&&a.forEach(u=>va(f,u,s,!0)),va(f,t,s)),i.set(t,f),f}function va(e,t,n,r=!1){const{mixins:a,extends:i}=t;i&&va(e,i,n,!0),a&&a.forEach(s=>va(e,s,n,!0));for(const s in t)if(!(r&&s==="expose")){const l=Gd[s]||n&&n[s];e[s]=l?l(e[s],t[s]):t[s]}return e}const Gd={data:a0,props:pr,emits:pr,methods:pr,computed:pr,beforeCreate:Kt,created:Kt,beforeMount:Kt,mounted:Kt,beforeUpdate:Kt,updated:Kt,beforeDestroy:Kt,beforeUnmount:Kt,destroyed:Kt,unmounted:Kt,activated:Kt,deactivated:Kt,errorCaptured:Kt,serverPrefetch:Kt,components:pr,directives:pr,watch:Zd,provide:a0,inject:Wd};function a0(e,t){return t?e?function(){return nn(it(e)?e.call(this,this):e,it(t)?t.call(this,this):t)}:t:e}function Wd(e,t){return pr(js(e),js(t))}function js(e){if(ot(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Kt(e,t){return e?[...new Set([].concat(e,t))]:t}function pr(e,t){return e?nn(nn(Object.create(null),e),t):t}function Zd(e,t){if(!e)return t;if(!t)return e;const n=nn(Object.create(null),e);for(const r in t)n[r]=Kt(e[r],t[r]);return n}function Qd(e,t,n,r=!1){const a={},i={};ks(i,_a,1),e.propsDefaults=Object.create(null),s0(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);n?e.props=r?a:td(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function Jd(e,t,n,r){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,l=mt(a),[f]=e.propsOptions;let u=!1;if((r||s>0)&&!(s&16)){if(s&8){const m=e.vnode.dynamicProps;for(let c=0;c<m.length;c++){let b=m[c];if(ca(e.emitsOptions,b))continue;const _=t[b];if(f)if(ht(i,b))_!==i[b]&&(i[b]=_,u=!0);else{const o=Mn(b);a[o]=Ns(f,l,o,_,e,!1)}else _!==i[b]&&(i[b]=_,u=!0)}}}else{s0(e,t,a,i)&&(u=!0);let m;for(const c in l)(!t||!ht(t,c)&&((m=aa(c))===c||!ht(t,m)))&&(f?n&&(n[c]!==void 0||n[m]!==void 0)&&(a[c]=Ns(f,l,c,void 0,e,!0)):delete a[c]);if(i!==l)for(const c in i)(!t||!ht(t,c)&&!0)&&(delete i[c],u=!0)}u&&Dn(e,"set","$attrs")}function s0(e,t,n,r){const[a,i]=e.propsOptions;let s=!1,l;if(t)for(let f in t){if(ra(f))continue;const u=t[f];let m;a&&ht(a,m=Mn(f))?!i||!i.includes(m)?n[m]=u:(l||(l={}))[m]=u:ca(e.emitsOptions,f)||(!(f in r)||u!==r[f])&&(r[f]=u,s=!0)}if(i){const f=mt(n),u=l||bt;for(let m=0;m<i.length;m++){const c=i[m];n[c]=Ns(a,f,c,u[c],e,!ht(u,c))}}return s}function Ns(e,t,n,r,a,i){const s=e[n];if(s!=null){const l=ht(s,"default");if(l&&r===void 0){const f=s.default;if(s.type!==Function&&it(f)){const{propsDefaults:u}=a;n in u?r=u[n]:(qr(a),r=u[n]=f.call(null,t),br())}else r=f}s[0]&&(i&&!l?r=!1:s[1]&&(r===""||r===aa(n))&&(r=!0))}return r}function o0(e,t,n=!1){const r=t.propsCache,a=r.get(e);if(a)return a;const i=e.props,s={},l=[];let f=!1;if(!it(e)){const m=c=>{f=!0;const[b,_]=o0(c,t,!0);nn(s,b),_&&l.push(..._)};!n&&t.mixins.length&&t.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}if(!i&&!f)return r.set(e,Pr),Pr;if(ot(i))for(let m=0;m<i.length;m++){const c=Mn(i[m]);l0(c)&&(s[c]=bt)}else if(i)for(const m in i){const c=Mn(m);if(l0(c)){const b=i[m],_=s[c]=ot(b)||it(b)?{type:b}:b;if(_){const o=d0(Boolean,_.type),B=d0(String,_.type);_[0]=o>-1,_[1]=B<0||o<B,(o>-1||ht(_,"default"))&&l.push(c)}}}const u=[s,l];return r.set(e,u),u}function l0(e){return e[0]!=="$"}function c0(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function u0(e,t){return c0(e)===c0(t)}function d0(e,t){return ot(t)?t.findIndex(n=>u0(n,e)):it(t)&&u0(t,e)?0:-1}const f0=e=>e[0]==="_"||e==="$stable",Ds=e=>ot(e)?e.map(En):[En(e)],$d=(e,t,n)=>{if(t._n)return t;const r=Ke((...a)=>Ds(t(...a)),n);return r._c=!1,r},m0=(e,t,n)=>{const r=e._ctx;for(const a in e){if(f0(a))continue;const i=e[a];if(it(i))t[a]=$d(a,i,r);else if(i!=null){const s=Ds(i);t[a]=()=>s}}},h0=(e,t)=>{const n=Ds(t);e.slots.default=()=>n},ef=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=mt(t),ks(t,"_",n)):m0(t,e.slots={})}else e.slots={},t&&h0(e,t);ks(e.slots,_a,1)},tf=(e,t,n)=>{const{vnode:r,slots:a}=e;let i=!0,s=bt;if(r.shapeFlag&32){const l=t._;l?n&&l===1?i=!1:(nn(a,t),!n&&l===1&&delete a._):(i=!t.$stable,m0(t,a)),s=t}else t&&(h0(e,t),s={default:1});if(i)for(const l in a)!f0(l)&&!(l in s)&&delete a[l]};function v0(){return{app:null,config:{isNativeTag:fd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nf=0;function rf(e,t){return function(r,a=null){it(r)||(r=Object.assign({},r)),a!=null&&!Yt(a)&&(a=null);const i=v0(),s=new Set;let l=!1;const f=i.app={_uid:nf++,_component:r,_props:a,_container:null,_context:i,_instance:null,version:wf,get config(){return i.config},set config(u){},use(u,...m){return s.has(u)||(u&&it(u.install)?(s.add(u),u.install(f,...m)):it(u)&&(s.add(u),u(f,...m))),f},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),f},component(u,m){return m?(i.components[u]=m,f):i.components[u]},directive(u,m){return m?(i.directives[u]=m,f):i.directives[u]},mount(u,m,c){if(!l){const b=Oe(r,a);return b.appContext=i,m&&t?t(b,u):e(b,u,c),l=!0,f._container=u,u.__vue_app__=f,ba(b.component)||b.component.proxy}},unmount(){l&&(e(null,f._container),delete f._container.__vue_app__)},provide(u,m){return i.provides[u]=m,f}};return f}}function Hs(e,t,n,r,a=!1){if(ot(e)){e.forEach((b,_)=>Hs(b,t&&(ot(t)?t[_]:t),n,r,a));return}if(vi(r)&&!a)return;const i=r.shapeFlag&4?ba(r.component)||r.component.proxy:r.el,s=a?null:i,{i:l,r:f}=e,u=t&&t.r,m=l.refs===bt?l.refs={}:l.refs,c=l.setupState;if(u!=null&&u!==f&&(Xt(u)?(m[u]=null,ht(c,u)&&(c[u]=null)):qt(u)&&(u.value=null)),it(f))$n(f,l,12,[s,m]);else{const b=Xt(f),_=qt(f);if(b||_){const o=()=>{if(e.f){const B=b?m[f]:f.value;a?ot(B)&&gs(B,i):ot(B)?B.includes(i)||B.push(i):b?(m[f]=[i],ht(c,f)&&(c[f]=m[f])):(f.value=[i],e.k&&(m[e.k]=f.value))}else b?(m[f]=s,ht(c,f)&&(c[f]=s)):_&&(f.value=s,e.k&&(m[e.k]=s))};s?(o.id=-1,Wt(o,n)):o()}}}const Wt=Cd;function af(e){return sf(e)}function sf(e,t){const n=gd();n.__VUE__=!0;const{insert:r,remove:a,patchProp:i,createElement:s,createText:l,createComment:f,setText:u,setElementText:m,parentNode:c,nextSibling:b,setScopeId:_=An,cloneNode:o,insertStaticContent:B}=e,T=(P,X,ne,ce=null,de=null,Ae=null,Ee=!1,ye=null,Me=!!X.dynamicChildren)=>{if(P===X)return;P&&!gr(P,X)&&(ce=De(P),O(P,de,Ae,!0),P=null),X.patchFlag===-2&&(Me=!1,X.dynamicChildren=null);const{type:ge,ref:ze,shapeFlag:je}=X;switch(ge){case zs:C(P,X,ne,ce);break;case fn:p(P,X,ne,ce);break;case Ps:P==null&&A(X,ne,ce,Ee);break;case st:w(P,X,ne,ce,de,Ae,Ee,ye,Me);break;default:je&1?I(P,X,ne,ce,de,Ae,Ee,ye,Me):je&6?k(P,X,ne,ce,de,Ae,Ee,ye,Me):(je&64||je&128)&&ge.process(P,X,ne,ce,de,Ae,Ee,ye,Me,he)}ze!=null&&de&&Hs(ze,P&&P.ref,Ae,X||P,!X)},C=(P,X,ne,ce)=>{if(P==null)r(X.el=l(X.children),ne,ce);else{const de=X.el=P.el;X.children!==P.children&&u(de,X.children)}},p=(P,X,ne,ce)=>{P==null?r(X.el=f(X.children||""),ne,ce):X.el=P.el},A=(P,X,ne,ce)=>{[P.el,P.anchor]=B(P.children,X,ne,ce,P.el,P.anchor)},F=({el:P,anchor:X},ne,ce)=>{let de;for(;P&&P!==X;)de=b(P),r(P,ne,ce),P=de;r(X,ne,ce)},R=({el:P,anchor:X})=>{let ne;for(;P&&P!==X;)ne=b(P),a(P),P=ne;a(X)},I=(P,X,ne,ce,de,Ae,Ee,ye,Me)=>{Ee=Ee||X.type==="svg",P==null?h(X,ne,ce,de,Ae,Ee,ye,Me):v(P,X,de,Ae,Ee,ye,Me)},h=(P,X,ne,ce,de,Ae,Ee,ye)=>{let Me,ge;const{type:ze,props:je,shapeFlag:Pe,transition:Ve,patchFlag:Ge,dirs:ue}=P;if(P.el&&o!==void 0&&Ge===-1)Me=P.el=o(P.el);else{if(Me=P.el=s(P.type,Ae,je&&je.is,je),Pe&8?m(Me,P.children):Pe&16&&S(P.children,Me,null,ce,de,Ae&&ze!=="foreignObject",Ee,ye),ue&&vr(P,null,ce,"created"),je){for(const ee in je)ee!=="value"&&!ra(ee)&&i(Me,ee,null,je[ee],Ae,P.children,ce,de,pe);"value"in je&&i(Me,"value",null,je.value),(ge=je.onVnodeBeforeMount)&&Tn(ge,ce,P)}M(Me,P,P.scopeId,Ee,ce)}ue&&vr(P,null,ce,"beforeMount");const we=(!de||de&&!de.pendingBranch)&&Ve&&!Ve.persisted;we&&Ve.beforeEnter(Me),r(Me,X,ne),((ge=je&&je.onVnodeMounted)||we||ue)&&Wt(()=>{ge&&Tn(ge,ce,P),we&&Ve.enter(Me),ue&&vr(P,null,ce,"mounted")},de)},M=(P,X,ne,ce,de)=>{if(ne&&_(P,ne),ce)for(let Ae=0;Ae<ce.length;Ae++)_(P,ce[Ae]);if(de){let Ae=de.subTree;if(X===Ae){const Ee=de.vnode;M(P,Ee,Ee.scopeId,Ee.slotScopeIds,de.parent)}}},S=(P,X,ne,ce,de,Ae,Ee,ye,Me=0)=>{for(let ge=Me;ge<P.length;ge++){const ze=P[ge]=ye?nr(P[ge]):En(P[ge]);T(null,ze,X,ne,ce,de,Ae,Ee,ye)}},v=(P,X,ne,ce,de,Ae,Ee)=>{const ye=X.el=P.el;let{patchFlag:Me,dynamicChildren:ge,dirs:ze}=X;Me|=P.patchFlag&16;const je=P.props||bt,Pe=X.props||bt;let Ve;ne&&_r(ne,!1),(Ve=Pe.onVnodeBeforeUpdate)&&Tn(Ve,ne,X,P),ze&&vr(X,P,ne,"beforeUpdate"),ne&&_r(ne,!0);const Ge=de&&X.type!=="foreignObject";if(ge?y(P.dynamicChildren,ge,ye,ne,ce,Ge,Ae):Ee||U(P,X,ye,null,ne,ce,Ge,Ae,!1),Me>0){if(Me&16)x(ye,X,je,Pe,ne,ce,de);else if(Me&2&&je.class!==Pe.class&&i(ye,"class",null,Pe.class,de),Me&4&&i(ye,"style",je.style,Pe.style,de),Me&8){const ue=X.dynamicProps;for(let we=0;we<ue.length;we++){const ee=ue[we],Be=je[ee],L=Pe[ee];(L!==Be||ee==="value")&&i(ye,ee,Be,L,de,P.children,ne,ce,pe)}}Me&1&&P.children!==X.children&&m(ye,X.children)}else!Ee&&ge==null&&x(ye,X,je,Pe,ne,ce,de);((Ve=Pe.onVnodeUpdated)||ze)&&Wt(()=>{Ve&&Tn(Ve,ne,X,P),ze&&vr(X,P,ne,"updated")},ce)},y=(P,X,ne,ce,de,Ae,Ee)=>{for(let ye=0;ye<X.length;ye++){const Me=P[ye],ge=X[ye],ze=Me.el&&(Me.type===st||!gr(Me,ge)||Me.shapeFlag&70)?c(Me.el):ne;T(Me,ge,ze,null,ce,de,Ae,Ee,!0)}},x=(P,X,ne,ce,de,Ae,Ee)=>{if(ne!==ce){for(const ye in ce){if(ra(ye))continue;const Me=ce[ye],ge=ne[ye];Me!==ge&&ye!=="value"&&i(P,ye,ge,Me,Ee,X.children,de,Ae,pe)}if(ne!==bt)for(const ye in ne)!ra(ye)&&!(ye in ce)&&i(P,ye,ne[ye],null,Ee,X.children,de,Ae,pe);"value"in ce&&i(P,"value",ne.value,ce.value)}},w=(P,X,ne,ce,de,Ae,Ee,ye,Me)=>{const ge=X.el=P?P.el:l(""),ze=X.anchor=P?P.anchor:l("");let{patchFlag:je,dynamicChildren:Pe,slotScopeIds:Ve}=X;Ve&&(ye=ye?ye.concat(Ve):Ve),P==null?(r(ge,ne,ce),r(ze,ne,ce),S(X.children,ne,ze,de,Ae,Ee,ye,Me)):je>0&&je&64&&Pe&&P.dynamicChildren?(y(P.dynamicChildren,Pe,ne,de,Ae,Ee,ye),(X.key!=null||de&&X===de.subTree)&&p0(P,X,!0)):U(P,X,ne,ze,de,Ae,Ee,ye,Me)},k=(P,X,ne,ce,de,Ae,Ee,ye,Me)=>{X.slotScopeIds=ye,P==null?X.shapeFlag&512?de.ctx.activate(X,ne,ce,Ee,Me):g(X,ne,ce,de,Ae,Ee,Me):D(P,X,Me)},g=(P,X,ne,ce,de,Ae,Ee)=>{const ye=P.component=mf(P,ce,de);if(da(P)&&(ye.ctx.renderer=he),hf(ye),ye.asyncDep){if(de&&de.registerDep(ye,Y),!P.el){const Me=ye.subTree=Oe(fn);p(null,Me,X,ne)}return}Y(ye,P,X,ne,de,Ae,Ee)},D=(P,X,ne)=>{const ce=X.component=P.component;if(Ed(P,X,ne))if(ce.asyncDep&&!ce.asyncResolved){z(ce,X,ne);return}else ce.next=X,yd(ce.update),ce.update();else X.el=P.el,ce.vnode=X},Y=(P,X,ne,ce,de,Ae,Ee)=>{const ye=()=>{if(P.isMounted){let{next:ze,bu:je,u:Pe,parent:Ve,vnode:Ge}=P,ue=ze,we;_r(P,!1),ze?(ze.el=Ge.el,z(P,ze,Ee)):ze=Ge,je&&ws(je),(we=ze.props&&ze.props.onVnodeBeforeUpdate)&&Tn(we,Ve,ze,Ge),_r(P,!0);const ee=Es(P),Be=P.subTree;P.subTree=ee,T(Be,ee,c(Be.el),De(Be),P,de,Ae),ze.el=ee.el,ue===null&&Td(P,ee.el),Pe&&Wt(Pe,de),(we=ze.props&&ze.props.onVnodeUpdated)&&Wt(()=>Tn(we,Ve,ze,Ge),de)}else{let ze;const{el:je,props:Pe}=X,{bm:Ve,m:Ge,parent:ue}=P,we=vi(X);if(_r(P,!1),Ve&&ws(Ve),!we&&(ze=Pe&&Pe.onVnodeBeforeMount)&&Tn(ze,ue,X),_r(P,!0),je&&rt){const ee=()=>{P.subTree=Es(P),rt(je,P.subTree,P,de,null)};we?X.type.__asyncLoader().then(()=>!P.isUnmounted&&ee()):ee()}else{const ee=P.subTree=Es(P);T(null,ee,ne,ce,P,de,Ae),X.el=ee.el}if(Ge&&Wt(Ge,de),!we&&(ze=Pe&&Pe.onVnodeMounted)){const ee=X;Wt(()=>Tn(ze,ue,ee),de)}(X.shapeFlag&256||ue&&vi(ue.vnode)&&ue.vnode.shapeFlag&256)&&P.a&&Wt(P.a,de),P.isMounted=!0,X=ne=ce=null}},Me=P.effect=new os(ye,()=>Ol(ge),P.scope),ge=P.update=()=>Me.run();ge.id=P.uid,_r(P,!0),ge()},z=(P,X,ne)=>{X.component=P;const ce=P.vnode.props;P.vnode=X,P.next=null,Jd(P,X.props,ce,ne),tf(P,X.children,ne),Dr(),la(void 0,P.update),Hr()},U=(P,X,ne,ce,de,Ae,Ee,ye,Me=!1)=>{const ge=P&&P.children,ze=P?P.shapeFlag:0,je=X.children,{patchFlag:Pe,shapeFlag:Ve}=X;if(Pe>0){if(Pe&128){E(ge,je,ne,ce,de,Ae,Ee,ye,Me);return}else if(Pe&256){d(ge,je,ne,ce,de,Ae,Ee,ye,Me);return}}Ve&8?(ze&16&&pe(ge,de,Ae),je!==ge&&m(ne,je)):ze&16?Ve&16?E(ge,je,ne,ce,de,Ae,Ee,ye,Me):pe(ge,de,Ae,!0):(ze&8&&m(ne,""),Ve&16&&S(je,ne,ce,de,Ae,Ee,ye,Me))},d=(P,X,ne,ce,de,Ae,Ee,ye,Me)=>{P=P||Pr,X=X||Pr;const ge=P.length,ze=X.length,je=Math.min(ge,ze);let Pe;for(Pe=0;Pe<je;Pe++){const Ve=X[Pe]=Me?nr(X[Pe]):En(X[Pe]);T(P[Pe],Ve,ne,null,de,Ae,Ee,ye,Me)}ge>ze?pe(P,de,Ae,!0,!1,je):S(X,ne,ce,de,Ae,Ee,ye,Me,je)},E=(P,X,ne,ce,de,Ae,Ee,ye,Me)=>{let ge=0;const ze=X.length;let je=P.length-1,Pe=ze-1;for(;ge<=je&&ge<=Pe;){const Ve=P[ge],Ge=X[ge]=Me?nr(X[ge]):En(X[ge]);if(gr(Ve,Ge))T(Ve,Ge,ne,null,de,Ae,Ee,ye,Me);else break;ge++}for(;ge<=je&&ge<=Pe;){const Ve=P[je],Ge=X[Pe]=Me?nr(X[Pe]):En(X[Pe]);if(gr(Ve,Ge))T(Ve,Ge,ne,null,de,Ae,Ee,ye,Me);else break;je--,Pe--}if(ge>je){if(ge<=Pe){const Ve=Pe+1,Ge=Ve<ze?X[Ve].el:ce;for(;ge<=Pe;)T(null,X[ge]=Me?nr(X[ge]):En(X[ge]),ne,Ge,de,Ae,Ee,ye,Me),ge++}}else if(ge>Pe)for(;ge<=je;)O(P[ge],de,Ae,!0),ge++;else{const Ve=ge,Ge=ge,ue=new Map;for(ge=Ge;ge<=Pe;ge++){const K=X[ge]=Me?nr(X[ge]):En(X[ge]);K.key!=null&&ue.set(K.key,ge)}let we,ee=0;const Be=Pe-Ge+1;let L=!1,N=0;const V=new Array(Be);for(ge=0;ge<Be;ge++)V[ge]=0;for(ge=Ve;ge<=je;ge++){const K=P[ge];if(ee>=Be){O(K,de,Ae,!0);continue}let H;if(K.key!=null)H=ue.get(K.key);else for(we=Ge;we<=Pe;we++)if(V[we-Ge]===0&&gr(K,X[we])){H=we;break}H===void 0?O(K,de,Ae,!0):(V[H-Ge]=ge+1,H>=N?N=H:L=!0,T(K,X[H],ne,null,de,Ae,Ee,ye,Me),ee++)}const q=L?of(V):Pr;for(we=q.length-1,ge=Be-1;ge>=0;ge--){const K=Ge+ge,H=X[K],Z=K+1<ze?X[K+1].el:ce;V[ge]===0?T(null,H,ne,Z,de,Ae,Ee,ye,Me):L&&(we<0||ge!==q[we]?W(H,ne,Z,2):we--)}}},W=(P,X,ne,ce,de=null)=>{const{el:Ae,type:Ee,transition:ye,children:Me,shapeFlag:ge}=P;if(ge&6){W(P.component.subTree,X,ne,ce);return}if(ge&128){P.suspense.move(X,ne,ce);return}if(ge&64){Ee.move(P,X,ne,he);return}if(Ee===st){r(Ae,X,ne);for(let je=0;je<Me.length;je++)W(Me[je],X,ne,ce);r(P.anchor,X,ne);return}if(Ee===Ps){F(P,X,ne);return}if(ce!==2&&ge&1&&ye)if(ce===0)ye.beforeEnter(Ae),r(Ae,X,ne),Wt(()=>ye.enter(Ae),de);else{const{leave:je,delayLeave:Pe,afterLeave:Ve}=ye,Ge=()=>r(Ae,X,ne),ue=()=>{je(Ae,()=>{Ge(),Ve&&Ve()})};Pe?Pe(Ae,Ge,ue):ue()}else r(Ae,X,ne)},O=(P,X,ne,ce=!1,de=!1)=>{const{type:Ae,props:Ee,ref:ye,children:Me,dynamicChildren:ge,shapeFlag:ze,patchFlag:je,dirs:Pe}=P;if(ye!=null&&Hs(ye,null,ne,P,!0),ze&256){X.ctx.deactivate(P);return}const Ve=ze&1&&Pe,Ge=!vi(P);let ue;if(Ge&&(ue=Ee&&Ee.onVnodeBeforeUnmount)&&Tn(ue,X,P),ze&6)_e(P.component,ne,ce);else{if(ze&128){P.suspense.unmount(ne,ce);return}Ve&&vr(P,null,X,"beforeUnmount"),ze&64?P.type.remove(P,X,ne,de,he,ce):ge&&(Ae!==st||je>0&&je&64)?pe(ge,X,ne,!1,!0):(Ae===st&&je&384||!de&&ze&16)&&pe(Me,X,ne),ce&&me(P)}(Ge&&(ue=Ee&&Ee.onVnodeUnmounted)||Ve)&&Wt(()=>{ue&&Tn(ue,X,P),Ve&&vr(P,null,X,"unmounted")},ne)},me=P=>{const{type:X,el:ne,anchor:ce,transition:de}=P;if(X===st){Se(ne,ce);return}if(X===Ps){R(P);return}const Ae=()=>{a(ne),de&&!de.persisted&&de.afterLeave&&de.afterLeave()};if(P.shapeFlag&1&&de&&!de.persisted){const{leave:Ee,delayLeave:ye}=de,Me=()=>Ee(ne,Ae);ye?ye(P.el,Ae,Me):Me()}else Ae()},Se=(P,X)=>{let ne;for(;P!==X;)ne=b(P),a(P),P=ne;a(X)},_e=(P,X,ne)=>{const{bum:ce,scope:de,update:Ae,subTree:Ee,um:ye}=P;ce&&ws(ce),de.stop(),Ae&&(Ae.active=!1,O(Ee,P,X,ne)),ye&&Wt(ye,X),Wt(()=>{P.isUnmounted=!0},X),X&&X.pendingBranch&&!X.isUnmounted&&P.asyncDep&&!P.asyncResolved&&P.suspenseId===X.pendingId&&(X.deps--,X.deps===0&&X.resolve())},pe=(P,X,ne,ce=!1,de=!1,Ae=0)=>{for(let Ee=Ae;Ee<P.length;Ee++)O(P[Ee],X,ne,ce,de)},De=P=>P.shapeFlag&6?De(P.component.subTree):P.shapeFlag&128?P.suspense.next():b(P.anchor||P.el),Ce=(P,X,ne)=>{P==null?X._vnode&&O(X._vnode,null,null,!0):T(X._vnode||null,P,X,null,null,null,ne),jl(),X._vnode=P},he={p:T,um:O,m:W,r:me,mt:g,mc:S,pc:U,pbc:y,n:De,o:e};let Ue,rt;return t&&([Ue,rt]=t(he)),{render:Ce,hydrate:Ue,createApp:rf(Ce,Ue)}}function _r({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function p0(e,t,n=!1){const r=e.children,a=t.children;if(ot(r)&&ot(a))for(let i=0;i<r.length;i++){const s=r[i];let l=a[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=a[i]=nr(a[i]),l.el=s.el),n||p0(s,l))}}function of(e){const t=e.slice(),n=[0];let r,a,i,s,l;const f=e.length;for(r=0;r<f;r++){const u=e[r];if(u!==0){if(a=n[n.length-1],e[a]<u){t[r]=a,n.push(r);continue}for(i=0,s=n.length-1;i<s;)l=i+s>>1,e[n[l]]<u?i=l+1:s=l;u<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}for(i=n.length,s=n[i-1];i-- >0;)n[i]=s,s=t[s];return n}const lf=e=>e.__isTeleport,st=Symbol(void 0),zs=Symbol(void 0),fn=Symbol(void 0),Ps=Symbol(void 0),pi=[];let _n=null;function Q(e=!1){pi.push(_n=e?null:[])}function cf(){pi.pop(),_n=pi[pi.length-1]||null}let _i=1;function _0(e){_i+=e}function g0(e){return e.dynamicChildren=_i>0?_n||Pr:null,cf(),_i>0&&_n&&_n.push(e),e}function se(e,t,n,r,a,i){return g0(ke(e,t,n,r,a,i,!0))}function dt(e,t,n,r,a){return g0(Oe(e,t,n,r,a,!0))}function pa(e){return e?e.__v_isVNode===!0:!1}function gr(e,t){return e.type===t.type&&e.key===t.key}const _a="__vInternal",b0=({key:e})=>e!=null?e:null,ga=({ref:e,ref_key:t,ref_for:n})=>e!=null?Xt(e)||qt(e)||it(e)?{i:Ht,r:e,k:t,f:!!n}:e:null;function ke(e,t=null,n=null,r=0,a=null,i=e===st?0:1,s=!1,l=!1){const f={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&b0(t),ref:t&&ga(t),scopeId:Hl,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:a,dynamicChildren:null,appContext:null};return l?(Vs(f,n),i&128&&e.normalize(f)):n&&(f.shapeFlag|=Xt(n)?8:16),_i>0&&!s&&_n&&(f.patchFlag>0||i&6)&&f.patchFlag!==32&&_n.push(f),f}const Oe=uf;function uf(e,t=null,n=null,r=0,a=null,i=!1){if((!e||e===$l)&&(e=fn),pa(e)){const l=tr(e,t,!0);return n&&Vs(l,n),_i>0&&!i&&_n&&(l.shapeFlag&6?_n[_n.indexOf(e)]=l:_n.push(l)),l.patchFlag|=-2,l}if(bf(e)&&(e=e.__vccOpts),t){t=vt(t);let{class:l,style:f}=t;l&&!Xt(l)&&(t.class=nt(l)),Yt(f)&&(bl(f)&&!ot(f)&&(f=nn({},f)),t.style=St(f))}const s=Xt(e)?1:Rd(e)?128:lf(e)?64:Yt(e)?4:it(e)?2:0;return ke(e,t,n,r,a,s,i,!0)}function vt(e){return e?bl(e)||_a in e?nn({},e):e:null}function tr(e,t,n=!1){const{props:r,ref:a,patchFlag:i,children:s}=e,l=t?Us(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&b0(l),ref:t&&t.ref?n&&a?ot(a)?a.concat(ga(t)):[a,ga(t)]:ga(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==st?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&tr(e.ssContent),ssFallback:e.ssFallback&&tr(e.ssFallback),el:e.el,anchor:e.anchor}}function Vn(e=" ",t=0){return Oe(zs,null,e,t)}function Te(e="",t=!1){return t?(Q(),dt(fn,null,e)):Oe(fn,null,e)}function En(e){return e==null||typeof e=="boolean"?Oe(fn):ot(e)?Oe(st,null,e.slice()):typeof e=="object"?nr(e):Oe(zs,null,String(e))}function nr(e){return e.el===null||e.memo?e:tr(e)}function Vs(e,t){let n=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(ot(t))n=16;else if(typeof t=="object")if(r&65){const a=t.default;a&&(a._c&&(a._d=!1),Vs(e,a()),a._c&&(a._d=!0));return}else{n=32;const a=t._;!a&&!(_a in t)?t._ctx=Ht:a===3&&Ht&&(Ht.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else it(t)?(t={default:t,_ctx:Ht},n=32):(t=String(t),r&64?(n=16,t=[Vn(t)]):n=8);e.children=t,e.shapeFlag|=n}function Us(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const a in r)if(a==="class")t.class!==r.class&&(t.class=nt([t.class,r.class]));else if(a==="style")t.style=St([t.style,r.style]);else if(_s(a)){const i=t[a],s=r[a];s&&i!==s&&!(ot(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=r[a])}return t}function Tn(e,t,n,r=null){un(e,t,7,[n,r])}const df=v0();let ff=0;function mf(e,t,n){const r=e.type,a=(t?t.appContext:e.appContext)||df,i={uid:ff++,vnode:e,type:r,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new T1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:o0(r,a),emitsOptions:Dl(r,a),emit:null,emitted:null,propsDefaults:bt,inheritAttrs:r.inheritAttrs,ctx:bt,data:bt,props:bt,attrs:bt,slots:bt,refs:bt,setupState:bt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=Sd.bind(null,i),e.ce&&e.ce(i),i}let Ft=null;const x0=()=>Ft||Ht,qr=e=>{Ft=e,e.scope.on()},br=()=>{Ft&&Ft.scope.off(),Ft=null};function y0(e){return e.vnode.shapeFlag&4}let gi=!1;function hf(e,t=!1){gi=t;const{props:n,children:r}=e.vnode,a=y0(e);Qd(e,n,a,t),ef(e,r);const i=a?vf(e,t):void 0;return gi=!1,i}function vf(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=xl(new Proxy(e.ctx,Xd));const{setup:r}=n;if(r){const a=e.setupContext=r.length>1?_f(e):null;qr(e),Dr();const i=$n(r,e,0,[e.props,a]);if(Hr(),br(),Ml(i)){if(i.then(br,br),t)return i.then(s=>{w0(e,s,t)}).catch(s=>{sa(s,e,0)});e.asyncDep=i}else w0(e,i,t)}else S0(e,t)}function w0(e,t,n){it(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Yt(t)&&(e.setupState=yl(t)),S0(e,n)}let k0;function S0(e,t,n){const r=e.type;if(!e.render){if(!t&&k0&&!r.render){const a=r.template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:l,compilerOptions:f}=r,u=nn(nn({isCustomElement:i,delimiters:l},s),f);r.render=k0(a,u)}}e.render=r.render||An}qr(e),Dr(),Yd(e),Hr(),br()}function pf(e){return new Proxy(e.attrs,{get(t,n){return tn(e,"get","$attrs"),t[n]}})}function _f(e){const t=r=>{e.exposed=r||{}};let n;return{get attrs(){return n||(n=pf(e))},slots:e.slots,emit:e.emit,expose:t}}function ba(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(yl(xl(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in ha)return ha[n](e)}}))}function gf(e,t=!0){return it(e)?e.displayName||e.name:e.name||t&&e.__name}function bf(e){return it(e)&&"__vccOpts"in e}const xf=(e,t)=>od(e,t,gi);function yf(e,t,n){const r=arguments.length;return r===2?Yt(t)&&!ot(t)?pa(t)?Oe(e,null,[t]):Oe(e,t):Oe(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&pa(n)&&(n=[n]),Oe(e,t,n))}const wf="3.2.37";function kf(e,t){const n=Object.create(null),r=e.split(",");for(let a=0;a<r.length;a++)n[r[a]]=!0;return t?a=>!!n[a.toLowerCase()]:a=>!!n[a]}const Sf=kf("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function A0(e){return!!e||e===""}const Af=/^on[^a-z]/,Mf=e=>Af.test(e),Ef=e=>e.startsWith("onUpdate:"),bi=Object.assign,xi=Array.isArray,Tf=e=>typeof e=="function",qs=e=>typeof e=="string",Rf=e=>e!==null&&typeof e=="object",Xs=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Cf=/-(\w)/g,M0=Xs(e=>e.replace(Cf,(t,n)=>n?n.toUpperCase():"")),If=/\B([A-Z])/g,Xr=Xs(e=>e.replace(If,"-$1").toLowerCase()),Bf=Xs(e=>e.charAt(0).toUpperCase()+e.slice(1)),Ys=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Of="http://www.w3.org/2000/svg",xr=typeof document!="undefined"?document:null,E0=xr&&xr.createElement("template"),Lf={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const a=t?xr.createElementNS(Of,e):xr.createElement(e,n?{is:n}:void 0);return e==="select"&&r&&r.multiple!=null&&a.setAttribute("multiple",r.multiple),a},createText:e=>xr.createTextNode(e),createComment:e=>xr.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>xr.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,r,a,i){const s=n?n.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),n),!(a===i||!(a=a.nextSibling)););else{E0.innerHTML=r?`<svg>${e}</svg>`:e;const l=E0.content;if(r){const f=l.firstChild;for(;f.firstChild;)l.appendChild(f.firstChild);l.removeChild(f)}t.insertBefore(l,n)}return[s?s.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Ff(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function jf(e,t,n){const r=e.style,a=qs(n);if(n&&!a){for(const i in n)Ks(r,i,n[i]);if(t&&!qs(t))for(const i in t)n[i]==null&&Ks(r,i,"")}else{const i=r.display;a?t!==n&&(r.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=i)}}const T0=/\s*!important$/;function Ks(e,t,n){if(xi(n))n.forEach(r=>Ks(e,t,r));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const r=Nf(e,t);T0.test(n)?e.setProperty(Xr(r),n.replace(T0,""),"important"):e[r]=n}}const R0=["Webkit","Moz","ms"],Gs={};function Nf(e,t){const n=Gs[t];if(n)return n;let r=Mn(t);if(r!=="filter"&&r in e)return Gs[t]=r;r=Bf(r);for(let a=0;a<R0.length;a++){const i=R0[a]+r;if(i in e)return Gs[t]=i}return t}const C0="http://www.w3.org/1999/xlink";function Df(e,t,n,r,a){if(r&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(C0,t.slice(6,t.length)):e.setAttributeNS(C0,t,n);else{const i=Sf(t);n==null||i&&!A0(n)?e.removeAttribute(t):e.setAttribute(t,i?"":n)}}function Hf(e,t,n,r,a,i,s){if(t==="innerHTML"||t==="textContent"){r&&s(r,a,i),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const f=n==null?"":n;(e.value!==f||e.tagName==="OPTION")&&(e.value=f),n==null&&e.removeAttribute(t);return}let l=!1;if(n===""||n==null){const f=typeof e[t];f==="boolean"?n=A0(n):n==null&&f==="string"?(n="",l=!0):f==="number"&&(n=0,l=!0)}try{e[t]=n}catch{}l&&e.removeAttribute(t)}const[I0,zf]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let Ws=0;const Pf=Promise.resolve(),Vf=()=>{Ws=0},Uf=()=>Ws||(Pf.then(Vf),Ws=I0());function qf(e,t,n,r){e.addEventListener(t,n,r)}function Xf(e,t,n,r){e.removeEventListener(t,n,r)}function Yf(e,t,n,r,a=null){const i=e._vei||(e._vei={}),s=i[t];if(r&&s)s.value=r;else{const[l,f]=Kf(t);if(r){const u=i[t]=Gf(r,a);qf(e,l,u,f)}else s&&(Xf(e,l,s,f),i[t]=void 0)}}const B0=/(?:Once|Passive|Capture)$/;function Kf(e){let t;if(B0.test(e)){t={};let n;for(;n=e.match(B0);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Xr(e.slice(2)),t]}function Gf(e,t){const n=r=>{const a=r.timeStamp||I0();(zf||a>=n.attached-1)&&un(Wf(r,n.value),t,5,[r])};return n.value=e,n.attached=Uf(),n}function Wf(e,t){if(xi(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(r=>a=>!a._stopped&&r&&r(a))}else return t}const O0=/^on[a-z]/,Zf=(e,t,n,r,a=!1,i,s,l,f)=>{t==="class"?Ff(e,r,a):t==="style"?jf(e,n,r):Mf(t)?Ef(t)||Yf(e,t,n,r,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Qf(e,t,r,a))?Hf(e,t,r,i,s,l,f):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),Df(e,t,r,a))};function Qf(e,t,n,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&O0.test(t)&&Tf(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||O0.test(t)&&qs(n)?!1:t in e}function Jf(e,t){const n=Od(e);class r extends Zs{constructor(i){super(n,i,t)}}return r.def=n,r}const $f=typeof HTMLElement!="undefined"?HTMLElement:class{};class Zs extends $f{constructor(t,n={},r){super(),this._def=t,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&r?r(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,Bl(()=>{this._connected||(Y0(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let r=0;r<this.attributes.length;r++)this._setAttr(this.attributes[r].name);new MutationObserver(r=>{for(const a of r)this._setAttr(a.attributeName)}).observe(this,{attributes:!0});const t=r=>{const{props:a,styles:i}=r,s=!xi(a),l=a?s?Object.keys(a):a:[];let f;if(s)for(const u in this._props){const m=a[u];(m===Number||m&&m.type===Number)&&(this._props[u]=Ys(this._props[u]),(f||(f=Object.create(null)))[u]=!0)}this._numberProps=f;for(const u of Object.keys(this))u[0]!=="_"&&this._setProp(u,this[u],!0,!1);for(const u of l.map(M0))Object.defineProperty(this,u,{get(){return this._getProp(u)},set(m){this._setProp(u,m)}});this._applyStyles(i),this._update()},n=this._def.__asyncLoader;n?n().then(t):t(this._def)}_setAttr(t){let n=this.getAttribute(t);this._numberProps&&this._numberProps[t]&&(n=Ys(n)),this._setProp(M0(t),n,!1)}_getProp(t){return this._props[t]}_setProp(t,n,r=!0,a=!0){n!==this._props[t]&&(this._props[t]=n,a&&this._instance&&this._update(),r&&(n===!0?this.setAttribute(Xr(t),""):typeof n=="string"||typeof n=="number"?this.setAttribute(Xr(t),n+""):n||this.removeAttribute(Xr(t))))}_update(){Y0(this._createVNode(),this.shadowRoot)}_createVNode(){const t=Oe(this._def,bi({},this._props));return this._instance||(t.ce=n=>{this._instance=n,n.isCE=!0,n.emit=(a,...i)=>{this.dispatchEvent(new CustomEvent(a,{detail:i}))};let r=this;for(;r=r&&(r.parentNode||r.host);)if(r instanceof Zs){n.parent=r._instance;break}}),t}_applyStyles(t){t&&t.forEach(n=>{const r=document.createElement("style");r.textContent=n,this.shadowRoot.appendChild(r)})}}const rr="transition",yi="animation",It=(e,{slots:t})=>yf(Xl,j0(e),t);It.displayName="Transition";const L0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},em=It.props=bi({},Xl.props,L0),yr=(e,t=[])=>{xi(e)?e.forEach(n=>n(...t)):e&&e(...t)},F0=e=>e?xi(e)?e.some(t=>t.length>1):e.length>1:!1;function j0(e){const t={};for(const x in e)x in L0||(t[x]=e[x]);if(e.css===!1)return t;const{name:n="v",type:r,duration:a,enterFromClass:i=`${n}-enter-from`,enterActiveClass:s=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:f=i,appearActiveClass:u=s,appearToClass:m=l,leaveFromClass:c=`${n}-leave-from`,leaveActiveClass:b=`${n}-leave-active`,leaveToClass:_=`${n}-leave-to`}=e,o=tm(a),B=o&&o[0],T=o&&o[1],{onBeforeEnter:C,onEnter:p,onEnterCancelled:A,onLeave:F,onLeaveCancelled:R,onBeforeAppear:I=C,onAppear:h=p,onAppearCancelled:M=A}=t,S=(x,w,k)=>{ir(x,w?m:l),ir(x,w?u:s),k&&k()},v=(x,w)=>{x._isLeaving=!1,ir(x,c),ir(x,_),ir(x,b),w&&w()},y=x=>(w,k)=>{const g=x?h:p,D=()=>S(w,x,k);yr(g,[w,D]),N0(()=>{ir(w,x?f:i),Un(w,x?m:l),F0(g)||D0(w,r,B,D)})};return bi(t,{onBeforeEnter(x){yr(C,[x]),Un(x,i),Un(x,s)},onBeforeAppear(x){yr(I,[x]),Un(x,f),Un(x,u)},onEnter:y(!1),onAppear:y(!0),onLeave(x,w){x._isLeaving=!0;const k=()=>v(x,w);Un(x,c),V0(),Un(x,b),N0(()=>{!x._isLeaving||(ir(x,c),Un(x,_),F0(F)||D0(x,r,T,k))}),yr(F,[x,k])},onEnterCancelled(x){S(x,!1),yr(A,[x])},onAppearCancelled(x){S(x,!0),yr(M,[x])},onLeaveCancelled(x){v(x),yr(R,[x])}})}function tm(e){if(e==null)return null;if(Rf(e))return[Qs(e.enter),Qs(e.leave)];{const t=Qs(e);return[t,t]}}function Qs(e){return Ys(e)}function Un(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function ir(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function N0(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let nm=0;function D0(e,t,n,r){const a=e._endId=++nm,i=()=>{a===e._endId&&r()};if(n)return setTimeout(i,n);const{type:s,timeout:l,propCount:f}=H0(e,t);if(!s)return r();const u=s+"end";let m=0;const c=()=>{e.removeEventListener(u,b),i()},b=_=>{_.target===e&&++m>=f&&c()};setTimeout(()=>{m<f&&c()},l+1),e.addEventListener(u,b)}function H0(e,t){const n=window.getComputedStyle(e),r=o=>(n[o]||"").split(", "),a=r(rr+"Delay"),i=r(rr+"Duration"),s=z0(a,i),l=r(yi+"Delay"),f=r(yi+"Duration"),u=z0(l,f);let m=null,c=0,b=0;t===rr?s>0&&(m=rr,c=s,b=i.length):t===yi?u>0&&(m=yi,c=u,b=f.length):(c=Math.max(s,u),m=c>0?s>u?rr:yi:null,b=m?m===rr?i.length:f.length:0);const _=m===rr&&/\b(transform|all)(,|$)/.test(n[rr+"Property"]);return{type:m,timeout:c,propCount:b,hasTransform:_}}function z0(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,r)=>P0(n)+P0(e[r])))}function P0(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function V0(){return document.body.offsetHeight}const U0=new WeakMap,q0=new WeakMap,Js={name:"TransitionGroup",props:bi({},em,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=x0(),r=ql();let a,i;return Zl(()=>{if(!a.length)return;const s=e.moveClass||`${e.name||"v"}-move`;if(!sm(a[0].el,n.vnode.el,s))return;a.forEach(rm),a.forEach(im);const l=a.filter(am);V0(),l.forEach(f=>{const u=f.el,m=u.style;Un(u,s),m.transform=m.webkitTransform=m.transitionDuration="";const c=u._moveCb=b=>{b&&b.target!==u||(!b||/transform$/.test(b.propertyName))&&(u.removeEventListener("transitionend",c),u._moveCb=null,ir(u,s))};u.addEventListener("transitionend",c)})}),()=>{const s=mt(e),l=j0(s);let f=s.tag||st;a=i,i=t.default?Is(t.default()):[];for(let u=0;u<i.length;u++){const m=i[u];m.key!=null&&hi(m,mi(m,l,r,n))}if(a)for(let u=0;u<a.length;u++){const m=a[u];hi(m,mi(m,l,r,n)),U0.set(m,m.el.getBoundingClientRect())}return Oe(f,null,i)}}};function rm(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function im(e){q0.set(e,e.el.getBoundingClientRect())}function am(e){const t=U0.get(e),n=q0.get(e),r=t.left-n.left,a=t.top-n.top;if(r||a){const i=e.el.style;return i.transform=i.webkitTransform=`translate(${r}px,${a}px)`,i.transitionDuration="0s",e}}function sm(e,t,n){const r=e.cloneNode();e._vtc&&e._vtc.forEach(s=>{s.split(/\s+/).forEach(l=>l&&r.classList.remove(l))}),n.split(/\s+/).forEach(s=>s&&r.classList.add(s)),r.style.display="none";const a=t.nodeType===1?t:t.parentNode;a.appendChild(r);const{hasTransform:i}=H0(r);return a.removeChild(r),i}const om=["ctrl","shift","alt","meta"],lm={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>om.some(n=>e[`${n}Key`]&&!t.includes(n))},Rn=(e,t)=>(n,...r)=>{for(let a=0;a<t.length;a++){const i=lm[t[a]];if(i&&i(n,t))return}return e(n,...r)},cm={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},wr=(e,t)=>n=>{if(!("key"in n))return;const r=Xr(n.key);if(t.some(a=>a===r||cm[a]===r))return e(n)},xa={beforeMount(e,{value:t},{transition:n}){e._vod=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):wi(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!=!n&&(r?t?(r.beforeEnter(e),wi(e,!0),r.enter(e)):r.leave(e,()=>{wi(e,!1)}):wi(e,t))},beforeUnmount(e,{value:t}){wi(e,t)}};function wi(e,t){e.style.display=t?e._vod:"none"}const um=bi({patchProp:Zf},Lf);let X0;function dm(){return X0||(X0=af(um))}const Y0=(...e)=>{dm().render(...e)};var xt=(e,t)=>{const n=e.__vccOpts||e;for(const[r,a]of t)n[r]=a;return n};const fm={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},mm=ke("div",{id:"vac-circle"},null,-1),hm=ke("div",{id:"vac-circle"},null,-1),vm=ke("div",{id:"vac-circle"},null,-1),pm=ke("div",{id:"vac-circle"},null,-1),_m=ke("div",{id:"vac-circle"},null,-1),gm=ke("div",{id:"vac-circle"},null,-1);function bm(e,t,n,r,a,i){return Q(),dt(It,{name:"vac-fade-spinner",appear:""},{default:Ke(()=>[n.show?(Q(),se("div",{key:0,class:nt(["vac-loader-wrapper",{"vac-container-center":!n.infinite,"vac-container-top":n.infinite}])},[n.type==="rooms"?Re(e.$slots,"spinner-icon-rooms",{key:0},()=>[mm]):Te("",!0),n.type==="infinite-rooms"?Re(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[hm]):Te("",!0),n.type==="message-file"?Re(e.$slots,"spinner-icon-message-file_"+n.messageId,{key:2},()=>[vm]):Te("",!0),n.type==="room-file"?Re(e.$slots,"spinner-icon-room-file",{key:3},()=>[pm]):Te("",!0),n.type==="messages"?Re(e.$slots,"spinner-icon-messages",{key:4},()=>[_m]):Te("",!0),n.type==="infinite-messages"?Re(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[gm]):Te("",!0)],2)):Te("",!0)]),_:3})}var ki=xt(fm,[["render",bm]]);const xm={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},safe:{path:"M 12 1 C 8.6761905 1 6 3.6761905 6 7 L 6 8 C 4.9 8 4 8.9 4 10 L 4 20 C 4 21.1 4.9 22 6 22 L 18 22 C 19.1 22 20 21.1 20 20 L 20 10 C 20 8.9 19.1 8 18 8 L 18 7 C 18 3.6761905 15.32381 1 12 1 z M 12 3 C 14.27619 3 16 4.7238095 16 7 L 16 8 L 8 8 L 8 7 C 8 4.7238095 9.7238095 3 12 3 z M 12 13 C 13.1 13 14 13.9 14 15 C 14 16.1 13.1 17 12 17 C 10.9 17 10 16.1 10 15 C 10 13.9 10.9 13 12 13 z"},unsafe:{path:"M 12 1 C 9.1277778 1 6.7189086 3.0461453 6.1230469 5.7871094 L 8.078125 6.2128906 C 8.4822632 4.3538547 10.072222 3 12 3 C 14.27619 3 16 4.7238095 16 7 L 16 8 L 6 8 C 4.9 8 4 8.9 4 10 L 4 20 C 4 21.1 4.9 22 6 22 L 18 22 C 19.1 22 20 21.1 20 20 L 20 10 C 20 8.9 19.1 8 18 8 L 18 7 C 18 3.6761905 15.32381 1 12 1 z M 12 13 C 13.1 13 14 13.9 14 15 C 14 16.1 13.1 17 12 17 C 10.9 17 10 16.1 10 15 C 10 13.9 10.9 13 12 13 z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return e.size==="large"?512:e.size==="medium"?48:24}}},ym=["viewBox"],wm=["id","d"],km=["id","d"];function Sm(e,t,n,r,a,i){return Q(),se("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${i.size} ${i.size}`},[ke("path",{id:i.svgId,d:a.svgItem[n.name].path},null,8,wm),a.svgItem[n.name].path2?(Q(),se("path",{key:0,id:i.svgId,d:a.svgItem[n.name].path2},null,8,km)):Te("",!0)],8,ym)}var Dt=xt(xm,[["render",Sm]]);const Am={name:"RoomsSearch",components:{SvgIcon:Dt},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},Mm={key:0,class:"vac-icon-search"},Em=["placeholder"];function Tm(e,t,n,r,a,i){const s=Xe("svg-icon");return Q(),se("div",{class:nt({"vac-box-search":i.showSearchBar,"vac-box-empty":!i.showSearchBar})},[n.showSearch?(Q(),se(st,{key:0},[!n.loadingRooms&&n.rooms.length?(Q(),se("div",Mm,[Re(e.$slots,"search-icon",{},()=>[Oe(s,{name:"search"})])])):Te("",!0),!n.loadingRooms&&n.rooms.length?(Q(),se("input",{key:1,type:"search",placeholder:n.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=l=>e.$emit("search-room",l))},null,40,Em)):Te("",!0)],64)):Te("",!0),n.showAddRoom?(Q(),se("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=l=>e.$emit("add-room"))},[Re(e.$slots,"add-icon",{},()=>[Oe(s,{name:"add"})])])):Te("",!0)],2)}var Rm=xt(Am,[["render",Tm]]);const K0=document.createElement("i");function ya(e){const t="&"+e+";";K0.innerHTML=t;const n=K0.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function an(e,t,n,r){const a=e.length;let i=0,s;if(t<0?t=-t>a?0:a+t:t=t>a?a:t,n=n>0?n:0,r.length<1e4)s=Array.from(r),s.unshift(t,n),e.splice(...s);else for(n&&e.splice(t,n);i<r.length;)s=r.slice(i,i+1e4),s.unshift(t,0),e.splice(...s),i+=1e4,t+=1e4}function zt(e,t){return e.length>0?(an(e,e.length,0,t),e):t}const $s={}.hasOwnProperty;function G0(e){const t={};let n=-1;for(;++n<e.length;)Cm(t,e[n]);return t}function Cm(e,t){let n;for(n in t){const a=($s.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let s;if(i)for(s in i){$s.call(a,s)||(a[s]=[]);const l=i[s];Im(a[s],Array.isArray(l)?l:l?[l]:[])}}}function Im(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);an(e,0,0,r)}function W0(e){const t={};let n=-1;for(;++n<e.length;)Bm(t,e[n]);return t}function Bm(e,t){let n;for(n in t){const a=($s.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let s;if(i)for(s in i)a[s]=i[s]}}function Om(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"\uFFFD":String.fromCharCode(n)}const Lm={'"':"quot","&":"amp","<":"lt",">":"gt"};function Z0(e){return e.replace(/["&<>]/g,t);function t(n){return"&"+Lm[n]+";"}}function Cn(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Fm=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/,Gt=ar(/[A-Za-z]/),Pt=ar(/[\dA-Za-z]/),jm=ar(/[#-'*+\--9=?A-Z^-~]/);function wa(e){return e!==null&&(e<32||e===127)}const eo=ar(/\d/),Nm=ar(/[\dA-Fa-f]/),Dm=ar(/[!-/:-@[-`{-~]/);function We(e){return e!==null&&e<-2}function yt(e){return e!==null&&(e<0||e===32)}function at(e){return e===-2||e===-1||e===32}const to=ar(Fm),Yr=ar(/\s/);function ar(e){return t;function t(n){return n!==null&&e.test(String.fromCharCode(n))}}function kr(e,t){const n=Z0(Hm(e||""));if(!t)return n;const r=n.indexOf(":"),a=n.indexOf("?"),i=n.indexOf("#"),s=n.indexOf("/");return r<0||s>-1&&r>s||a>-1&&r>a||i>-1&&r>i||t.test(n.slice(0,r))?n:""}function Hm(e){const t=[];let n=-1,r=0,a=0;for(;++n<e.length;){const i=e.charCodeAt(n);let s="";if(i===37&&Pt(e.charCodeAt(n+1))&&Pt(e.charCodeAt(n+2)))a=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(s=String.fromCharCode(i));else if(i>55295&&i<57344){const l=e.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(s=String.fromCharCode(i,l),a=1):s="\uFFFD"}else s=String.fromCharCode(i);s&&(t.push(e.slice(r,n),encodeURIComponent(s)),r=n+a+1,s=""),a&&(n+=a,a=0)}return t.join("")+e.slice(r)}const Q0={}.hasOwnProperty,J0=/^(https?|ircs?|mailto|xmpp)$/i,zm=/^https?$/i;function Pm(e){const t=e||{};let n=!0;const r={},a=[[]],i=[],s=[],f=W0([{enter:{blockQuote:k,codeFenced:z,codeFencedFenceInfo:T,codeFencedFenceMeta:T,codeIndented:E,codeText:q,content:Ee,definition:P,definitionDestinationString:ne,definitionLabelString:T,definitionTitleString:T,emphasis:N,htmlFlow:ee,htmlText:L,image:O,label:T,link:me,listItemMarker:v,listItemValue:S,listOrdered:h,listUnordered:M,paragraph:D,reference:T,resource:De,resourceDestinationString:Ce,resourceTitleString:T,setextHeading:Me,strong:V},exit:{atxHeading:ze,atxHeadingSequence:ye,autolinkEmail:le,autolinkProtocol:te,blockQuote:g,characterEscapeValue:Ve,characterReferenceMarkerHexadecimal:G,characterReferenceMarkerNumeric:G,characterReferenceValue:oe,codeFenced:W,codeFencedFence:d,codeFencedFenceInfo:U,codeFencedFenceMeta:C,codeFlowValue:ue,codeIndented:W,codeText:K,codeTextData:Ve,data:Ve,definition:Ae,definitionDestinationString:ce,definitionLabelString:X,definitionTitleString:de,emphasis:H,hardBreakEscape:we,hardBreakTrailing:we,htmlFlow:Be,htmlFlowData:Ve,htmlText:Be,htmlTextData:Ve,image:rt,label:_e,labelText:Se,lineEnding:Ge,link:rt,listOrdered:y,listUnordered:x,paragraph:Y,reference:C,referenceString:pe,resource:C,resourceDestinationString:he,resourceTitleString:Ue,setextHeading:Pe,setextHeadingLineSequence:je,setextHeadingText:ge,strong:Z,thematicBreak:$}}].concat(t.htmlExtensions||[])),u={tightStack:s,definitions:r},m={lineEndingIfNeeded:R,options:t,encode:I,raw:A,tag:p,buffer:T,resume:C,setData:o,getData:B};let c=t.defaultLineEnding;return b;function b(J){let ve=-1,fe=0;const He=[];let re=[],Le=[];for(;++ve<J.length;)!c&&(J[ve][1].type==="lineEnding"||J[ve][1].type==="lineEndingBlank")&&(c=J[ve][2].sliceSerialize(J[ve][1])),(J[ve][1].type==="listOrdered"||J[ve][1].type==="listUnordered")&&(J[ve][0]==="enter"?He.push(ve):_(J.slice(He.pop(),ve))),J[ve][1].type==="definition"&&(J[ve][0]==="enter"?(Le=zt(Le,J.slice(fe,ve)),fe=ve):(re=zt(re,J.slice(fe,ve+1)),fe=ve+1));re=zt(re,Le),re=zt(re,J.slice(fe)),ve=-1;const Ye=re;for(f.enter.null&&f.enter.null.call(m);++ve<J.length;){const be=f[Ye[ve][0]],Ne=Ye[ve][1].type,xe=be[Ne];Q0.call(be,Ne)&&xe&&xe.call(Object.assign({sliceSerialize:Ye[ve][2].sliceSerialize},m),Ye[ve][1])}return f.exit.null&&f.exit.null.call(m),a[0].join("")}function _(J){const ve=J.length;let fe=0,He=0,re=!1,Le;for(;++fe<ve;){const Ye=J[fe];if(Ye[1]._container)Le=void 0,Ye[0]==="enter"?He++:He--;else switch(Ye[1].type){case"listItemPrefix":{Ye[0]==="exit"&&(Le=!0);break}case"linePrefix":break;case"lineEndingBlank":{Ye[0]==="enter"&&!He&&(Le?Le=void 0:re=!0);break}default:Le=void 0}}J[0][1]._loose=re}function o(J,ve){u[J]=ve}function B(J){return u[J]}function T(){a.push([])}function C(){return a.pop().join("")}function p(J){!n||(o("lastWasTag",!0),a[a.length-1].push(J))}function A(J){o("lastWasTag"),a[a.length-1].push(J)}function F(){A(c||`
`)}function R(){const J=a[a.length-1],ve=J[J.length-1],fe=ve?ve.charCodeAt(ve.length-1):null;fe===10||fe===13||fe===null||F()}function I(J){return B("ignoreEncode")?J:Z0(J)}function h(J){s.push(!J._loose),R(),p("<ol"),o("expectFirstItem",!0)}function M(J){s.push(!J._loose),R(),p("<ul"),o("expectFirstItem",!0)}function S(J){if(B("expectFirstItem")){const ve=Number.parseInt(this.sliceSerialize(J),10);ve!==1&&p(' start="'+I(String(ve))+'"')}}function v(){B("expectFirstItem")?p(">"):w(),R(),p("<li>"),o("expectFirstItem"),o("lastWasTag")}function y(){w(),s.pop(),F(),p("</ol>")}function x(){w(),s.pop(),F(),p("</ul>")}function w(){B("lastWasTag")&&!B("slurpAllLineEndings")&&R(),p("</li>"),o("slurpAllLineEndings")}function k(){s.push(!1),R(),p("<blockquote>")}function g(){s.pop(),R(),p("</blockquote>"),o("slurpAllLineEndings")}function D(){s[s.length-1]||(R(),p("<p>")),o("slurpAllLineEndings")}function Y(){s[s.length-1]?o("slurpAllLineEndings",!0):p("</p>")}function z(){R(),p("<pre><code"),o("fencesCount",0)}function U(){const J=C();p(' class="language-'+J+'"')}function d(){const J=B("fencesCount")||0;J||(p(">"),o("slurpOneLineEnding",!0)),o("fencesCount",J+1)}function E(){R(),p("<pre><code>")}function W(){const J=B("fencesCount");J!==void 0&&J<2&&u.tightStack.length>0&&!B("lastWasTag")&&F(),B("flowCodeSeenData")&&R(),p("</code></pre>"),J!==void 0&&J<2&&R(),o("flowCodeSeenData"),o("fencesCount"),o("slurpOneLineEnding")}function O(){i.push({image:!0}),n=void 0}function me(){i.push({})}function Se(J){i[i.length-1].labelId=this.sliceSerialize(J)}function _e(){i[i.length-1].label=C()}function pe(J){i[i.length-1].referenceId=this.sliceSerialize(J)}function De(){T(),i[i.length-1].destination=""}function Ce(){T(),o("ignoreEncode",!0)}function he(){i[i.length-1].destination=C(),o("ignoreEncode")}function Ue(){i[i.length-1].title=C()}function rt(){let J=i.length-1;const ve=i[J],fe=ve.referenceId||ve.labelId,He=ve.destination===void 0?r[Cn(fe)]:ve;for(n=!0;J--;)if(i[J].image){n=void 0;break}ve.image?(p('<img src="'+kr(He.destination,t.allowDangerousProtocol?void 0:zm)+'" alt="'),A(ve.label),p('"')):p('<a href="'+kr(He.destination,t.allowDangerousProtocol?void 0:J0)+'"'),p(He.title?' title="'+He.title+'"':""),ve.image?p(" />"):(p(">"),A(ve.label),p("</a>")),i.pop()}function P(){T(),i.push({})}function X(J){C(),i[i.length-1].labelId=this.sliceSerialize(J)}function ne(){T(),o("ignoreEncode",!0)}function ce(){i[i.length-1].destination=C(),o("ignoreEncode")}function de(){i[i.length-1].title=C()}function Ae(){const J=i[i.length-1],ve=Cn(J.labelId);C(),Q0.call(r,ve)||(r[ve]=i[i.length-1]),i.pop()}function Ee(){o("slurpAllLineEndings",!0)}function ye(J){B("headingRank")||(o("headingRank",this.sliceSerialize(J).length),R(),p("<h"+B("headingRank")+">"))}function Me(){T(),o("slurpAllLineEndings")}function ge(){o("slurpAllLineEndings",!0)}function ze(){p("</h"+B("headingRank")+">"),o("headingRank")}function je(J){o("headingRank",this.sliceSerialize(J).charCodeAt(0)===61?1:2)}function Pe(){const J=C();R(),p("<h"+B("headingRank")+">"),A(J),p("</h"+B("headingRank")+">"),o("slurpAllLineEndings"),o("headingRank")}function Ve(J){A(I(this.sliceSerialize(J)))}function Ge(J){if(!B("slurpAllLineEndings")){if(B("slurpOneLineEnding")){o("slurpOneLineEnding");return}if(B("inCodeText")){A(" ");return}A(I(this.sliceSerialize(J)))}}function ue(J){A(I(this.sliceSerialize(J))),o("flowCodeSeenData",!0)}function we(){p("<br />")}function ee(){R(),L()}function Be(){o("ignoreEncode")}function L(){t.allowDangerousHtml&&o("ignoreEncode",!0)}function N(){p("<em>")}function V(){p("<strong>")}function q(){o("inCodeText",!0),p("<code>")}function K(){o("inCodeText"),p("</code>")}function H(){p("</em>")}function Z(){p("</strong>")}function $(){R(),p("<hr />")}function G(J){o("characterReferenceType",J.type)}function oe(J){let ve=this.sliceSerialize(J);ve=B("characterReferenceType")?Om(ve,B("characterReferenceType")==="characterReferenceMarkerNumeric"?10:16):ya(ve),A(I(ve)),o("characterReferenceType")}function te(J){const ve=this.sliceSerialize(J);p('<a href="'+kr(ve,t.allowDangerousProtocol?void 0:J0)+'">'),A(I(ve)),p("</a>")}function le(J){const ve=this.sliceSerialize(J);p('<a href="'+kr("mailto:"+ve)+'">'),A(I(ve)),p("</a>")}}function lt(e,t,n,r){const a=r?r-1:Number.POSITIVE_INFINITY;let i=0;return s;function s(f){return at(f)?(e.enter(n),l(f)):t(f)}function l(f){return at(f)&&i++<a?(e.consume(f),l):(e.exit(n),t(f))}}const Vm={tokenize:Um};function Um(e){const t=e.attempt(this.parser.constructs.contentInitial,r,a);let n;return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),lt(e,t,"linePrefix")}function a(l){return e.enter("paragraph"),i(l)}function i(l){const f=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=f),n=f,s(l)}function s(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return We(l)?(e.consume(l),e.exit("chunkText"),i):(e.consume(l),s)}}const qm={tokenize:Xm},$0={tokenize:Ym};function Xm(e){const t=this,n=[];let r=0,a,i,s;return l;function l(A){if(r<n.length){const F=n[r];return t.containerState=F[1],e.attempt(F[0].continuation,f,u)(A)}return u(A)}function f(A){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,a&&p();const F=t.events.length;let R=F,I;for(;R--;)if(t.events[R][0]==="exit"&&t.events[R][1].type==="chunkFlow"){I=t.events[R][1].end;break}C(r);let h=F;for(;h<t.events.length;)t.events[h][1].end=Object.assign({},I),h++;return an(t.events,R+1,0,t.events.slice(F)),t.events.length=h,u(A)}return l(A)}function u(A){if(r===n.length){if(!a)return b(A);if(a.currentConstruct&&a.currentConstruct.concrete)return o(A);t.interrupt=Boolean(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return t.containerState={},e.check($0,m,c)(A)}function m(A){return a&&p(),C(r),b(A)}function c(A){return t.parser.lazy[t.now().line]=r!==n.length,s=t.now().offset,o(A)}function b(A){return t.containerState={},e.attempt($0,_,o)(A)}function _(A){return r++,n.push([t.currentConstruct,t.containerState]),b(A)}function o(A){if(A===null){a&&p(),C(0),e.consume(A);return}return a=a||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:a}),B(A)}function B(A){if(A===null){T(e.exit("chunkFlow"),!0),C(0),e.consume(A);return}return We(A)?(e.consume(A),T(e.exit("chunkFlow")),r=0,t.interrupt=void 0,l):(e.consume(A),B)}function T(A,F){const R=t.sliceStream(A);if(F&&R.push(null),A.previous=i,i&&(i.next=A),i=A,a.defineSkip(A.start),a.write(R),t.parser.lazy[A.start.line]){let I=a.events.length;for(;I--;)if(a.events[I][1].start.offset<s&&(!a.events[I][1].end||a.events[I][1].end.offset>s))return;const h=t.events.length;let M=h,S,v;for(;M--;)if(t.events[M][0]==="exit"&&t.events[M][1].type==="chunkFlow"){if(S){v=t.events[M][1].end;break}S=!0}for(C(r),I=h;I<t.events.length;)t.events[I][1].end=Object.assign({},v),I++;an(t.events,M+1,0,t.events.slice(h)),t.events.length=I}}function C(A){let F=n.length;for(;F-- >A;){const R=n[F];t.containerState=R[1],R[0].exit.call(t,e)}n.length=A}function p(){a.write([null]),i=void 0,a=void 0,t.containerState._closeFlow=void 0}}function Ym(e,t,n){return lt(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function ka(e){if(e===null||yt(e)||Yr(e))return 1;if(to(e))return 2}function Sa(e,t,n){const r=[];let a=-1;for(;++a<e.length;){const i=e[a].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const no={name:"attention",tokenize:Gm,resolveAll:Km};function Km(e,t){let n=-1,r,a,i,s,l,f,u,m;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;f=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const c=Object.assign({},e[r][1].end),b=Object.assign({},e[n][1].start);ec(c,-f),ec(b,f),s={type:f>1?"strongSequence":"emphasisSequence",start:c,end:Object.assign({},e[r][1].end)},l={type:f>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[n][1].start),end:b},i={type:f>1?"strongText":"emphasisText",start:Object.assign({},e[r][1].end),end:Object.assign({},e[n][1].start)},a={type:f>1?"strong":"emphasis",start:Object.assign({},s.start),end:Object.assign({},l.end)},e[r][1].end=Object.assign({},s.start),e[n][1].start=Object.assign({},l.end),u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=zt(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=zt(u,[["enter",a,t],["enter",s,t],["exit",s,t],["enter",i,t]]),u=zt(u,Sa(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=zt(u,[["exit",i,t],["enter",l,t],["exit",l,t],["exit",a,t]]),e[n][1].end.offset-e[n][1].start.offset?(m=2,u=zt(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):m=0,an(e,r-1,n-r+3,u),n=r+u.length-m-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function Gm(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,a=ka(r);let i;return s;function s(f){return i=f,e.enter("attentionSequence"),l(f)}function l(f){if(f===i)return e.consume(f),l;const u=e.exit("attentionSequence"),m=ka(f),c=!m||m===2&&a||n.includes(f),b=!a||a===2&&m||n.includes(r);return u._open=Boolean(i===42?c:c&&(a||!b)),u._close=Boolean(i===42?b:b&&(m||!c)),t(f)}}function ec(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Wm={name:"autolink",tokenize:Zm};function Zm(e,t,n){let r=0;return a;function a(_){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(_),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(_){return Gt(_)?(e.consume(_),s):u(_)}function s(_){return _===43||_===45||_===46||Pt(_)?(r=1,l(_)):u(_)}function l(_){return _===58?(e.consume(_),r=0,f):(_===43||_===45||_===46||Pt(_))&&r++<32?(e.consume(_),l):(r=0,u(_))}function f(_){return _===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(_),e.exit("autolinkMarker"),e.exit("autolink"),t):_===null||_===32||_===60||wa(_)?n(_):(e.consume(_),f)}function u(_){return _===64?(e.consume(_),m):jm(_)?(e.consume(_),u):n(_)}function m(_){return Pt(_)?c(_):n(_)}function c(_){return _===46?(e.consume(_),r=0,m):_===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(_),e.exit("autolinkMarker"),e.exit("autolink"),t):b(_)}function b(_){if((_===45||Pt(_))&&r++<63){const o=_===45?b:c;return e.consume(_),o}return n(_)}}const Si={tokenize:Qm,partial:!0};function Qm(e,t,n){return r;function r(i){return at(i)?lt(e,a,"linePrefix")(i):a(i)}function a(i){return i===null||We(i)?t(i):n(i)}}const tc={name:"blockQuote",tokenize:Jm,continuation:{tokenize:$m},exit:eh};function Jm(e,t,n){const r=this;return a;function a(s){if(s===62){const l=r.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(s),e.exit("blockQuoteMarker"),i}return n(s)}function i(s){return at(s)?(e.enter("blockQuotePrefixWhitespace"),e.consume(s),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(s))}}function $m(e,t,n){const r=this;return a;function a(s){return at(s)?lt(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s):i(s)}function i(s){return e.attempt(tc,t,n)(s)}}function eh(e){e.exit("blockQuote")}const nc={name:"characterEscape",tokenize:th};function th(e,t,n){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),a}function a(i){return Dm(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}const rc={name:"characterReference",tokenize:nh};function nh(e,t,n){const r=this;let a=0,i,s;return l;function l(c){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),f}function f(c){return c===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(c),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),i=31,s=Pt,m(c))}function u(c){return c===88||c===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(c),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,s=Nm,m):(e.enter("characterReferenceValue"),i=7,s=eo,m(c))}function m(c){if(c===59&&a){const b=e.exit("characterReferenceValue");return s===Pt&&!ya(r.sliceSerialize(b))?n(c):(e.enter("characterReferenceMarker"),e.consume(c),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return s(c)&&a++<i?(e.consume(c),m):n(c)}}const ic={tokenize:ih,partial:!0},ac={name:"codeFenced",tokenize:rh,concrete:!0};function rh(e,t,n){const r=this,a={tokenize:R,partial:!0};let i=0,s=0,l;return f;function f(I){return u(I)}function u(I){const h=r.events[r.events.length-1];return i=h&&h[1].type==="linePrefix"?h[2].sliceSerialize(h[1],!0).length:0,l=I,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),m(I)}function m(I){return I===l?(s++,e.consume(I),m):s<3?n(I):(e.exit("codeFencedFenceSequence"),at(I)?lt(e,c,"whitespace")(I):c(I))}function c(I){return I===null||We(I)?(e.exit("codeFencedFence"),r.interrupt?t(I):e.check(ic,B,F)(I)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),b(I))}function b(I){return I===null||We(I)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(I)):at(I)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),lt(e,_,"whitespace")(I)):I===96&&I===l?n(I):(e.consume(I),b)}function _(I){return I===null||We(I)?c(I):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),o(I))}function o(I){return I===null||We(I)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(I)):I===96&&I===l?n(I):(e.consume(I),o)}function B(I){return e.attempt(a,F,T)(I)}function T(I){return e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),C}function C(I){return i>0&&at(I)?lt(e,p,"linePrefix",i+1)(I):p(I)}function p(I){return I===null||We(I)?e.check(ic,B,F)(I):(e.enter("codeFlowValue"),A(I))}function A(I){return I===null||We(I)?(e.exit("codeFlowValue"),p(I)):(e.consume(I),A)}function F(I){return e.exit("codeFenced"),t(I)}function R(I,h,M){let S=0;return v;function v(g){return I.enter("lineEnding"),I.consume(g),I.exit("lineEnding"),y}function y(g){return I.enter("codeFencedFence"),at(g)?lt(I,x,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(g):x(g)}function x(g){return g===l?(I.enter("codeFencedFenceSequence"),w(g)):M(g)}function w(g){return g===l?(S++,I.consume(g),w):S>=s?(I.exit("codeFencedFenceSequence"),at(g)?lt(I,k,"whitespace")(g):k(g)):M(g)}function k(g){return g===null||We(g)?(I.exit("codeFencedFence"),h(g)):M(g)}}}function ih(e,t,n){const r=this;return a;function a(s){return s===null?n(s):(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),i)}function i(s){return r.parser.lazy[r.now().line]?n(s):t(s)}}const ro={name:"codeIndented",tokenize:sh},ah={tokenize:oh,partial:!0};function sh(e,t,n){const r=this;return a;function a(u){return e.enter("codeIndented"),lt(e,i,"linePrefix",4+1)(u)}function i(u){const m=r.events[r.events.length-1];return m&&m[1].type==="linePrefix"&&m[2].sliceSerialize(m[1],!0).length>=4?s(u):n(u)}function s(u){return u===null?f(u):We(u)?e.attempt(ah,s,f)(u):(e.enter("codeFlowValue"),l(u))}function l(u){return u===null||We(u)?(e.exit("codeFlowValue"),s(u)):(e.consume(u),l)}function f(u){return e.exit("codeIndented"),t(u)}}function oh(e,t,n){const r=this;return a;function a(s){return r.parser.lazy[r.now().line]?n(s):We(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),a):lt(e,i,"linePrefix",4+1)(s)}function i(s){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(s):We(s)?a(s):n(s)}}const lh={name:"codeText",tokenize:dh,resolve:ch,previous:uh};function ch(e){let t=e.length-4,n=3,r,a;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)a===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(a=r):(r===t||e[r][1].type==="lineEnding")&&(e[a][1].type="codeTextData",r!==a+2&&(e[a][1].end=e[r-1][1].end,e.splice(a+2,r-a-2),t-=r-a-2,r=a+2),a=void 0);return e}function uh(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function dh(e,t,n){let r=0,a,i;return s;function s(c){return e.enter("codeText"),e.enter("codeTextSequence"),l(c)}function l(c){return c===96?(e.consume(c),r++,l):(e.exit("codeTextSequence"),f(c))}function f(c){return c===null?n(c):c===32?(e.enter("space"),e.consume(c),e.exit("space"),f):c===96?(i=e.enter("codeTextSequence"),a=0,m(c)):We(c)?(e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),f):(e.enter("codeTextData"),u(c))}function u(c){return c===null||c===32||c===96||We(c)?(e.exit("codeTextData"),f(c)):(e.consume(c),u)}function m(c){return c===96?(e.consume(c),a++,m):a===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(c)):(i.type="codeTextData",u(c))}}function sc(e){const t={};let n=-1,r,a,i,s,l,f,u;for(;++n<e.length;){for(;n in t;)n=t[n];if(r=e[n],n&&r[1].type==="chunkFlow"&&e[n-1][1].type==="listItemPrefix"&&(f=r[1]._tokenizer.events,i=0,i<f.length&&f[i][1].type==="lineEndingBlank"&&(i+=2),i<f.length&&f[i][1].type==="content"))for(;++i<f.length&&f[i][1].type!=="content";)f[i][1].type==="chunkText"&&(f[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,fh(e,n)),n=t[n],u=!0);else if(r[1]._container){for(i=n,a=void 0;i--&&(s=e[i],s[1].type==="lineEnding"||s[1].type==="lineEndingBlank");)s[0]==="enter"&&(a&&(e[a][1].type="lineEndingBlank"),s[1].type="lineEnding",a=i);a&&(r[1].end=Object.assign({},e[a][1].start),l=e.slice(a,n),l.unshift(r),an(e,a,n-a+1,l))}}return!u}function fh(e,t){const n=e[t][1],r=e[t][2];let a=t-1;const i=[],s=n._tokenizer||r.parser[n.contentType](n.start),l=s.events,f=[],u={};let m,c,b=-1,_=n,o=0,B=0;const T=[B];for(;_;){for(;e[++a][1]!==_;);i.push(a),_._tokenizer||(m=r.sliceStream(_),_.next||m.push(null),c&&s.defineSkip(_.start),_._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=!0),s.write(m),_._isInFirstContentOfListItem&&(s._gfmTasklistFirstContentOfListItem=void 0)),c=_,_=_.next}for(_=n;++b<l.length;)l[b][0]==="exit"&&l[b-1][0]==="enter"&&l[b][1].type===l[b-1][1].type&&l[b][1].start.line!==l[b][1].end.line&&(B=b+1,T.push(B),_._tokenizer=void 0,_.previous=void 0,_=_.next);for(s.events=[],_?(_._tokenizer=void 0,_.previous=void 0):T.pop(),b=T.length;b--;){const C=l.slice(T[b],T[b+1]),p=i.pop();f.unshift([p,p+C.length-1]),an(e,p,2,C)}for(b=-1;++b<f.length;)u[o+f[b][0]]=o+f[b][1],o+=f[b][1]-f[b][0]-1;return u}const mh={tokenize:ph,resolve:vh},hh={tokenize:_h,partial:!0};function vh(e){return sc(e),e}function ph(e,t){let n;return r;function r(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),a(l)}function a(l){return l===null?i(l):We(l)?e.check(hh,s,i)(l):(e.consume(l),a)}function i(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function s(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,a}}function _h(e,t,n){const r=this;return a;function a(s){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),lt(e,i,"linePrefix")}function i(s){if(s===null||We(s))return n(s);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(s):e.interrupt(r.parser.constructs.flow,n,t)(s)}}function oc(e,t,n,r,a,i,s,l,f){const u=f||Number.POSITIVE_INFINITY;let m=0;return c;function c(C){return C===60?(e.enter(r),e.enter(a),e.enter(i),e.consume(C),e.exit(i),b):C===null||C===32||C===41||wa(C)?n(C):(e.enter(r),e.enter(s),e.enter(l),e.enter("chunkString",{contentType:"string"}),B(C))}function b(C){return C===62?(e.enter(i),e.consume(C),e.exit(i),e.exit(a),e.exit(r),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),_(C))}function _(C){return C===62?(e.exit("chunkString"),e.exit(l),b(C)):C===null||C===60||We(C)?n(C):(e.consume(C),C===92?o:_)}function o(C){return C===60||C===62||C===92?(e.consume(C),_):_(C)}function B(C){return!m&&(C===null||C===41||yt(C))?(e.exit("chunkString"),e.exit(l),e.exit(s),e.exit(r),t(C)):m<u&&C===40?(e.consume(C),m++,B):C===41?(e.consume(C),m--,B):C===null||C===32||C===40||wa(C)?n(C):(e.consume(C),C===92?T:B)}function T(C){return C===40||C===41||C===92?(e.consume(C),B):B(C)}}function lc(e,t,n,r,a,i){const s=this;let l=0,f;return u;function u(_){return e.enter(r),e.enter(a),e.consume(_),e.exit(a),e.enter(i),m}function m(_){return l>999||_===null||_===91||_===93&&!f||_===94&&!l&&"_hiddenFootnoteSupport"in s.parser.constructs?n(_):_===93?(e.exit(i),e.enter(a),e.consume(_),e.exit(a),e.exit(r),t):We(_)?(e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),m):(e.enter("chunkString",{contentType:"string"}),c(_))}function c(_){return _===null||_===91||_===93||We(_)||l++>999?(e.exit("chunkString"),m(_)):(e.consume(_),f||(f=!at(_)),_===92?b:c)}function b(_){return _===91||_===92||_===93?(e.consume(_),l++,c):c(_)}}function cc(e,t,n,r,a,i){let s;return l;function l(b){return b===34||b===39||b===40?(e.enter(r),e.enter(a),e.consume(b),e.exit(a),s=b===40?41:b,f):n(b)}function f(b){return b===s?(e.enter(a),e.consume(b),e.exit(a),e.exit(r),t):(e.enter(i),u(b))}function u(b){return b===s?(e.exit(i),f(s)):b===null?n(b):We(b)?(e.enter("lineEnding"),e.consume(b),e.exit("lineEnding"),lt(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),m(b))}function m(b){return b===s||b===null||We(b)?(e.exit("chunkString"),u(b)):(e.consume(b),b===92?c:m)}function c(b){return b===s||b===92?(e.consume(b),m):m(b)}}function Ai(e,t){let n;return r;function r(a){return We(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,r):at(a)?lt(e,r,n?"linePrefix":"lineSuffix")(a):t(a)}}const gh={name:"definition",tokenize:xh},bh={tokenize:yh,partial:!0};function xh(e,t,n){const r=this;let a;return i;function i(_){return e.enter("definition"),s(_)}function s(_){return lc.call(r,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(_)}function l(_){return a=Cn(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),_===58?(e.enter("definitionMarker"),e.consume(_),e.exit("definitionMarker"),f):n(_)}function f(_){return yt(_)?Ai(e,u)(_):u(_)}function u(_){return oc(e,m,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(_)}function m(_){return e.attempt(bh,c,c)(_)}function c(_){return at(_)?lt(e,b,"whitespace")(_):b(_)}function b(_){return _===null||We(_)?(e.exit("definition"),r.parser.defined.push(a),t(_)):n(_)}}function yh(e,t,n){return r;function r(l){return yt(l)?Ai(e,a)(l):n(l)}function a(l){return cc(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return at(l)?lt(e,s,"whitespace")(l):s(l)}function s(l){return l===null||We(l)?t(l):n(l)}}const wh={name:"hardBreakEscape",tokenize:kh};function kh(e,t,n){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),a}function a(i){return We(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}const Sh={name:"headingAtx",tokenize:Mh,resolve:Ah};function Ah(e,t){let n=e.length-2,r=3,a,i;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(a={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},i={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},an(e,r,n-r+1,[["enter",a,t],["enter",i,t],["exit",i,t],["exit",a,t]])),e}function Mh(e,t,n){let r=0;return a;function a(m){return e.enter("atxHeading"),i(m)}function i(m){return e.enter("atxHeadingSequence"),s(m)}function s(m){return m===35&&r++<6?(e.consume(m),s):m===null||yt(m)?(e.exit("atxHeadingSequence"),l(m)):n(m)}function l(m){return m===35?(e.enter("atxHeadingSequence"),f(m)):m===null||We(m)?(e.exit("atxHeading"),t(m)):at(m)?lt(e,l,"whitespace")(m):(e.enter("atxHeadingText"),u(m))}function f(m){return m===35?(e.consume(m),f):(e.exit("atxHeadingSequence"),l(m))}function u(m){return m===null||m===35||yt(m)?(e.exit("atxHeadingText"),l(m)):(e.consume(m),u)}}const Eh=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],uc=["pre","script","style","textarea"],Th={name:"htmlFlow",tokenize:Bh,resolveTo:Ih,concrete:!0},Rh={tokenize:Lh,partial:!0},Ch={tokenize:Oh,partial:!0};function Ih(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function Bh(e,t,n){const r=this;let a,i,s,l,f;return u;function u(O){return m(O)}function m(O){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(O),c}function c(O){return O===33?(e.consume(O),b):O===47?(e.consume(O),i=!0,B):O===63?(e.consume(O),a=3,r.interrupt?t:d):Gt(O)?(e.consume(O),s=String.fromCharCode(O),T):n(O)}function b(O){return O===45?(e.consume(O),a=2,_):O===91?(e.consume(O),a=5,l=0,o):Gt(O)?(e.consume(O),a=4,r.interrupt?t:d):n(O)}function _(O){return O===45?(e.consume(O),r.interrupt?t:d):n(O)}function o(O){const me="CDATA[";return O===me.charCodeAt(l++)?(e.consume(O),l===me.length?r.interrupt?t:x:o):n(O)}function B(O){return Gt(O)?(e.consume(O),s=String.fromCharCode(O),T):n(O)}function T(O){if(O===null||O===47||O===62||yt(O)){const me=O===47,Se=s.toLowerCase();return!me&&!i&&uc.includes(Se)?(a=1,r.interrupt?t(O):x(O)):Eh.includes(s.toLowerCase())?(a=6,me?(e.consume(O),C):r.interrupt?t(O):x(O)):(a=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(O):i?p(O):A(O))}return O===45||Pt(O)?(e.consume(O),s+=String.fromCharCode(O),T):n(O)}function C(O){return O===62?(e.consume(O),r.interrupt?t:x):n(O)}function p(O){return at(O)?(e.consume(O),p):v(O)}function A(O){return O===47?(e.consume(O),v):O===58||O===95||Gt(O)?(e.consume(O),F):at(O)?(e.consume(O),A):v(O)}function F(O){return O===45||O===46||O===58||O===95||Pt(O)?(e.consume(O),F):R(O)}function R(O){return O===61?(e.consume(O),I):at(O)?(e.consume(O),R):A(O)}function I(O){return O===null||O===60||O===61||O===62||O===96?n(O):O===34||O===39?(e.consume(O),f=O,h):at(O)?(e.consume(O),I):M(O)}function h(O){return O===f?(e.consume(O),f=null,S):O===null||We(O)?n(O):(e.consume(O),h)}function M(O){return O===null||O===34||O===39||O===47||O===60||O===61||O===62||O===96||yt(O)?R(O):(e.consume(O),M)}function S(O){return O===47||O===62||at(O)?A(O):n(O)}function v(O){return O===62?(e.consume(O),y):n(O)}function y(O){return O===null||We(O)?x(O):at(O)?(e.consume(O),y):n(O)}function x(O){return O===45&&a===2?(e.consume(O),D):O===60&&a===1?(e.consume(O),Y):O===62&&a===4?(e.consume(O),E):O===63&&a===3?(e.consume(O),d):O===93&&a===5?(e.consume(O),U):We(O)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(Rh,W,w)(O)):O===null||We(O)?(e.exit("htmlFlowData"),w(O)):(e.consume(O),x)}function w(O){return e.check(Ch,k,W)(O)}function k(O){return e.enter("lineEnding"),e.consume(O),e.exit("lineEnding"),g}function g(O){return O===null||We(O)?w(O):(e.enter("htmlFlowData"),x(O))}function D(O){return O===45?(e.consume(O),d):x(O)}function Y(O){return O===47?(e.consume(O),s="",z):x(O)}function z(O){if(O===62){const me=s.toLowerCase();return uc.includes(me)?(e.consume(O),E):x(O)}return Gt(O)&&s.length<8?(e.consume(O),s+=String.fromCharCode(O),z):x(O)}function U(O){return O===93?(e.consume(O),d):x(O)}function d(O){return O===62?(e.consume(O),E):O===45&&a===2?(e.consume(O),d):x(O)}function E(O){return O===null||We(O)?(e.exit("htmlFlowData"),W(O)):(e.consume(O),E)}function W(O){return e.exit("htmlFlow"),t(O)}}function Oh(e,t,n){const r=this;return a;function a(s){return We(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),i):n(s)}function i(s){return r.parser.lazy[r.now().line]?n(s):t(s)}}function Lh(e,t,n){return r;function r(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Si,t,n)}}const Fh={name:"htmlText",tokenize:jh};function jh(e,t,n){const r=this;let a,i,s;return l;function l(d){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(d),f}function f(d){return d===33?(e.consume(d),u):d===47?(e.consume(d),R):d===63?(e.consume(d),A):Gt(d)?(e.consume(d),M):n(d)}function u(d){return d===45?(e.consume(d),m):d===91?(e.consume(d),i=0,o):Gt(d)?(e.consume(d),p):n(d)}function m(d){return d===45?(e.consume(d),_):n(d)}function c(d){return d===null?n(d):d===45?(e.consume(d),b):We(d)?(s=c,Y(d)):(e.consume(d),c)}function b(d){return d===45?(e.consume(d),_):c(d)}function _(d){return d===62?D(d):d===45?b(d):c(d)}function o(d){const E="CDATA[";return d===E.charCodeAt(i++)?(e.consume(d),i===E.length?B:o):n(d)}function B(d){return d===null?n(d):d===93?(e.consume(d),T):We(d)?(s=B,Y(d)):(e.consume(d),B)}function T(d){return d===93?(e.consume(d),C):B(d)}function C(d){return d===62?D(d):d===93?(e.consume(d),C):B(d)}function p(d){return d===null||d===62?D(d):We(d)?(s=p,Y(d)):(e.consume(d),p)}function A(d){return d===null?n(d):d===63?(e.consume(d),F):We(d)?(s=A,Y(d)):(e.consume(d),A)}function F(d){return d===62?D(d):A(d)}function R(d){return Gt(d)?(e.consume(d),I):n(d)}function I(d){return d===45||Pt(d)?(e.consume(d),I):h(d)}function h(d){return We(d)?(s=h,Y(d)):at(d)?(e.consume(d),h):D(d)}function M(d){return d===45||Pt(d)?(e.consume(d),M):d===47||d===62||yt(d)?S(d):n(d)}function S(d){return d===47?(e.consume(d),D):d===58||d===95||Gt(d)?(e.consume(d),v):We(d)?(s=S,Y(d)):at(d)?(e.consume(d),S):D(d)}function v(d){return d===45||d===46||d===58||d===95||Pt(d)?(e.consume(d),v):y(d)}function y(d){return d===61?(e.consume(d),x):We(d)?(s=y,Y(d)):at(d)?(e.consume(d),y):S(d)}function x(d){return d===null||d===60||d===61||d===62||d===96?n(d):d===34||d===39?(e.consume(d),a=d,w):We(d)?(s=x,Y(d)):at(d)?(e.consume(d),x):(e.consume(d),k)}function w(d){return d===a?(e.consume(d),a=void 0,g):d===null?n(d):We(d)?(s=w,Y(d)):(e.consume(d),w)}function k(d){return d===null||d===34||d===39||d===60||d===61||d===96?n(d):d===47||d===62||yt(d)?S(d):(e.consume(d),k)}function g(d){return d===47||d===62||yt(d)?S(d):n(d)}function D(d){return d===62?(e.consume(d),e.exit("htmlTextData"),e.exit("htmlText"),t):n(d)}function Y(d){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),z}function z(d){return at(d)?lt(e,U,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d):U(d)}function U(d){return e.enter("htmlTextData"),s(d)}}const io={name:"labelEnd",tokenize:Vh,resolveTo:Ph,resolveAll:zh},Nh={tokenize:Uh},Dh={tokenize:qh},Hh={tokenize:Xh};function zh(e){let t=-1;for(;++t<e.length;){const n=e[t][1];(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(e.splice(t+1,n.type==="labelImage"?4:2),n.type="data",t++)}return e}function Ph(e,t){let n=e.length,r=0,a,i,s,l;for(;n--;)if(a=e[n][1],i){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[n][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(s){if(e[n][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(i=n,a.type!=="labelLink")){r=2;break}}else a.type==="labelEnd"&&(s=n);const f={type:e[i][1].type==="labelLink"?"link":"image",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)},u={type:"label",start:Object.assign({},e[i][1].start),end:Object.assign({},e[s][1].end)},m={type:"labelText",start:Object.assign({},e[i+r+2][1].end),end:Object.assign({},e[s-2][1].start)};return l=[["enter",f,t],["enter",u,t]],l=zt(l,e.slice(i+1,i+r+3)),l=zt(l,[["enter",m,t]]),l=zt(l,Sa(t.parser.constructs.insideSpan.null,e.slice(i+r+4,s-3),t)),l=zt(l,[["exit",m,t],e[s-2],e[s-1],["exit",u,t]]),l=zt(l,e.slice(s+1)),l=zt(l,[["exit",f,t]]),an(e,i,e.length,l),e}function Vh(e,t,n){const r=this;let a=r.events.length,i,s;for(;a--;)if((r.events[a][1].type==="labelImage"||r.events[a][1].type==="labelLink")&&!r.events[a][1]._balanced){i=r.events[a][1];break}return l;function l(b){return i?i._inactive?c(b):(s=r.parser.defined.includes(Cn(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(b),e.exit("labelMarker"),e.exit("labelEnd"),f):n(b)}function f(b){return b===40?e.attempt(Nh,m,s?m:c)(b):b===91?e.attempt(Dh,m,s?u:c)(b):s?m(b):c(b)}function u(b){return e.attempt(Hh,m,c)(b)}function m(b){return t(b)}function c(b){return i._balanced=!0,n(b)}}function Uh(e,t,n){return r;function r(c){return e.enter("resource"),e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),a}function a(c){return yt(c)?Ai(e,i)(c):i(c)}function i(c){return c===41?m(c):oc(e,s,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(c)}function s(c){return yt(c)?Ai(e,f)(c):m(c)}function l(c){return n(c)}function f(c){return c===34||c===39||c===40?cc(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(c):m(c)}function u(c){return yt(c)?Ai(e,m)(c):m(c)}function m(c){return c===41?(e.enter("resourceMarker"),e.consume(c),e.exit("resourceMarker"),e.exit("resource"),t):n(c)}}function qh(e,t,n){const r=this;return a;function a(l){return lc.call(r,e,i,s,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(Cn(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function s(l){return n(l)}}function Xh(e,t,n){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),a}function a(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}const Yh={name:"labelStartImage",tokenize:Kh,resolveAll:io.resolveAll};function Kh(e,t,n){const r=this;return a;function a(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),i}function i(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),s):n(l)}function s(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):t(l)}}const Gh={name:"labelStartLink",tokenize:Wh,resolveAll:io.resolveAll};function Wh(e,t,n){const r=this;return a;function a(s){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelLink"),i}function i(s){return s===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(s):t(s)}}const ao={name:"lineEnding",tokenize:Zh};function Zh(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),lt(e,t,"linePrefix")}}const Aa={name:"thematicBreak",tokenize:Qh};function Qh(e,t,n){let r=0,a;return i;function i(u){return e.enter("thematicBreak"),s(u)}function s(u){return a=u,l(u)}function l(u){return u===a?(e.enter("thematicBreakSequence"),f(u)):r>=3&&(u===null||We(u))?(e.exit("thematicBreak"),t(u)):n(u)}function f(u){return u===a?(e.consume(u),r++,f):(e.exit("thematicBreakSequence"),at(u)?lt(e,l,"whitespace")(u):l(u))}}const Zt={name:"list",tokenize:e2,continuation:{tokenize:t2},exit:r2},Jh={tokenize:i2,partial:!0},$h={tokenize:n2,partial:!0};function e2(e,t,n){const r=this,a=r.events[r.events.length-1];let i=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,s=0;return l;function l(_){const o=r.containerState.type||(_===42||_===43||_===45?"listUnordered":"listOrdered");if(o==="listUnordered"?!r.containerState.marker||_===r.containerState.marker:eo(_)){if(r.containerState.type||(r.containerState.type=o,e.enter(o,{_container:!0})),o==="listUnordered")return e.enter("listItemPrefix"),_===42||_===45?e.check(Aa,n,u)(_):u(_);if(!r.interrupt||_===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),f(_)}return n(_)}function f(_){return eo(_)&&++s<10?(e.consume(_),f):(!r.interrupt||s<2)&&(r.containerState.marker?_===r.containerState.marker:_===41||_===46)?(e.exit("listItemValue"),u(_)):n(_)}function u(_){return e.enter("listItemMarker"),e.consume(_),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||_,e.check(Si,r.interrupt?n:m,e.attempt(Jh,b,c))}function m(_){return r.containerState.initialBlankLine=!0,i++,b(_)}function c(_){return at(_)?(e.enter("listItemPrefixWhitespace"),e.consume(_),e.exit("listItemPrefixWhitespace"),b):n(_)}function b(_){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(_)}}function t2(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(Si,a,i);function a(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,lt(e,t,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!at(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,s(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt($h,t,s)(l))}function s(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,lt(e,e.attempt(Zt,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function n2(e,t,n){const r=this;return lt(e,a,"listItemIndent",r.containerState.size+1);function a(i){const s=r.events[r.events.length-1];return s&&s[1].type==="listItemIndent"&&s[2].sliceSerialize(s[1],!0).length===r.containerState.size?t(i):n(i)}}function r2(e){e.exit(this.containerState.type)}function i2(e,t,n){const r=this;return lt(e,a,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function a(i){const s=r.events[r.events.length-1];return!at(i)&&s&&s[1].type==="listItemPrefixWhitespace"?t(i):n(i)}}const dc={name:"setextUnderline",tokenize:s2,resolveTo:a2};function a2(e,t){let n=e.length,r,a,i;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(a=n)}else e[n][1].type==="content"&&e.splice(n,1),!i&&e[n][1].type==="definition"&&(i=n);const s={type:"setextHeading",start:Object.assign({},e[a][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[a][1].type="setextHeadingText",i?(e.splice(a,0,["enter",s,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end=Object.assign({},e[i][1].end)):e[r][1]=s,e.push(["exit",s,t]),e}function s2(e,t,n){const r=this;let a;return i;function i(u){let m=r.events.length,c;for(;m--;)if(r.events[m][1].type!=="lineEnding"&&r.events[m][1].type!=="linePrefix"&&r.events[m][1].type!=="content"){c=r.events[m][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||c)?(e.enter("setextHeadingLine"),a=u,s(u)):n(u)}function s(u){return e.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===a?(e.consume(u),l):(e.exit("setextHeadingLineSequence"),at(u)?lt(e,f,"lineSuffix")(u):f(u))}function f(u){return u===null||We(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const o2={tokenize:l2};function l2(e){const t=this,n=e.attempt(Si,r,e.attempt(this.parser.constructs.flowInitial,a,lt(e,e.attempt(this.parser.constructs.flow,a,e.attempt(mh,a)),"linePrefix")));return n;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function a(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const c2={resolveAll:mc()},u2=fc("string"),d2=fc("text");function fc(e){return{tokenize:t,resolveAll:mc(e==="text"?f2:void 0)};function t(n){const r=this,a=this.parser.constructs[e],i=n.attempt(a,s,l);return s;function s(m){return u(m)?i(m):l(m)}function l(m){if(m===null){n.consume(m);return}return n.enter("data"),n.consume(m),f}function f(m){return u(m)?(n.exit("data"),i(m)):(n.consume(m),f)}function u(m){if(m===null)return!0;const c=a[m];let b=-1;if(c)for(;++b<c.length;){const _=c[b];if(!_.previous||_.previous.call(r,r.previous))return!0}return!1}}}function mc(e){return t;function t(n,r){let a=-1,i;for(;++a<=n.length;)i===void 0?n[a]&&n[a][1].type==="data"&&(i=a,a++):(!n[a]||n[a][1].type!=="data")&&(a!==i+2&&(n[i][1].end=n[a-1][1].end,n.splice(i+2,a-i-2),a=i+2),i=void 0);return e?e(n,r):n}}function f2(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],a=t.sliceStream(r);let i=a.length,s=-1,l=0,f;for(;i--;){const u=a[i];if(typeof u=="string"){for(s=u.length;u.charCodeAt(s-1)===32;)l++,s--;if(s)break;s=-1}else if(u===-2)f=!0,l++;else if(u!==-1){i++;break}}if(l){const u={type:n===e.length||f||l<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-l,offset:r.end.offset-l,_index:r.start._index+i,_bufferIndex:i?s:r.start._bufferIndex+s},end:Object.assign({},r.end)};r.end=Object.assign({},u.start),r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}function m2(e,t,n){let r=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const a={},i=[];let s=[],l=[];const f={consume:p,enter:A,exit:F,attempt:h(R),check:h(I),interrupt:h(I,{interrupt:!0})},u={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:_,sliceSerialize:b,now:o,defineSkip:B,write:c};let m=t.tokenize.call(u,f);return t.resolveAll&&i.push(t),u;function c(y){return s=zt(s,y),T(),s[s.length-1]!==null?[]:(M(t,0),u.events=Sa(i,u.events,u),u.events)}function b(y,x){return v2(_(y),x)}function _(y){return h2(s,y)}function o(){const{line:y,column:x,offset:w,_index:k,_bufferIndex:g}=r;return{line:y,column:x,offset:w,_index:k,_bufferIndex:g}}function B(y){a[y.line]=y.column,v()}function T(){let y;for(;r._index<s.length;){const x=s[r._index];if(typeof x=="string")for(y=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===y&&r._bufferIndex<x.length;)C(x.charCodeAt(r._bufferIndex));else C(x)}}function C(y){m=m(y)}function p(y){We(y)?(r.line++,r.column=1,r.offset+=y===-3?2:1,v()):y!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=y}function A(y,x){const w=x||{};return w.type=y,w.start=o(),u.events.push(["enter",w,u]),l.push(w),w}function F(y){const x=l.pop();return x.end=o(),u.events.push(["exit",x,u]),x}function R(y,x){M(y,x.from)}function I(y,x){x.restore()}function h(y,x){return w;function w(k,g,D){let Y,z,U,d;return Array.isArray(k)?W(k):"tokenize"in k?W([k]):E(k);function E(_e){return pe;function pe(De){const Ce=De!==null&&_e[De],he=De!==null&&_e.null,Ue=[...Array.isArray(Ce)?Ce:Ce?[Ce]:[],...Array.isArray(he)?he:he?[he]:[]];return W(Ue)(De)}}function W(_e){return Y=_e,z=0,_e.length===0?D:O(_e[z])}function O(_e){return pe;function pe(De){return d=S(),U=_e,_e.partial||(u.currentConstruct=_e),_e.name&&u.parser.constructs.disable.null.includes(_e.name)?Se():_e.tokenize.call(x?Object.assign(Object.create(u),x):u,f,me,Se)(De)}}function me(_e){return y(U,d),g}function Se(_e){return d.restore(),++z<Y.length?O(Y[z]):D}}}function M(y,x){y.resolveAll&&!i.includes(y)&&i.push(y),y.resolve&&an(u.events,x,u.events.length-x,y.resolve(u.events.slice(x),u)),y.resolveTo&&(u.events=y.resolveTo(u.events,u))}function S(){const y=o(),x=u.previous,w=u.currentConstruct,k=u.events.length,g=Array.from(l);return{restore:D,from:k};function D(){r=y,u.previous=x,u.currentConstruct=w,u.events.length=k,l=g,v()}}function v(){r.line in a&&r.column<2&&(r.column=a[r.line],r.offset+=a[r.line]-1)}}function h2(e,t){const n=t.start._index,r=t.start._bufferIndex,a=t.end._index,i=t.end._bufferIndex;let s;if(n===a)s=[e[n].slice(r,i)];else{if(s=e.slice(n,a),r>-1){const l=s[0];typeof l=="string"?s[0]=l.slice(r):s.shift()}i>0&&s.push(e[a].slice(0,i))}return s}function v2(e,t){let n=-1;const r=[];let a;for(;++n<e.length;){const i=e[n];let s;if(typeof i=="string")s=i;else switch(i){case-5:{s="\r";break}case-4:{s=`
`;break}case-3:{s=`\r
`;break}case-2:{s=t?" ":"	";break}case-1:{if(!t&&a)continue;s=" ";break}default:s=String.fromCharCode(i)}a=i===-2,r.push(s)}return r.join("")}var p2=Object.freeze(Object.defineProperty({__proto__:null,document:{[42]:Zt,[43]:Zt,[45]:Zt,[48]:Zt,[49]:Zt,[50]:Zt,[51]:Zt,[52]:Zt,[53]:Zt,[54]:Zt,[55]:Zt,[56]:Zt,[57]:Zt,[62]:tc},contentInitial:{[91]:gh},flowInitial:{[-2]:ro,[-1]:ro,[32]:ro},flow:{[35]:Sh,[42]:Aa,[45]:[dc,Aa],[60]:Th,[61]:dc,[95]:Aa,[96]:ac,[126]:ac},string:{[38]:rc,[92]:nc},text:{[-5]:ao,[-4]:ao,[-3]:ao,[33]:Yh,[38]:rc,[42]:no,[60]:[Wm,Fh],[91]:Gh,[92]:[wh,nc],[93]:io,[95]:no,[96]:lh},insideSpan:{null:[no,c2]},attentionMarkers:{null:[42,95]},disable:{null:[]}},Symbol.toStringTag,{value:"Module"}));function _2(e){const n=G0([p2,...(e||{}).extensions||[]]),r={defined:[],lazy:{},constructs:n,content:a(Vm),document:a(qm),flow:a(o2),string:a(u2),text:a(d2)};return r;function a(i){return s;function s(l){return m2(r,i,l)}}}function g2(e){for(;!sc(e););return e}const hc=/[\0\t\n\r]/g;function b2(){let e=1,t="",n=!0,r;return a;function a(i,s,l){const f=[];let u,m,c,b,_;for(i=t+i.toString(s),c=0,t="",n&&(i.charCodeAt(0)===65279&&c++,n=void 0);c<i.length;){if(hc.lastIndex=c,u=hc.exec(i),b=u&&u.index!==void 0?u.index:i.length,_=i.charCodeAt(b),!u){t=i.slice(c);break}if(_===10&&c===b&&r)f.push(-3),r=void 0;else switch(r&&(f.push(-5),r=void 0),c<b&&(f.push(i.slice(c,b)),e+=b-c),_){case 0:{f.push(65533),e++;break}case 9:{for(m=Math.ceil(e/4)*4,f.push(-2);e++<m;)f.push(-1);break}case 10:{f.push(-4),e=1;break}default:r=!0,e=1}c=b+1}return l&&(r&&f.push(-5),t&&f.push(t),f.push(null)),f}}function x2(e,t,n){return typeof t!="string"&&(n=t,t=void 0),Pm(n)(g2(_2(n).document().write(b2()(e,t,!0))))}const y2={tokenize:E2,partial:!0},vc={tokenize:T2,partial:!0},pc={tokenize:R2,partial:!0},_c={tokenize:C2,partial:!0},w2={tokenize:I2,partial:!0},gc={tokenize:A2,previous:xc},bc={tokenize:M2,previous:yc},qn={tokenize:S2,previous:wc},In={},k2={text:In};let Sr=48;for(;Sr<123;)In[Sr]=qn,Sr++,Sr===58?Sr=65:Sr===91&&(Sr=97);In[43]=qn,In[45]=qn,In[46]=qn,In[95]=qn,In[72]=[qn,bc],In[104]=[qn,bc],In[87]=[qn,gc],In[119]=[qn,gc];function S2(e,t,n){const r=this;let a,i;return s;function s(c){return!so(c)||!wc.call(r,r.previous)||oo(r.events)?n(c):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(c))}function l(c){return so(c)?(e.consume(c),l):c===64?(e.consume(c),f):n(c)}function f(c){return c===46?e.check(w2,m,u)(c):c===45||c===95||Pt(c)?(i=!0,e.consume(c),f):m(c)}function u(c){return e.consume(c),a=!0,f}function m(c){return i&&a&&Gt(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(c)):n(c)}}function A2(e,t,n){const r=this;return a;function a(s){return s!==87&&s!==119||!xc.call(r,r.previous)||oo(r.events)?n(s):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(y2,e.attempt(vc,e.attempt(pc,i),n),n)(s))}function i(s){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(s)}}function M2(e,t,n){const r=this;let a="",i=!1;return s;function s(c){return(c===72||c===104)&&yc.call(r,r.previous)&&!oo(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),a+=String.fromCodePoint(c),e.consume(c),l):n(c)}function l(c){if(Gt(c)&&a.length<5)return a+=String.fromCodePoint(c),e.consume(c),l;if(c===58){const b=a.toLowerCase();if(b==="http"||b==="https")return e.consume(c),f}return n(c)}function f(c){return c===47?(e.consume(c),i?u:(i=!0,f)):n(c)}function u(c){return c===null||wa(c)||yt(c)||Yr(c)||to(c)?n(c):e.attempt(vc,e.attempt(pc,m),n)(c)}function m(c){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(c)}}function E2(e,t,n){let r=0;return a;function a(s){return(s===87||s===119)&&r<3?(r++,e.consume(s),a):s===46&&r===3?(e.consume(s),i):n(s)}function i(s){return s===null?n(s):t(s)}}function T2(e,t,n){let r,a,i;return s;function s(u){return u===46||u===95?e.check(_c,f,l)(u):u===null||yt(u)||Yr(u)||u!==45&&to(u)?f(u):(i=!0,e.consume(u),s)}function l(u){return u===95?r=!0:(a=r,r=void 0),e.consume(u),s}function f(u){return a||r||!i?n(u):t(u)}}function R2(e,t){let n=0,r=0;return a;function a(s){return s===40?(n++,e.consume(s),a):s===41&&r<n?i(s):s===33||s===34||s===38||s===39||s===41||s===42||s===44||s===46||s===58||s===59||s===60||s===63||s===93||s===95||s===126?e.check(_c,t,i)(s):s===null||yt(s)||Yr(s)?t(s):(e.consume(s),a)}function i(s){return s===41&&r++,e.consume(s),a}}function C2(e,t,n){return r;function r(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),r):l===38?(e.consume(l),i):l===93?(e.consume(l),a):l===60||l===null||yt(l)||Yr(l)?t(l):n(l)}function a(l){return l===null||l===40||l===91||yt(l)||Yr(l)?t(l):r(l)}function i(l){return Gt(l)?s(l):n(l)}function s(l){return l===59?(e.consume(l),r):Gt(l)?(e.consume(l),s):n(l)}}function I2(e,t,n){return r;function r(i){return e.consume(i),a}function a(i){return Pt(i)?n(i):t(i)}}function xc(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||yt(e)}function yc(e){return!Gt(e)}function wc(e){return!(e===47||so(e))}function so(e){return e===43||e===45||e===46||e===95||Pt(e)}function oo(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const B2={exit:{literalAutolinkEmail:L2,literalAutolinkHttp:F2,literalAutolinkWww:O2}};function O2(e){lo.call(this,e,"http://")}function L2(e){lo.call(this,e,"mailto:")}function F2(e){lo.call(this,e)}function lo(e,t){const n=this.sliceSerialize(e);this.tag('<a href="'+kr((t||"")+n)+'">'),this.raw(this.encode(n)),this.tag("</a>")}const j2={tokenize:q2,partial:!0};function N2(){return{document:{[91]:{tokenize:P2,continuation:{tokenize:V2},exit:U2}},text:{[91]:{tokenize:z2},[93]:{add:"after",tokenize:D2,resolveTo:H2}}}}function D2(e,t,n){const r=this;let a=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let s;for(;a--;){const f=r.events[a][1];if(f.type==="labelImage"){s=f;break}if(f.type==="gfmFootnoteCall"||f.type==="labelLink"||f.type==="label"||f.type==="image"||f.type==="link")break}return l;function l(f){if(!s||!s._balanced)return n(f);const u=Cn(r.sliceSerialize({start:s.end,end:r.now()}));return u.codePointAt(0)!==94||!i.includes(u.slice(1))?n(f):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(f),e.exit("gfmFootnoteCallLabelMarker"),t(f))}}function H2(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},e[e.length-1][1].start)},s={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},l=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",a,t],["exit",a,t],["enter",i,t],["enter",s,t],["exit",s,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...l),e}function z2(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i=0,s;return l;function l(c){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),f}function f(c){return c!==94?n(c):(e.enter("gfmFootnoteCallMarker"),e.consume(c),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(c){if(i>999||c===93&&!s||c===null||c===91||yt(c))return n(c);if(c===93){e.exit("chunkString");const b=e.exit("gfmFootnoteCallString");return a.includes(Cn(r.sliceSerialize(b)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(c)}return yt(c)||(s=!0),i++,e.consume(c),c===92?m:u}function m(c){return c===91||c===92||c===93?(e.consume(c),i++,u):u(c)}}function P2(e,t,n){const r=this,a=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,s=0,l;return f;function f(o){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(o),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(o){return o===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(o),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",m):n(o)}function m(o){if(s>999||o===93&&!l||o===null||o===91||yt(o))return n(o);if(o===93){e.exit("chunkString");const B=e.exit("gfmFootnoteDefinitionLabelString");return i=Cn(r.sliceSerialize(B)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(o),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),b}return yt(o)||(l=!0),s++,e.consume(o),o===92?c:m}function c(o){return o===91||o===92||o===93?(e.consume(o),s++,m):m(o)}function b(o){return o===58?(e.enter("definitionMarker"),e.consume(o),e.exit("definitionMarker"),a.includes(i)||a.push(i),lt(e,_,"gfmFootnoteDefinitionWhitespace")):n(o)}function _(o){return t(o)}}function V2(e,t,n){return e.check(Si,t,e.attempt(j2,t,n))}function U2(e){e.exit("gfmFootnoteDefinition")}function q2(e,t,n){const r=this;return lt(e,a,"gfmFootnoteDefinitionIndent",4+1);function a(i){const s=r.events[r.events.length-1];return s&&s[1].type==="gfmFootnoteDefinitionIndent"&&s[2].sliceSerialize(s[1],!0).length===4?t(i):n(i)}}const X2={}.hasOwnProperty,Y2={};function K2(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function G2(e){const t=e||Y2,n=t.label||"Footnotes",r=t.labelTagName||"h2",a=t.labelAttributes===null||t.labelAttributes===void 0?'class="sr-only"':t.labelAttributes,i=t.backLabel||K2,s=t.clobberPrefix===null||t.clobberPrefix===void 0?"user-content-":t.clobberPrefix;return{enter:{gfmFootnoteDefinition(){this.getData("tightStack").push(!1)},gfmFootnoteDefinitionLabelString(){this.buffer()},gfmFootnoteCallString(){this.buffer()}},exit:{gfmFootnoteDefinition(){let l=this.getData("gfmFootnoteDefinitions");const f=this.getData("gfmFootnoteDefinitionStack"),u=this.getData("tightStack"),m=f.pop(),c=this.resume();l||this.setData("gfmFootnoteDefinitions",l={}),X2.call(l,m)||(l[m]=c),u.pop(),this.setData("slurpOneLineEnding",!0),this.setData("lastWasTag")},gfmFootnoteDefinitionLabelString(l){let f=this.getData("gfmFootnoteDefinitionStack");f||this.setData("gfmFootnoteDefinitionStack",f=[]),f.push(Cn(this.sliceSerialize(l))),this.resume(),this.buffer()},gfmFootnoteCallString(l){let f=this.getData("gfmFootnoteCallOrder"),u=this.getData("gfmFootnoteCallCounts");const m=Cn(this.sliceSerialize(l));let c;this.resume(),f||this.setData("gfmFootnoteCallOrder",f=[]),u||this.setData("gfmFootnoteCallCounts",u={});const b=f.indexOf(m),_=kr(m.toLowerCase());b===-1?(f.push(m),u[m]=1,c=f.length):(u[m]++,c=b+1);const o=u[m];this.tag('<sup><a href="#'+s+"fn-"+_+'" id="'+s+"fnref-"+_+(o>1?"-"+o:"")+'" data-footnote-ref="" aria-describedby="footnote-label">'+String(c)+"</a></sup>")},null(){const l=this.getData("gfmFootnoteCallOrder")||[],f=this.getData("gfmFootnoteCallCounts")||{},u=this.getData("gfmFootnoteDefinitions")||{};let m=-1;for(l.length>0&&(this.lineEndingIfNeeded(),this.tag('<section data-footnotes="" class="footnotes"><'+r+' id="footnote-label"'+(a?" "+a:"")+">"),this.raw(this.encode(n)),this.tag("</"+r+">"),this.lineEndingIfNeeded(),this.tag("<ol>"));++m<l.length;){const c=l[m],b=kr(c.toLowerCase());let _=0;const o=[];for(;++_<=f[c];)o.push('<a href="#'+s+"fnref-"+b+(_>1?"-"+_:"")+'" data-footnote-backref="" aria-label="'+this.encode(typeof i=="string"?i:i(m,_))+'" class="data-footnote-backref">\u21A9'+(_>1?"<sup>"+_+"</sup>":"")+"</a>");const B=o.join(" ");let T=!1;this.lineEndingIfNeeded(),this.tag('<li id="'+s+"fn-"+b+'">'),this.lineEndingIfNeeded(),this.tag(u[c].replace(/<\/p>(?:\r?\n|\r)?$/,C=>(T=!0," "+B+C))),T||(this.lineEndingIfNeeded(),this.tag(B)),this.lineEndingIfNeeded(),this.tag("</li>")}l.length>0&&(this.lineEndingIfNeeded(),this.tag("</ol>"),this.lineEndingIfNeeded(),this.tag("</section>"))}}}}const W2={enter:{strikethrough(){this.tag("<del>")}},exit:{strikethrough(){this.tag("</del>")}}};function Z2(e){let n=(e||{}).singleTilde;const r={tokenize:i,resolveAll:a};return n==null&&(n=!0),{text:{[126]:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function a(s,l){let f=-1;for(;++f<s.length;)if(s[f][0]==="enter"&&s[f][1].type==="strikethroughSequenceTemporary"&&s[f][1]._close){let u=f;for(;u--;)if(s[u][0]==="exit"&&s[u][1].type==="strikethroughSequenceTemporary"&&s[u][1]._open&&s[f][1].end.offset-s[f][1].start.offset===s[u][1].end.offset-s[u][1].start.offset){s[f][1].type="strikethroughSequence",s[u][1].type="strikethroughSequence";const m={type:"strikethrough",start:Object.assign({},s[u][1].start),end:Object.assign({},s[f][1].end)},c={type:"strikethroughText",start:Object.assign({},s[u][1].end),end:Object.assign({},s[f][1].start)},b=[["enter",m,l],["enter",s[u][1],l],["exit",s[u][1],l],["enter",c,l]],_=l.parser.constructs.insideSpan.null;_&&an(b,b.length,0,Sa(_,s.slice(u+1,f),l)),an(b,b.length,0,[["exit",c,l],["enter",s[f][1],l],["exit",s[f][1],l],["exit",m,l]]),an(s,u-1,f-u+3,b),f=u+b.length-2;break}}for(f=-1;++f<s.length;)s[f][1].type==="strikethroughSequenceTemporary"&&(s[f][1].type="data");return s}function i(s,l,f){const u=this.previous,m=this.events;let c=0;return b;function b(o){return u===126&&m[m.length-1][1].type!=="characterEscape"?f(o):(s.enter("strikethroughSequenceTemporary"),_(o))}function _(o){const B=ka(u);if(o===126)return c>1?f(o):(s.consume(o),c++,_);if(c<2&&!n)return f(o);const T=s.exit("strikethroughSequenceTemporary"),C=ka(o);return T._open=!C||C===2&&Boolean(B),T._close=!B||B===2&&Boolean(C),l(o)}}}const co={none:"",left:' align="left"',right:' align="right"',center:' align="center"'},Q2={enter:{table(e){const t=e._align;this.lineEndingIfNeeded(),this.tag("<table>"),this.setData("tableAlign",t)},tableBody(){this.tag("<tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=co[e[t]];n===void 0?this.buffer():(this.lineEndingIfNeeded(),this.tag("<td"+n+">"))},tableHead(){this.lineEndingIfNeeded(),this.tag("<thead>")},tableHeader(){const e=this.getData("tableAlign"),t=this.getData("tableColumn"),n=co[e[t]];this.lineEndingIfNeeded(),this.tag("<th"+n+">")},tableRow(){this.setData("tableColumn",0),this.lineEndingIfNeeded(),this.tag("<tr>")}},exit:{codeTextData(e){let t=this.sliceSerialize(e);this.getData("tableAlign")&&(t=t.replace(/\\([\\|])/g,J2)),this.raw(this.encode(t))},table(){this.setData("tableAlign"),this.setData("slurpAllLineEndings"),this.lineEndingIfNeeded(),this.tag("</table>")},tableBody(){this.lineEndingIfNeeded(),this.tag("</tbody>")},tableData(){const e=this.getData("tableAlign"),t=this.getData("tableColumn");t in e?(this.tag("</td>"),this.setData("tableColumn",t+1)):this.resume()},tableHead(){this.lineEndingIfNeeded(),this.tag("</thead>")},tableHeader(){const e=this.getData("tableColumn");this.tag("</th>"),this.setData("tableColumn",e+1)},tableRow(){const e=this.getData("tableAlign");let t=this.getData("tableColumn");for(;t<e.length;)this.lineEndingIfNeeded(),this.tag("<td"+co[e[t]]+"></td>"),t++;this.setData("tableColumn",t),this.lineEndingIfNeeded(),this.tag("</tr>")}}};function J2(e,t){return t==="|"?t:e}class $2{constructor(){this.map=[]}add(t,n,r){ev(this,t,n,r)}consume(t){if(this.map.sort((i,s)=>i[0]-s[0]),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1])),r.push(this.map[n][2]),t.length=this.map[n][0];r.push([...t]),t.length=0;let a=r.pop();for(;a;)t.push(...a),a=r.pop();this.map.length=0}}function ev(e,t,n,r){let a=0;if(!(n===0&&r.length===0)){for(;a<e.map.length;){if(e.map[a][0]===t){e.map[a][1]+=n,e.map[a][2].push(...r);return}a+=1}e.map.push([t,n,r])}}function tv(e,t){let n=!1;const r=[];for(;t<e.length;){const a=e[t];if(n){if(a[0]==="enter")a[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=r.length-1;r[i]=r[i]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}const nv={flow:{null:{tokenize:rv,resolveAll:iv}}};function rv(e,t,n){const r=this;let a=0,i=0,s;return l;function l(v){let y=r.events.length-1;for(;y>-1;){const k=r.events[y][1].type;if(k==="lineEnding"||k==="linePrefix")y--;else break}const x=y>-1?r.events[y][1].type:null,w=x==="tableHead"||x==="tableRow"?I:f;return w===I&&r.parser.lazy[r.now().line]?n(v):w(v)}function f(v){return e.enter("tableHead"),e.enter("tableRow"),u(v)}function u(v){return v===124||(s=!0,i+=1),m(v)}function m(v){return v===null?n(v):We(v)?i>1?(i=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(v),e.exit("lineEnding"),_):n(v):at(v)?lt(e,m,"whitespace")(v):(i+=1,s&&(s=!1,a+=1),v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),s=!0,m):(e.enter("data"),c(v)))}function c(v){return v===null||v===124||yt(v)?(e.exit("data"),m(v)):(e.consume(v),v===92?b:c)}function b(v){return v===92||v===124?(e.consume(v),c):c(v)}function _(v){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(v):(e.enter("tableDelimiterRow"),s=!1,at(v)?lt(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(v):o(v))}function o(v){return v===45||v===58?T(v):v===124?(s=!0,e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),B):R(v)}function B(v){return at(v)?lt(e,T,"whitespace")(v):T(v)}function T(v){return v===58?(i+=1,s=!0,e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),C):v===45?(i+=1,C(v)):v===null||We(v)?F(v):R(v)}function C(v){return v===45?(e.enter("tableDelimiterFiller"),p(v)):R(v)}function p(v){return v===45?(e.consume(v),p):v===58?(s=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(v),e.exit("tableDelimiterMarker"),A):(e.exit("tableDelimiterFiller"),A(v))}function A(v){return at(v)?lt(e,F,"whitespace")(v):F(v)}function F(v){return v===124?o(v):v===null||We(v)?!s||a!==i?R(v):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(v)):R(v)}function R(v){return n(v)}function I(v){return e.enter("tableRow"),h(v)}function h(v){return v===124?(e.enter("tableCellDivider"),e.consume(v),e.exit("tableCellDivider"),h):v===null||We(v)?(e.exit("tableRow"),t(v)):at(v)?lt(e,h,"whitespace")(v):(e.enter("data"),M(v))}function M(v){return v===null||v===124||yt(v)?(e.exit("data"),h(v)):(e.consume(v),v===92?S:M)}function S(v){return v===92||v===124?(e.consume(v),M):M(v)}}function iv(e,t){let n=-1,r=!0,a=0,i=[0,0,0,0],s=[0,0,0,0],l=!1,f=0,u,m,c;const b=new $2;for(;++n<e.length;){const _=e[n],o=_[1];_[0]==="enter"?o.type==="tableHead"?(l=!1,f!==0&&(kc(b,t,f,u,m),m=void 0,f=0),u={type:"table",start:Object.assign({},o.start),end:Object.assign({},o.end)},b.add(n,0,[["enter",u,t]])):o.type==="tableRow"||o.type==="tableDelimiterRow"?(r=!0,c=void 0,i=[0,0,0,0],s=[0,n+1,0,0],l&&(l=!1,m={type:"tableBody",start:Object.assign({},o.start),end:Object.assign({},o.end)},b.add(n,0,[["enter",m,t]])),a=o.type==="tableDelimiterRow"?2:m?3:1):a&&(o.type==="data"||o.type==="tableDelimiterMarker"||o.type==="tableDelimiterFiller")?(r=!1,s[2]===0&&(i[1]!==0&&(s[0]=s[1],c=Ma(b,t,i,a,void 0,c),i=[0,0,0,0]),s[2]=n)):o.type==="tableCellDivider"&&(r?r=!1:(i[1]!==0&&(s[0]=s[1],c=Ma(b,t,i,a,void 0,c)),i=s,s=[i[1],n,0,0])):o.type==="tableHead"?(l=!0,f=n):o.type==="tableRow"||o.type==="tableDelimiterRow"?(f=n,i[1]!==0?(s[0]=s[1],c=Ma(b,t,i,a,n,c)):s[1]!==0&&(c=Ma(b,t,s,a,n,c)),a=0):a&&(o.type==="data"||o.type==="tableDelimiterMarker"||o.type==="tableDelimiterFiller")&&(s[3]=n)}for(f!==0&&kc(b,t,f,u,m),b.consume(t.events),n=-1;++n<t.events.length;){const _=t.events[n];_[0]==="enter"&&_[1].type==="table"&&(_[1]._align=tv(t.events,n))}return e}function Ma(e,t,n,r,a,i){const s=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(i.end=Object.assign({},Kr(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));const f=Kr(t.events,n[1]);if(i={type:s,start:Object.assign({},f),end:Object.assign({},f)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){const u=Kr(t.events,n[2]),m=Kr(t.events,n[3]),c={type:l,start:Object.assign({},u),end:Object.assign({},m)};if(e.add(n[2],0,[["enter",c,t]]),r!==2){const b=t.events[n[2]],_=t.events[n[3]];if(b[1].end=Object.assign({},_[1].end),b[1].type="chunkText",b[1].contentType="text",n[3]>n[2]+1){const o=n[2]+1,B=n[3]-n[2]-1;e.add(o,B,[])}}e.add(n[3]+1,0,[["exit",c,t]])}return a!==void 0&&(i.end=Object.assign({},Kr(t.events,a)),e.add(a,0,[["exit",i,t]]),i=void 0),i}function kc(e,t,n,r,a){const i=[],s=Kr(t.events,n);a&&(a.end=Object.assign({},s),i.push(["exit",a,t])),r.end=Object.assign({},s),i.push(["exit",r,t]),e.add(n+1,0,i)}function Kr(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const Sc=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|title|textarea|xmp)(?=[\t\n\f\r />])/gi,av=new RegExp("^"+Sc.source,"i"),sv={exit:{htmlFlowData(e){Ac.call(this,e,Sc)},htmlTextData(e){Ac.call(this,e,av)}}};function Ac(e,t){let n=this.sliceSerialize(e);this.options.allowDangerousHtml&&(n=n.replace(t,"&lt;$1$2")),this.raw(this.encode(n))}const ov={enter:{taskListCheck(){this.tag('<input type="checkbox" disabled="" ')}},exit:{taskListCheck(){this.tag("/>")},taskListCheckValueChecked(){this.tag('checked="" ')}}},lv={tokenize:uv},cv={text:{[91]:lv}};function uv(e,t,n){const r=this;return a;function a(f){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(f):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),i)}function i(f){return yt(f)?(e.enter("taskListCheckValueUnchecked"),e.consume(f),e.exit("taskListCheckValueUnchecked"),s):f===88||f===120?(e.enter("taskListCheckValueChecked"),e.consume(f),e.exit("taskListCheckValueChecked"),s):n(f)}function s(f){return f===93?(e.enter("taskListCheckMarker"),e.consume(f),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(f)}function l(f){return We(f)?t(f):at(f)?e.check({tokenize:dv},t,n)(f):n(f)}}function dv(e,t,n){return lt(e,r,"whitespace");function r(a){return a===null?n(a):t(a)}}function fv(e){return G0([k2,N2(),Z2(e),nv,cv])}function mv(e){return W0([B2,G2(e),W2,Q2,sv,ov])}const jt={carriageReturn:-5,lineFeed:-4,carriageReturnLineFeed:-3,horizontalTab:-2,virtualSpace:-1,eof:null,nul:0,soh:1,stx:2,etx:3,eot:4,enq:5,ack:6,bel:7,bs:8,ht:9,lf:10,vt:11,ff:12,cr:13,so:14,si:15,dle:16,dc1:17,dc2:18,dc3:19,dc4:20,nak:21,syn:22,etb:23,can:24,em:25,sub:26,esc:27,fs:28,gs:29,rs:30,us:31,space:32,exclamationMark:33,quotationMark:34,numberSign:35,dollarSign:36,percentSign:37,ampersand:38,apostrophe:39,leftParenthesis:40,rightParenthesis:41,asterisk:42,plusSign:43,comma:44,dash:45,dot:46,slash:47,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,colon:58,semicolon:59,lessThan:60,equalsTo:61,greaterThan:62,questionMark:63,atSign:64,uppercaseA:65,uppercaseB:66,uppercaseC:67,uppercaseD:68,uppercaseE:69,uppercaseF:70,uppercaseG:71,uppercaseH:72,uppercaseI:73,uppercaseJ:74,uppercaseK:75,uppercaseL:76,uppercaseM:77,uppercaseN:78,uppercaseO:79,uppercaseP:80,uppercaseQ:81,uppercaseR:82,uppercaseS:83,uppercaseT:84,uppercaseU:85,uppercaseV:86,uppercaseW:87,uppercaseX:88,uppercaseY:89,uppercaseZ:90,leftSquareBracket:91,backslash:92,rightSquareBracket:93,caret:94,underscore:95,graveAccent:96,lowercaseA:97,lowercaseB:98,lowercaseC:99,lowercaseD:100,lowercaseE:101,lowercaseF:102,lowercaseG:103,lowercaseH:104,lowercaseI:105,lowercaseJ:106,lowercaseK:107,lowercaseL:108,lowercaseM:109,lowercaseN:110,lowercaseO:111,lowercaseP:112,lowercaseQ:113,lowercaseR:114,lowercaseS:115,lowercaseT:116,lowercaseU:117,lowercaseV:118,lowercaseW:119,lowercaseX:120,lowercaseY:121,lowercaseZ:122,leftCurlyBrace:123,verticalBar:124,rightCurlyBrace:125,tilde:126,del:127,degree:176,byteOrderMarker:65279,replacementCharacter:65533},hv={text:{176:{name:"underline",tokenize:(e,t,n)=>{const r=s=>s===jt.carriageReturn||s===jt.lineFeed||s===jt.carriageReturnLineFeed||s===jt.eof?n(s):s===jt.backslash?(e.consume(s),a):s===jt.degree?(e.exit("underlineContent"),e.enter("underlineMarker"),e.consume(s),e.exit("underlineMarker"),e.exit("underline"),t):(e.consume(s),r),a=s=>s===jt.backslash||s===jt.degree?(e.consume(s),r):r(s),i=s=>s===jt.degree?n(s):r(s);return s=>(e.enter("underline"),e.enter("underlineMarker"),e.consume(s),e.exit("underlineMarker"),e.enter("underlineContent",{contentType:"string"}),i)}}}},vv={enter:{underline(){this.tag("<u>")}},exit:{underline(){this.tag("</u>")}}},pv={text:{60:{name:"usertag",tokenize:(e,t,n)=>{const r=s=>s===jt.carriageReturn||s===jt.lineFeed||s===jt.carriageReturnLineFeed||s===jt.eof?n(s):s===jt.backslash?(e.consume(s),a):s===jt.greaterThan?(e.exit("usertagContent"),e.enter("usertagMarker"),e.consume(s),e.exit("usertagMarker"),e.exit("usertag"),t):(e.consume(s),r),a=s=>s===jt.backslash||s===jt.greaterThan?(e.consume(s),r):r(s),i=s=>s===jt.atSign?(e.consume(s),e.exit("usertagMarker"),e.enter("usertagContent"),r):n(s);return s=>(e.enter("usertag"),e.enter("usertagMarker"),e.consume(s),i)}}}},_v=e=>({exit:{usertagContent(t){const n=this.sliceSerialize(t);this.tag(`<span class="vac-text-tag" data-user-id="${n}">`);const r=e.find(a=>a._id===n);this.raw(`@${this.encode(r?r.username:n)}`),this.tag("</span>")}}}),Mc=Tc(/[A-Za-z]/),Ec=Tc(/[\dA-Za-z]/);function Xn(e){return e!==null&&e<-2}function Ar(e){return e!==null&&(e<0||e===32)}function Gr(e){return e===-2||e===-1||e===32}function Tc(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Yn(e,t,n,r){const a=r?r-1:Number.POSITIVE_INFINITY;let i=0;return s;function s(f){return Gr(f)?(e.enter(n),l(f)):t(f)}function l(f){return Gr(f)&&i++<a?(e.consume(f),l):(e.exit(n),t(f))}}function Ea(e,t){let n;return r;function r(a){return Xn(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,r):Gr(a)?Yn(e,r,n?"linePrefix":"lineSuffix")(a):t(a)}}function uo(e,t,n,r,a,i,s,l,f,u,m,c,b,_,o){let B,T;return C;function C(g){return e.enter(r),e.enter(a),e.consume(g),e.exit(a),p}function p(g){return g===35?(B=s,A(g)):g===46?(B=l,A(g)):g===58||g===95||Mc(g)?(e.enter(i),e.enter(f),e.consume(g),I):o&&Gr(g)?Yn(e,p,"whitespace")(g):!o&&Ar(g)?Ea(e,p)(g):k(g)}function A(g){const D=B+"Marker";return e.enter(i),e.enter(B),e.enter(D),e.consume(g),e.exit(D),F}function F(g){if(g===null||g===34||g===35||g===39||g===46||g===60||g===61||g===62||g===96||g===125||Ar(g))return n(g);const D=B+"Value";return e.enter(D),e.consume(g),R}function R(g){if(g===null||g===34||g===39||g===60||g===61||g===62||g===96)return n(g);if(g===35||g===46||g===125||Ar(g)){const D=B+"Value";return e.exit(D),e.exit(B),e.exit(i),p(g)}return e.consume(g),R}function I(g){return g===45||g===46||g===58||g===95||Ec(g)?(e.consume(g),I):(e.exit(f),o&&Gr(g)?Yn(e,h,"whitespace")(g):!o&&Ar(g)?Ea(e,h)(g):h(g))}function h(g){return g===61?(e.enter(u),e.consume(g),e.exit(u),M):(e.exit(i),p(g))}function M(g){return g===null||g===60||g===61||g===62||g===96||g===125||o&&Xn(g)?n(g):g===34||g===39?(e.enter(m),e.enter(b),e.consume(g),e.exit(b),T=g,v):o&&Gr(g)?Yn(e,M,"whitespace")(g):!o&&Ar(g)?Ea(e,M)(g):(e.enter(c),e.enter(_),e.consume(g),T=void 0,S)}function S(g){return g===null||g===34||g===39||g===60||g===61||g===62||g===96?n(g):g===125||Ar(g)?(e.exit(_),e.exit(c),e.exit(i),p(g)):(e.consume(g),S)}function v(g){return g===T?(e.enter(b),e.consume(g),e.exit(b),e.exit(m),e.exit(i),w):(e.enter(c),y(g))}function y(g){return g===T?(e.exit(c),v(g)):g===null?n(g):Xn(g)?o?n(g):Ea(e,y)(g):(e.enter(_),e.consume(g),x)}function x(g){return g===T||g===null||Xn(g)?(e.exit(_),y(g)):(e.consume(g),x)}function w(g){return g===125||Ar(g)?p(g):k(g)}function k(g){return g===125?(e.enter(a),e.consume(g),e.exit(a),e.exit(r),t):n(g)}}function fo(e,t,n,r,a,i,s){let l=0,f=0,u;return m;function m(T){return e.enter(r),e.enter(a),e.consume(T),e.exit(a),c}function c(T){return T===93?(e.enter(a),e.consume(T),e.exit(a),e.exit(r),t):(e.enter(i),b(T))}function b(T){if(T===93&&!f)return B(T);const C=e.enter("chunkText",{contentType:"text",previous:u});return u&&(u.next=C),u=C,_(T)}function _(T){return T===null||l>999||T===91&&++f>32?n(T):T===93&&!f--?(e.exit("chunkText"),B(T)):Xn(T)?s?n(T):(e.consume(T),e.exit("chunkText"),b):(e.consume(T),T===92?o:_)}function o(T){return T===91||T===92||T===93?(e.consume(T),l++,_):_(T)}function B(T){return e.exit(i),e.enter(a),e.consume(T),e.exit(a),e.exit(r),t}}function mo(e,t,n,r){const a=this;return i;function i(l){return Mc(l)?(e.enter(r),e.consume(l),s):n(l)}function s(l){return l===45||l===95||Ec(l)?(e.consume(l),s):(e.exit(r),a.previous===45||a.previous===95?n(l):t(l))}}const gv={tokenize:yv,concrete:!0},bv={tokenize:wv,partial:!0},xv={tokenize:kv,partial:!0},Rc={tokenize:Sv,partial:!0};function yv(e,t,n){const r=this,a=r.events[r.events.length-1],i=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0;let s=0,l;return f;function f(h){return e.enter("directiveContainer"),e.enter("directiveContainerFence"),e.enter("directiveContainerSequence"),u(h)}function u(h){return h===58?(e.consume(h),s++,u):s<3?n(h):(e.exit("directiveContainerSequence"),mo.call(r,e,m,n,"directiveContainerName")(h))}function m(h){return h===91?e.attempt(bv,c,c)(h):c(h)}function c(h){return h===123?e.attempt(xv,b,b)(h):b(h)}function b(h){return Yn(e,_,"whitespace")(h)}function _(h){return e.exit("directiveContainerFence"),h===null?o(h):Xn(h)?r.interrupt?t(h):e.attempt(Rc,B,o)(h):n(h)}function o(h){return e.exit("directiveContainer"),t(h)}function B(h){return h===null?(e.exit("directiveContainer"),t(h)):(e.enter("directiveContainerContent"),T(h))}function T(h){return h===null?R(h):e.attempt({tokenize:I,partial:!0},R,i?Yn(e,C,"linePrefix",i+1):C)(h)}function C(h){if(h===null)return R(h);const M=e.enter("chunkDocument",{contentType:"document",previous:l});return l&&(l.next=M),l=M,p(h)}function p(h){if(h===null){const M=e.exit("chunkDocument");return r.parser.lazy[M.start.line]=!1,R(h)}return Xn(h)?e.check(Rc,A,F)(h):(e.consume(h),p)}function A(h){e.consume(h);const M=e.exit("chunkDocument");return r.parser.lazy[M.start.line]=!1,T}function F(h){const M=e.exit("chunkDocument");return r.parser.lazy[M.start.line]=!1,R(h)}function R(h){return e.exit("directiveContainerContent"),e.exit("directiveContainer"),t(h)}function I(h,M,S){let v=0;return Yn(h,y,"linePrefix",4);function y(k){return h.enter("directiveContainerFence"),h.enter("directiveContainerSequence"),x(k)}function x(k){return k===58?(h.consume(k),v++,x):v<s?S(k):(h.exit("directiveContainerSequence"),Yn(h,w,"whitespace")(k))}function w(k){return k===null||Xn(k)?(h.exit("directiveContainerFence"),M(k)):S(k)}}}function wv(e,t,n){return fo(e,t,n,"directiveContainerLabel","directiveContainerLabelMarker","directiveContainerLabelString",!0)}function kv(e,t,n){return uo(e,t,n,"directiveContainerAttributes","directiveContainerAttributesMarker","directiveContainerAttribute","directiveContainerAttributeId","directiveContainerAttributeClass","directiveContainerAttributeName","directiveContainerAttributeInitializerMarker","directiveContainerAttributeValueLiteral","directiveContainerAttributeValue","directiveContainerAttributeValueMarker","directiveContainerAttributeValueData",!0)}function Sv(e,t,n){const r=this;return a;function a(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),i}function i(s){return r.parser.lazy[r.now().line]?n(s):t(s)}}const Av={tokenize:Tv},Mv={tokenize:Rv,partial:!0},Ev={tokenize:Cv,partial:!0};function Tv(e,t,n){const r=this;return a;function a(m){return e.enter("directiveLeaf"),e.enter("directiveLeafSequence"),e.consume(m),i}function i(m){return m===58?(e.consume(m),e.exit("directiveLeafSequence"),mo.call(r,e,s,n,"directiveLeafName")):n(m)}function s(m){return m===91?e.attempt(Mv,l,l)(m):l(m)}function l(m){return m===123?e.attempt(Ev,f,f)(m):f(m)}function f(m){return Yn(e,u,"whitespace")(m)}function u(m){return m===null||Xn(m)?(e.exit("directiveLeaf"),t(m)):n(m)}}function Rv(e,t,n){return fo(e,t,n,"directiveLeafLabel","directiveLeafLabelMarker","directiveLeafLabelString",!0)}function Cv(e,t,n){return uo(e,t,n,"directiveLeafAttributes","directiveLeafAttributesMarker","directiveLeafAttribute","directiveLeafAttributeId","directiveLeafAttributeClass","directiveLeafAttributeName","directiveLeafAttributeInitializerMarker","directiveLeafAttributeValueLiteral","directiveLeafAttributeValue","directiveLeafAttributeValueMarker","directiveLeafAttributeValueData",!0)}const Iv={tokenize:Fv,previous:Lv},Bv={tokenize:jv,partial:!0},Ov={tokenize:Nv,partial:!0};function Lv(e){return e!==58||this.events[this.events.length-1][1].type==="characterEscape"}function Fv(e,t,n){const r=this;return a;function a(f){return e.enter("directiveText"),e.enter("directiveTextMarker"),e.consume(f),e.exit("directiveTextMarker"),mo.call(r,e,i,n,"directiveTextName")}function i(f){return f===58?n(f):f===91?e.attempt(Bv,s,s)(f):s(f)}function s(f){return f===123?e.attempt(Ov,l,l)(f):l(f)}function l(f){return e.exit("directiveText"),t(f)}}function jv(e,t,n){return fo(e,t,n,"directiveTextLabel","directiveTextLabelMarker","directiveTextLabelString")}function Nv(e,t,n){return uo(e,t,n,"directiveTextAttributes","directiveTextAttributesMarker","directiveTextAttribute","directiveTextAttributeId","directiveTextAttributeClass","directiveTextAttributeName","directiveTextAttributeInitializerMarker","directiveTextAttributeValueLiteral","directiveTextAttributeValue","directiveTextAttributeValueMarker","directiveTextAttributeValueData")}function Dv(){return{text:{[58]:Iv},flow:{[58]:[gv,Av]}}}const Hv=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],Cc={0:"\uFFFD",128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};function Ic(e){const t=typeof e=="string"?e.charCodeAt(0):e;return t>=48&&t<=57}function zv(e){const t=typeof e=="string"?e.charCodeAt(0):e;return t>=97&&t<=102||t>=65&&t<=70||t>=48&&t<=57}function Pv(e){const t=typeof e=="string"?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90}function Bc(e){return Pv(e)||Ic(e)}const Wr=String.fromCharCode,Vv=["","Named character references must be terminated by a semicolon","Numeric character references must be terminated by a semicolon","Named character references cannot be empty","Numeric character references cannot be empty","Named character references must be known","Numeric character references cannot be disallowed","Numeric character references cannot be outside the permissible Unicode range"];function ho(e,t={}){const n=typeof t.additional=="string"?t.additional.charCodeAt(0):t.additional,r=[];let a=0,i=-1,s="",l,f;t.position&&("start"in t.position||"indent"in t.position?(f=t.position.indent,l=t.position.start):l=t.position);let u=(l?l.line:0)||1,m=(l?l.column:0)||1,c=_(),b;for(a--;++a<=e.length;)if(b===10&&(m=(f?f[i]:0)||1),b=e.charCodeAt(a),b===38){const T=e.charCodeAt(a+1);if(T===9||T===10||T===12||T===32||T===38||T===60||Number.isNaN(T)||n&&T===n){s+=Wr(b),m++;continue}const C=a+1;let p=C,A=C,F;if(T===35){A=++p;const x=e.charCodeAt(A);x===88||x===120?(F="hexadecimal",A=++p):F="decimal"}else F="named";let R="",I="",h="";const M=F==="named"?Bc:F==="decimal"?Ic:zv;for(A--;++A<=e.length;){const x=e.charCodeAt(A);if(!M(x))break;h+=Wr(x),F==="named"&&Hv.includes(h)&&(R=h,I=ya(h))}let S=e.charCodeAt(A)===59;if(S){A++;const x=F==="named"?ya(h):!1;x&&(R=h,I=x)}let v=1+A-C,y="";if(!(!S&&t.nonTerminated===!1))if(!h)F!=="named"&&o(4,v);else if(F==="named"){if(S&&!I)o(5,1);else if(R!==h&&(A=p+R.length,v=1+A-p,S=!1),!S){const x=R?1:3;if(t.attribute){const w=e.charCodeAt(A);w===61?(o(x,v),I=""):Bc(w)?I="":o(x,v)}else o(x,v)}y=I}else{S||o(2,v);let x=Number.parseInt(h,F==="hexadecimal"?16:10);if(Uv(x))o(7,v),y=Wr(65533);else if(x in Cc)o(6,v),y=Cc[x];else{let w="";qv(x)&&o(6,v),x>65535&&(x-=65536,w+=Wr(x>>>10|55296),x=56320|x&1023),y=w+Wr(x)}}if(y){B(),c=_(),a=A-1,m+=A-C+1,r.push(y);const x=_();x.offset++,t.reference&&t.reference.call(t.referenceContext,y,{start:c,end:x},e.slice(C-1,A)),c=x}else h=e.slice(C-1,A),s+=h,m+=h.length,a=A-1}else b===10&&(u++,i++,m=0),Number.isNaN(b)?B():(s+=Wr(b),m++);return r.join("");function _(){return{line:u,column:m,offset:a+((l?l.offset:0)||0)}}function o(T,C){let p;t.warning&&(p=_(),p.column+=C,p.offset+=C,t.warning.call(t.warningContext,Vv[T],p,T))}function B(){s&&(r.push(s),t.text&&t.text.call(t.textContext,s,{start:c,end:_()}),s="")}}function Uv(e){return e>=55296&&e<=57343||e>1114111}function qv(e){return e>=1&&e<=8||e===11||e>=13&&e<=31||e>=127&&e<=159||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534}const Oc={}.hasOwnProperty;function Xv(e){const t=e||{};return{enter:{directiveContainer(){n.call(this,"containerDirective")},directiveContainerAttributes:s,directiveContainerLabel:a,directiveContainerContent(){this.buffer()},directiveLeaf(){n.call(this,"leafDirective")},directiveLeafAttributes:s,directiveLeafLabel:a,directiveText(){n.call(this,"textDirective")},directiveTextAttributes:s,directiveTextLabel:a},exit:{directiveContainer:o,directiveContainerAttributeClassValue:f,directiveContainerAttributeIdValue:l,directiveContainerAttributeName:u,directiveContainerAttributeValue:m,directiveContainerAttributes:c,directiveContainerContent:b,directiveContainerFence:_,directiveContainerLabel:i,directiveContainerName:r,directiveLeaf:o,directiveLeafAttributeClassValue:f,directiveLeafAttributeIdValue:l,directiveLeafAttributeName:u,directiveLeafAttributeValue:m,directiveLeafAttributes:c,directiveLeafLabel:i,directiveLeafName:r,directiveText:o,directiveTextAttributeClassValue:f,directiveTextAttributeIdValue:l,directiveTextAttributeName:u,directiveTextAttributeValue:m,directiveTextAttributes:c,directiveTextLabel:i,directiveTextName:r}};function n(B){let T=this.getData("directiveStack");T||this.setData("directiveStack",T=[]),T.push({type:B,name:""})}function r(B){const T=this.getData("directiveStack");T[T.length-1].name=this.sliceSerialize(B)}function a(){this.buffer()}function i(){const B=this.resume(),T=this.getData("directiveStack");T[T.length-1].label=B}function s(){this.buffer(),this.setData("directiveAttributes",[])}function l(B){this.getData("directiveAttributes").push(["id",ho(this.sliceSerialize(B),{attribute:!0})])}function f(B){this.getData("directiveAttributes").push(["class",ho(this.sliceSerialize(B),{attribute:!0})])}function u(B){this.getData("directiveAttributes").push([this.sliceSerialize(B),""])}function m(B){const T=this.getData("directiveAttributes");T[T.length-1][1]=ho(this.sliceSerialize(B),{attribute:!0})}function c(){const B=this.getData("directiveStack"),T=this.getData("directiveAttributes"),C={};let p=-1;for(;++p<T.length;){const A=T[p];A[0]==="class"&&C.class?C.class+=" "+A[1]:C[A[0]]=A[1]}this.resume(),this.setData("directiveAttributes"),B[B.length-1].attributes=C}function b(){const B=this.resume(),T=this.getData("directiveStack");T[T.length-1].content=B}function _(){const B=this.getData("directiveStack"),T=B[B.length-1];T._fenceCount||(T._fenceCount=0),T._fenceCount++,T._fenceCount===1&&this.setData("slurpOneLineEnding",!0)}function o(){const T=this.getData("directiveStack").pop();let C,p;Oc.call(t,T.name)&&(p=t[T.name].call(this,T),C=p!==!1),!C&&Oc.call(t,"*")&&(p=t["*"].call(this,T),C=p!==!1),!C&&T.type!=="textDirective"&&this.setData("slurpOneLineEnding",!0)}}var Yv=(e,{textFormatting:t})=>{if(t){let n=[];t.linkify||(n=["literalAutolink","literalAutolinkEmail"]);const r=x2(e.replaceAll("<usertag>","<@").replaceAll("</usertag>",">"),{extensions:[{...fv(),disable:{null:n}},hv,pv,Dv()],htmlExtensions:[mv(),vv,_v(t.users),Xv({rainbow:Kv,blink:Gv,red:Wv,gold:Zv,silver:Qv,bronze:Jv,shake:$v})]});if(t.singleLine){const a=document.createElement("div");return a.innerHTML=r,[{types:[],value:a.innerText}]}return[{types:["markdown"],value:r}]}return[{types:[],value:e}]};function Kv(e){var n;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;const t=(n=e.content)!=null?n:e.label;this.tag('<span class="vac-effects-rainbow">'),this.raw(t),this.tag("</span>")}function Gv(e){var n;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;const t=(n=e.content)!=null?n:e.label;this.tag('<span class="vac-effects-blink">'),this.raw(t),this.tag("</span>")}function Wv(e){var n;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;const t=(n=e.content)!=null?n:e.label;this.tag('<span style="color: red">'),this.raw(t),this.tag("</span>")}function Zv(e){var n;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;const t=(n=e.content)!=null?n:e.label;this.tag('<span class="vac-effects-gold">'),this.raw(t),this.tag("</span>")}function Qv(e){var n;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;const t=(n=e.content)!=null?n:e.label;this.tag('<span class="vac-effects-silver">'),this.raw(t),this.tag("</span>")}function Jv(e){var n;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;const t=(n=e.content)!=null?n:e.label;this.tag('<span class="vac-effects-bronze">'),this.raw(t),this.tag("</span>")}function $v(e){var r;if(e.type!=="textDirective"&&e.type!=="containerDirective")return!1;this.tag('<span class="vac-effects-shake">');const t=(r=e.content)!=null?r:e.label,n=this.encode(t);for(let a=0;a<n.length;a++){const i=n.charAt(a),s=(-Math.random()).toString();this.tag('<span class="vac-effects-shake-letter" style="animation-delay: '+s+'s;">'),this.raw(i),this.tag("</span>")}this.tag("</span>")}const vo=["png","jpg","jpeg","webp","svg","gif"],Lc=["mp4","video/ogg","webm","quicktime"],ep=["mp3","audio/ogg","wav","mpeg"],tp={name:"FormatMessage",components:{SvgIcon:Dt},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{parsedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];let e;this.textFormatting.disabled?e={}:e={textFormatting:{linkify:this.linkify,linkOptions:this.linkOptions,singleLine:this.singleLine,reply:this.reply,users:this.users,...this.textFormatting}};const t=Yv(this.content,e);return t.forEach(n=>{n.markdown=this.checkType(n,"markdown"),n.tag=this.checkType(n,"tag"),n.image=this.checkImageType(n)}),t}},methods:{checkType(e,t){return e.types&&e.types.indexOf(t)!==-1},checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const r=e.value.substring(t+1,e.value.length),a=t>0&&vo.some(i=>r.toLowerCase().includes(i));return a&&this.setImageSize(e),a},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",n);function n(r){const a=r.path[0].width/150;e.height=Math.round(r.path[0].height/a)+"px",t.removeEventListener("load",n)}},openTag(e){const t=e.target.getAttribute("data-user-id");if(!this.singleLine&&t){const n=this.users.find(r=>String(r._id)===t);this.$emit("open-user-tag",n)}}}},np=["innerHTML"],rp={class:"vac-image-link-container"},ip={class:"vac-image-link-message"};function ap(e,t,n,r,a,i){const s=Xe("svg-icon");return Q(),se("div",{class:nt(["vac-format-message-wrapper",{"vac-text-ellipsis":n.singleLine}])},[(Q(!0),se(st,null,$e(i.parsedMessage,(l,f)=>(Q(),se(st,{key:f},[l.markdown?(Q(),se("div",{key:0,class:"markdown",onClick:t[0]||(t[0]=(...u)=>i.openTag&&i.openTag(...u)),innerHTML:l.value},null,8,np)):(Q(),se("div",{key:1,class:nt(["vac-format-container",{"vac-text-ellipsis":n.singleLine}])},[(Q(),dt(qd(l.url?"a":"span"),{class:nt({"vac-text-ellipsis":n.singleLine,"vac-text-tag":!n.singleLine&&!n.reply&&l.tag}),href:l.href,target:l.href?n.linkOptions.target:null,rel:l.href?n.linkOptions.rel:null},{default:Ke(()=>[n.deleted?(Q(),se(st,{key:0},[Re(e.$slots,n.roomList?"deleted-icon-room_"+n.roomId:"deleted-icon_"+n.messageId,{},()=>[Oe(s,{name:"deleted",class:nt(["vac-icon-deleted",{"vac-icon-deleted-room":n.roomList}])},null,8,["class"])]),Vn(" "+Qe(n.textMessages.MESSAGE_DELETED),1)],64)):l.url&&l.image?(Q(),se(st,{key:1},[ke("div",rp,[ke("div",{class:"vac-image-link",style:St({"background-image":`url('${l.value}')`,height:l.height})},null,4)]),ke("div",ip,Qe(l.value),1)],64)):(Q(),se(st,{key:2},[Vn(Qe(l.value),1)],64))]),_:2},1032,["class","href","target","rel"]))],2))],64))),128))],2)}var Mi=xt(tp,[["render",ap]]);const Mr="__v-click-outside",Fc=typeof window!="undefined",sp=typeof navigator!="undefined",op=Fc&&("ontouchstart"in window||sp&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],lp=e=>{const t=typeof e=="function";if(!t&&typeof e!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(n=>n),events:e.events||op,isActive:e.isActive!==!1,detectIframe:e.detectIframe!==!1,capture:Boolean(e.capture)}},jc=({event:e,handler:t,middleware:n})=>{n(e)&&t(e)},cp=({el:e,event:t,handler:n,middleware:r})=>{setTimeout(()=>{const{activeElement:a}=document;a&&a.tagName==="IFRAME"&&!e.contains(a)&&jc({event:t,handler:n,middleware:r})},0)},up=({el:e,event:t,handler:n,middleware:r})=>{const a=t.path||t.composedPath&&t.composedPath();(a?a.indexOf(e)<0:!e.contains(t.target))&&jc({event:t,handler:n,middleware:r})},Nc=(e,{value:t})=>{const{events:n,handler:r,middleware:a,isActive:i,detectIframe:s,capture:l}=lp(t);if(!!i){if(e[Mr]=n.map(f=>({event:f,srcTarget:document.documentElement,handler:u=>up({el:e,event:u,handler:r,middleware:a}),capture:l})),s){const f={event:"blur",srcTarget:window,handler:u=>cp({el:e,event:u,handler:r,middleware:a}),capture:l};e[Mr]=[...e[Mr],f]}e[Mr].forEach(({event:f,srcTarget:u,handler:m})=>setTimeout(()=>{!e[Mr]||u.addEventListener(f,m,l)},0))}},Dc=e=>{(e[Mr]||[]).forEach(({event:n,srcTarget:r,handler:a,capture:i})=>r.removeEventListener(n,a,i)),delete e[Mr]};var Ta=Fc?{beforeMount:Nc,updated:(e,{value:t,oldValue:n})=>{JSON.stringify(t)!==JSON.stringify(n)&&(Dc(e),Nc(e,{value:t}))},unmounted:Dc}:{},Hc=(e,t,n)=>{if(e.typingUsers&&e.typingUsers.length){const r=e.users.filter(a=>{if(a._id!==t&&e.typingUsers.indexOf(a._id)!==-1&&!(a.status&&a.status.state==="offline"))return!0});return r.length?e.users.length===2?n.IS_TYPING:r.map(a=>a.username).join(", ")+" "+n.IS_TYPING:void 0}};function Ei(e,t){if(!(!t||!t.type))return e.some(n=>t.type.toLowerCase().includes(n))}function Zr(e){return Ei(vo,e)}function Ti(e){return Ei(Lc,e)}function zc(e){return Ei(vo,e)||Ei(Lc,e)}function Ra(e){return Ei(ep,e)}const dp={name:"RoomsContent",components:{SvgIcon:Dt,FormatMessage:Mi},directives:{clickOutside:Ta},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const n=this.room.users.find(r=>r._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:!n||n._id===this.currentUserId?t:`${n.username} - ${t}`},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(t=>t._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return Hc(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var t,n;const e=(n=(t=this.room.lastMessage)==null?void 0:t.files)==null?void 0:n[0];if(e){if(!e.duration)return`${e.name}.${e.extension}`;let r=Math.floor(e.duration);return(r-(r%=60))/60+(r>9?":":":0")+r}return""},isAudio(){return this.room.lastMessage.files?Ra(this.room.lastMessage.files[0]):!1}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},fp={class:"vac-room-container"},mp={class:"vac-name-container vac-text-ellipsis"},hp={class:"vac-title-container"},vp={class:"vac-room-name vac-text-ellipsis"},pp={key:1,class:"vac-text-date"},_p={key:0},gp={key:1,class:"vac-text-ellipsis"},bp={key:3,class:"vac-text-ellipsis"},xp={class:"vac-room-options-container"},yp={key:0,class:"vac-badge-counter vac-room-badge"},wp={key:0,class:"vac-menu-options"},kp={class:"vac-menu-list"},Sp=["onClick"];function Ap(e,t,n,r,a,i){const s=Xe("svg-icon"),l=Xe("format-message"),f=ma("click-outside");return Q(),se("div",fp,[Re(e.$slots,"room-list-item_"+n.room.roomId,{},()=>[Re(e.$slots,"room-list-avatar_"+n.room.roomId,{},()=>[n.room.avatar?(Q(),se("div",{key:0,class:"vac-avatar",style:St({"background-image":`url('${n.room.avatar}')`})},null,4)):Te("",!0)]),ke("div",mp,[ke("div",hp,[i.userStatus?(Q(),se("div",{key:0,class:nt(["vac-state-circle",{"vac-state-online":i.userStatus==="online"}])},null,2)):Te("",!0),ke("div",vp,Qe(n.room.roomName),1),n.room.lastMessage?(Q(),se("div",pp,Qe(n.room.lastMessage.timestamp),1)):Te("",!0)]),ke("div",{class:nt(["vac-text-last",{"vac-message-new":n.room.lastMessage&&n.room.lastMessage.new&&!i.typingUsers}])},[i.isMessageCheckmarkVisible?(Q(),se("span",_p,[Re(e.$slots,"checkmark-icon_"+n.room.roomId,{},()=>[Oe(s,{name:n.room.lastMessage.distributed?"double-checkmark":"checkmark",param:n.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Te("",!0),n.room.lastMessage&&!n.room.lastMessage.deleted&&i.isAudio?(Q(),se("div",gp,[Re(e.$slots,"microphone-icon_"+n.room.roomId,{},()=>[Oe(s,{name:"microphone",class:"vac-icon-microphone"})]),Vn(" "+Qe(i.formattedDuration),1)])):n.room.lastMessage?(Q(),dt(l,{key:2,"message-id":n.room.lastMessage._id,"room-id":n.room.roomId,"room-list":!0,content:i.getLastMessage,deleted:!!n.room.lastMessage.deleted&&!i.typingUsers,users:n.room.users,"text-messages":n.textMessages,linkify:!1,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"single-line":!0},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Te("",!0),!n.room.lastMessage&&i.typingUsers?(Q(),se("div",bp,Qe(i.typingUsers),1)):Te("",!0),ke("div",xp,[n.room.unreadCount?(Q(),se("div",yp,Qe(n.room.unreadCount),1)):Te("",!0),Re(e.$slots,"room-list-options_"+n.room.roomId,{},()=>[n.roomActions.length?(Q(),se("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Rn(u=>a.roomMenuOpened=n.room.roomId,["stop"]))},[Re(e.$slots,"room-list-options-icon_"+n.room.roomId,{},()=>[Oe(s,{name:"dropdown",param:"room"})])])):Te("",!0),n.roomActions.length?(Q(),dt(It,{key:1,name:"vac-slide-left"},{default:Ke(()=>[a.roomMenuOpened===n.room.roomId?Pn((Q(),se("div",wp,[ke("div",kp,[(Q(!0),se(st,null,$e(n.roomActions,u=>(Q(),se("div",{key:u.name},[ke("div",{class:"vac-menu-item",onClick:Rn(m=>i.roomActionHandler(u),["stop"])},Qe(u.title),9,Sp)]))),128))])])),[[f,i.closeRoomMenu]]):Te("",!0)]),_:1})):Te("",!0)])])],2)])])])}var Mp=xt(dp,[["render",Ap]]),po=(e,t,n,r=!1)=>!n||n===""?e:e.filter(a=>r?Ca(a[t]).startsWith(Ca(n)):Ca(a[t]).includes(Ca(n)));function Ca(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const Ep={name:"RoomsList",components:{Loader:ki,RoomsSearch:Rm,RoomContent:Mp},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=po(this.rooms,"roomName",e.target.value)},openRoom(e){e.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded){this.loadingMoreRooms=!1,this.showLoader=!1;return}this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},Tp={key:0,class:"vac-rooms-empty"},Rp={key:1,id:"rooms-list",class:"vac-room-list"},Cp=["id","onClick"],Ip={key:0,id:"infinite-loader-rooms"};function Bp(e,t,n,r,a,i){const s=Xe("rooms-search"),l=Xe("loader"),f=Xe("room-content");return Pn((Q(),se("div",{class:nt(["vac-rooms-container",{"vac-rooms-container-full":n.isMobile,"vac-app-border-r":!n.isMobile}])},[Re(e.$slots,"rooms-header"),Re(e.$slots,"rooms-list-search",{},()=>[Oe(s,{rooms:n.rooms,"loading-rooms":n.loadingRooms,"text-messages":n.textMessages,"show-search":n.showSearch,"show-add-room":n.showAddRoom,onSearchRoom:i.searchRoom,onAddRoom:t[0]||(t[0]=u=>e.$emit("add-room"))},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),Oe(l,{show:n.loadingRooms,type:"rooms"},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["show"]),!n.loadingRooms&&!n.rooms.length?(Q(),se("div",Tp,[Re(e.$slots,"rooms-empty",{},()=>[Vn(Qe(n.textMessages.ROOMS_EMPTY),1)])])):Te("",!0),n.loadingRooms?Te("",!0):(Q(),se("div",Rp,[(Q(!0),se(st,null,$e(a.filteredRooms,u=>(Q(),se("div",{id:u.roomId,key:u.roomId,class:nt(["vac-room-item",{"vac-room-selected":a.selectedRoomId===u.roomId}]),onClick:m=>i.openRoom(u)},[Oe(f,{"current-user-id":n.currentUserId,room:u,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"text-messages":n.textMessages,"room-actions":n.roomActions,onRoomActionHandler:t[1]||(t[1]=m=>e.$emit("room-action-handler",m))},_t({_:2},[$e(e.$slots,(m,c)=>({name:c,fn:Ke(b=>[Re(e.$slots,c,pt(vt(b)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,Cp))),128)),Oe(It,{name:"vac-fade-message"},{default:Ke(()=>[n.rooms.length&&!n.loadingRooms?(Q(),se("div",Ip,[Oe(l,{show:a.showLoader,infinite:!0,type:"infinite-rooms"},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["show"])])):Te("",!0)]),_:3})]))],2)),[[xa,n.showRoomsList]])}var Op=xt(Ep,[["render",Bp]]);const Lp={name:"RoomHeader",components:{SvgIcon:Dt},directives:{clickOutside:Ta},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return Hc(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(n=>n._id!==this.currentUserId);if(!(e!=null&&e.status))return;let t="";return e.status.state==="online"?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},Fp={class:"vac-room-header vac-app-border-b"},jp={class:"vac-room-wrapper"},Np={key:0,class:"vac-room-selection"},Dp=["id"],Hp=["onClick"],zp={class:"vac-selection-button-count"},Pp={class:"vac-text-ellipsis"},Vp={class:"vac-room-name vac-text-ellipsis"},Up={key:0,class:"vac-room-info vac-text-ellipsis"},qp={key:1,class:"vac-room-info vac-text-ellipsis"},Xp={key:0,class:"vac-menu-options"},Yp={class:"vac-menu-list"},Kp=["onClick"];function Gp(e,t,n,r,a,i){const s=Xe("svg-icon"),l=ma("click-outside");return Q(),se("div",Fp,[Re(e.$slots,"room-header",{},()=>[ke("div",jp,[Oe(It,{name:"vac-slide-up"},{default:Ke(()=>[n.messageSelectionEnabled?(Q(),se("div",Np,[(Q(!0),se(st,null,$e(n.messageSelectionActions,f=>(Q(),se("div",{id:f.name,key:f.name},[ke("div",{class:"vac-selection-button",onClick:u=>i.messageSelectionActionHandler(f)},[Vn(Qe(f.title)+" ",1),ke("span",zp,Qe(n.selectedMessagesTotal),1)],8,Hp)],8,Dp))),128)),ke("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=f=>e.$emit("cancel-message-selection"))},Qe(n.textMessages.CANCEL_SELECT_MESSAGE),1)])):Te("",!0)]),_:1}),!n.messageSelectionEnabled&&a.messageSelectionAnimationEnded?(Q(),se(st,{key:0},[n.singleRoom?Te("",!0):(Q(),se("div",{key:0,class:nt(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!n.isMobile,"vac-rotate-icon":!n.showRoomsList&&!n.isMobile}]),onClick:t[1]||(t[1]=f=>e.$emit("toggle-rooms-list"))},[Re(e.$slots,"toggle-icon",{},()=>[Oe(s,{name:"toggle"})])],2)),ke("div",{class:nt(["vac-info-wrapper",{"vac-item-clickable":n.roomInfoEnabled}]),onClick:t[2]||(t[2]=f=>e.$emit("room-info"))},[Re(e.$slots,"room-header-avatar",{},()=>[n.room.avatar?(Q(),se("div",{key:0,class:"vac-avatar",style:St({"background-image":`url('${n.room.avatar}')`})},null,4)):Te("",!0)]),Re(e.$slots,"room-header-info",{},()=>[ke("div",Pp,[ke("div",Vp,Qe(n.room.roomName),1),i.typingUsers?(Q(),se("div",Up,Qe(i.typingUsers),1)):(Q(),se("div",qp,Qe(i.userStatus),1))])])],2),n.room.roomId?Re(e.$slots,"room-options",{key:1},()=>[n.menuActions.length?(Q(),se("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=f=>a.menuOpened=!a.menuOpened)},[Re(e.$slots,"menu-icon",{},()=>[Oe(s,{name:"menu"})])])):Te("",!0),n.menuActions.length?(Q(),dt(It,{key:1,name:"vac-slide-left"},{default:Ke(()=>[a.menuOpened?Pn((Q(),se("div",Xp,[ke("div",Yp,[(Q(!0),se(st,null,$e(n.menuActions,f=>(Q(),se("div",{key:f.name},[ke("div",{class:"vac-menu-item",onClick:u=>i.menuActionHandler(f)},Qe(f.title),9,Kp)]))),128))])])),[[l,i.closeMenu]]):Te("",!0)]),_:1})):Te("",!0)]):Te("",!0)],64)):Te("",!0)])])])}var Wp=xt(Lp,[["render",Gp]]);function Ia(e){if(typeof e!="string"||!e)throw new Error("expected a non-empty string, got: "+e)}function _o(e){if(typeof e!="number")throw new Error("expected a number, got: "+e)}const Zp=1,Qp=1,Er="emoji",Qr="keyvalue",go="favorites",Jp="tokens",Pc="tokens",$p="unicode",Vc="count",e_="group",t_="order",Uc="group-order",bo="eTag",Ba="url",qc="skinTone",Jr="readonly",xo="readwrite",Xc="skinUnicodes",n_="skinUnicodes",r_="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",i_="en";function a_(e,t){const n=new Set,r=[];for(const a of e){const i=t(a);n.has(i)||(n.add(i),r.push(a))}return r}function Yc(e){return a_(e,t=>t.unicode)}function s_(e){function t(n,r,a){const i=r?e.createObjectStore(n,{keyPath:r}):e.createObjectStore(n);if(a)for(const[s,[l,f]]of Object.entries(a))i.createIndex(s,l,{multiEntry:f});return i}t(Qr),t(Er,$p,{[Pc]:[Jp,!0],[Uc]:[[e_,t_]],[Xc]:[n_,!0]}),t(go,void 0,{[Vc]:[""]})}const yo={},Oa={},La={};function Kc(e,t,n){n.onerror=()=>t(n.error),n.onblocked=()=>t(new Error("IDB blocked")),n.onsuccess=()=>e(n.result)}async function o_(e){const t=await new Promise((n,r)=>{const a=indexedDB.open(e,Zp);yo[e]=a,a.onupgradeneeded=i=>{i.oldVersion<Qp&&s_(a.result)},Kc(n,r,a)});return t.onclose=()=>wo(e),t}function l_(e){return Oa[e]||(Oa[e]=o_(e)),Oa[e]}function Kn(e,t,n,r){return new Promise((a,i)=>{const s=e.transaction(t,n,{durability:"relaxed"}),l=typeof t=="string"?s.objectStore(t):t.map(u=>s.objectStore(u));let f;r(l,s,u=>{f=u}),s.oncomplete=()=>a(f),s.onerror=()=>i(s.error)})}function wo(e){const t=yo[e],n=t&&t.result;if(n){n.close();const r=La[e];if(r)for(const a of r)a()}delete yo[e],delete Oa[e],delete La[e]}function c_(e){return new Promise((t,n)=>{wo(e);const r=indexedDB.deleteDatabase(e);Kc(t,n,r)})}function u_(e,t){let n=La[e];n||(n=La[e]=[]),n.push(t)}const d_=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function $r(e){return e.split(/[\s_]+/).map(t=>!t.match(/\w/)||d_.has(t)?t.toLowerCase():t.replace(/[)(:,]/g,"").replace(//g,"'").toLowerCase()).filter(Boolean)}const f_=2;function Gc(e){return e.filter(Boolean).map(t=>t.toLowerCase()).filter(t=>t.length>=f_)}function m_(e){return e.map(({annotation:n,emoticon:r,group:a,order:i,shortcodes:s,skins:l,tags:f,emoji:u,version:m})=>{const c=[...new Set(Gc([...(s||[]).map($r).flat(),...f.map($r).flat(),...$r(n),r]))].sort(),b={annotation:n,group:a,order:i,tags:f,tokens:c,unicode:u,version:m};if(r&&(b.emoticon=r),s&&(b.shortcodes=s),l){b.skinTones=[],b.skinUnicodes=[],b.skinVersions=[];for(const{tone:_,emoji:o,version:B}of l)b.skinTones.push(_),b.skinUnicodes.push(o),b.skinVersions.push(B)}return b})}function Wc(e,t,n,r){e[t](n).onsuccess=a=>r&&r(a.target.result)}function Tr(e,t,n){Wc(e,"get",t,n)}function Zc(e,t,n){Wc(e,"getAll",t,n)}function ko(e){e.commit&&e.commit()}function h_(e,t){let n=e[0];for(let r=1;r<e.length;r++){const a=e[r];t(n)>t(a)&&(n=a)}return n}function Qc(e,t){const n=h_(e,a=>a.length),r=[];for(const a of n)e.some(i=>i.findIndex(s=>t(s)===t(a))===-1)||r.push(a);return r}async function v_(e){return!await So(e,Qr,Ba)}async function p_(e,t,n){const[r,a]=await Promise.all([bo,Ba].map(i=>So(e,Qr,i)));return r===n&&a===t}async function __(e,t){return Kn(e,Er,Jr,(r,a,i)=>{let s;const l=()=>{r.getAll(s&&IDBKeyRange.lowerBound(s,!0),50).onsuccess=f=>{const u=f.target.result;for(const m of u)if(s=m.unicode,t(m))return i(m);if(u.length<50)return i();l()}};l()})}async function Jc(e,t,n,r){try{const a=m_(t);await Kn(e,[Er,Qr],xo,([i,s],l)=>{let f,u,m=0;function c(){++m===2&&b()}function b(){if(!(f===r&&u===n)){i.clear();for(const _ of a)i.put(_);s.put(r,bo),s.put(n,Ba),ko(l)}}Tr(s,bo,_=>{f=_,c()}),Tr(s,Ba,_=>{u=_,c()})})}finally{}}async function g_(e,t){return Kn(e,Er,Jr,(n,r,a)=>{const i=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);Zc(n.index(Uc),i,a)})}async function $c(e,t){const n=Gc($r(t));return n.length?Kn(e,Er,Jr,(r,a,i)=>{const s=[],l=()=>{s.length===n.length&&f()},f=()=>{const u=Qc(s,m=>m.unicode);i(u.sort((m,c)=>m.order<c.order?-1:1))};for(let u=0;u<n.length;u++){const m=n[u],c=u===n.length-1?IDBKeyRange.bound(m,m+"\uFFFF",!1,!0):IDBKeyRange.only(m);Zc(r.index(Pc),c,b=>{s.push(b),l()})}}):[]}async function b_(e,t){const n=await $c(e,t);return n.length?n.filter(r=>(r.shortcodes||[]).map(i=>i.toLowerCase()).includes(t.toLowerCase()))[0]||null:await __(e,a=>(a.shortcodes||[]).includes(t.toLowerCase()))||null}async function x_(e,t){return Kn(e,Er,Jr,(n,r,a)=>Tr(n,t,i=>{if(i)return a(i);Tr(n.index(Xc),t,s=>a(s||null))}))}function So(e,t,n){return Kn(e,t,Jr,(r,a,i)=>Tr(r,n,i))}function y_(e,t,n,r){return Kn(e,t,xo,(a,i)=>{a.put(r,n),ko(i)})}function w_(e,t){return Kn(e,go,xo,(n,r)=>Tr(n,t,a=>{n.put((a||0)+1,t),ko(r)}))}function k_(e,t,n){return n===0?[]:Kn(e,[go,Er],Jr,([r,a],i,s)=>{const l=[];r.index(Vc).openCursor(void 0,"prev").onsuccess=f=>{const u=f.target.result;if(!u)return s(l);function m(_){if(l.push(_),l.length===n)return s(l);u.continue()}const c=u.primaryKey,b=t.byName(c);if(b)return m(b);Tr(a,c,_=>{if(_)return m(_);u.continue()})}})}const Fa="";function S_(e,t){const n=new Map;for(const a of e){const i=t(a);for(const s of i){let l=n;for(let u=0;u<s.length;u++){const m=s.charAt(u);let c=l.get(m);c||(c=new Map,l.set(m,c)),l=c}let f=l.get(Fa);f||(f=[],l.set(Fa,f)),f.push(a)}}return(a,i)=>{let s=n;for(let u=0;u<a.length;u++){const m=a.charAt(u),c=s.get(m);if(c)s=c;else return[]}if(i)return s.get(Fa)||[];const l=[],f=[s];for(;f.length;){const m=[...f.shift().entries()].sort((c,b)=>c[0]<b[0]?-1:1);for(const[c,b]of m)c===Fa?l.push(...b):f.push(b)}return l}}const A_=["name","url"];function M_(e){const t=e&&Array.isArray(e),n=t&&e.length&&(!e[0]||A_.some(r=>!(r in e[0])));if(!t||n)throw new Error("Custom emojis are in the wrong format")}function eu(e){M_(e);const t=(b,_)=>b.name.toLowerCase()<_.name.toLowerCase()?-1:1,n=e.sort(t),a=S_(e,b=>[...new Set((b.shortcodes||[]).map(_=>$r(_)).flat())]),i=b=>a(b,!0),s=b=>a(b,!1),l=b=>{const _=$r(b),o=_.map((B,T)=>(T<_.length-1?i:s)(B));return Qc(o,B=>B.name).sort(t)},f=new Map,u=new Map;for(const b of e){u.set(b.name.toLowerCase(),b);for(const _ of b.shortcodes||[])f.set(_.toLowerCase(),b)}return{all:n,search:l,byShortcode:b=>f.get(b.toLowerCase()),byName:b=>u.get(b.toLowerCase())}}function Ri(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let n=0;n<t;n++)e.skins[n]={tone:e.skinTones[n],unicode:e.skinUnicodes[n],version:e.skinVersions[n]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function tu(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const E_=["annotation","emoji","group","order","tags","version"];function T_(e){if(!e||!Array.isArray(e)||!e[0]||typeof e[0]!="object"||E_.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function nu(e,t){if(Math.floor(e.status/100)!==2)throw new Error("Failed to fetch: "+t+":  "+e.status)}async function R_(e){const t=await fetch(e,{method:"HEAD"});nu(t,e);const n=t.headers.get("etag");return tu(n),n}async function Ao(e){const t=await fetch(e);nu(t,e);const n=t.headers.get("etag");tu(n);const r=await t.json();return T_(r),[n,r]}function C_(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,a=-1;++a<r;)t+=String.fromCharCode(n[a]);return t}function I_(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),a=-1;++a<t;)r[a]=e.charCodeAt(a);return n}async function ru(e){const t=JSON.stringify(e),n=I_(t),r=await crypto.subtle.digest("SHA-1",n),a=C_(r);return btoa(a)}async function B_(e,t){let n,r=await R_(t);if(!r){const a=await Ao(t);r=a[0],n=a[1],r||(r=await ru(n))}await p_(e,t,r)||(n||(n=(await Ao(t))[1]),await Jc(e,n,t,r))}async function O_(e,t){let[n,r]=await Ao(t);n||(n=await ru(r)),await Jc(e,r,t,n)}class iu{constructor({dataSource:t=r_,locale:n=i_,customEmoji:r=[]}={}){this.dataSource=t,this.locale=n,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=eu(r),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const t=this._db=await l_(this._dbName);u_(this._dbName,this._clear);const n=this.dataSource;await v_(t)?await O_(t,n):this._lazyUpdate=B_(t,n)}async ready(){const t=async()=>(this._ready||(this._ready=this._init()),this._ready);await t(),this._db||await t()}async getEmojiByGroup(t){return _o(t),await this.ready(),Yc(await g_(this._db,t)).map(Ri)}async getEmojiBySearchQuery(t){Ia(t),await this.ready();const n=this._custom.search(t),r=Yc(await $c(this._db,t)).map(Ri);return[...n,...r]}async getEmojiByShortcode(t){Ia(t),await this.ready();const n=this._custom.byShortcode(t);return n||Ri(await b_(this._db,t))}async getEmojiByUnicodeOrName(t){Ia(t),await this.ready();const n=this._custom.byName(t);return n||Ri(await x_(this._db,t))}async getPreferredSkinTone(){return await this.ready(),await So(this._db,Qr,qc)||0}async setPreferredSkinTone(t){return _o(t),await this.ready(),y_(this._db,Qr,qc,t)}async incrementFavoriteEmojiCount(t){return Ia(t),await this.ready(),w_(this._db,t)}async getTopFavoriteEmoji(t){return _o(t),await this.ready(),(await k_(this._db,this._custom,t)).map(Ri)}set customEmoji(t){this._custom=eu(t)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await wo(this._dbName)}async delete(){await this._shutdown(),await c_(this._dbName)}}function Ci(){}function au(e){return e()}function su(){return Object.create(null)}function Ii(e){e.forEach(au)}function ou(e){return typeof e=="function"}function L_(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let ja;function Na(e,t){return ja||(ja=document.createElement("a")),ja.href=t,e===ja.href}function F_(e){return Object.keys(e).length===0}function j_(e){return e&&ou(e.destroy)?e.destroy:Ci}function wt(e,t){e.appendChild(t)}function gn(e,t,n){e.insertBefore(t,n||null)}function bn(e){e.parentNode.removeChild(e)}function gt(e){return document.createElement(e)}function Bn(e){return document.createTextNode(e)}function xn(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function ie(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function On(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function lu(e,t){e.value=t==null?"":t}function sr(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}let Mo;function Bi(e){Mo=e}const Oi=[],ei=[],Da=[],cu=[],uu=Promise.resolve();let Eo=!1;function du(){Eo||(Eo=!0,uu.then(fu))}function N_(){return du(),uu}function To(e){Da.push(e)}const Ro=new Set;let Ha=0;function fu(){const e=Mo;do{for(;Ha<Oi.length;){const t=Oi[Ha];Ha++,Bi(t),D_(t.$$)}for(Bi(null),Oi.length=0,Ha=0;ei.length;)ei.pop()();for(let t=0;t<Da.length;t+=1){const n=Da[t];Ro.has(n)||(Ro.add(n),n())}Da.length=0}while(Oi.length);for(;cu.length;)cu.pop()();Eo=!1,Ro.clear(),Bi(e)}function D_(e){if(e.fragment!==null){e.update(),Ii(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(To)}}const H_=new Set;function z_(e,t){e&&e.i&&(H_.delete(e),e.i(t))}const P_=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function Li(e,t){e.d(1),t.delete(e.key)}function Fi(e,t,n,r,a,i,s,l,f,u,m,c){let b=e.length,_=i.length,o=b;const B={};for(;o--;)B[e[o].key]=o;const T=[],C=new Map,p=new Map;for(o=_;o--;){const I=c(a,i,o),h=n(I);let M=s.get(h);M?r&&M.p(I,t):(M=u(h,I),M.c()),C.set(h,T[o]=M),h in B&&p.set(h,Math.abs(o-B[h]))}const A=new Set,F=new Set;function R(I){z_(I,1),I.m(l,m),s.set(I.key,I),m=I.first,_--}for(;b&&_;){const I=T[_-1],h=e[b-1],M=I.key,S=h.key;I===h?(m=I.first,b--,_--):C.has(S)?!s.has(M)||A.has(M)?R(I):F.has(S)?b--:p.get(M)>p.get(S)?(F.add(M),R(I)):(A.add(S),b--):(f(h,s),b--)}for(;b--;){const I=e[b];C.has(I.key)||f(I,s)}for(;_;)R(T[_-1]);return T}function V_(e,t,n,r){const{fragment:a,on_mount:i,on_destroy:s,after_update:l}=e.$$;a&&a.m(t,n),r||To(()=>{const f=i.map(au).filter(ou);s?s.push(...f):Ii(f),e.$$.on_mount=[]}),l.forEach(To)}function U_(e,t){const n=e.$$;n.fragment!==null&&(Ii(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function q_(e,t){e.$$.dirty[0]===-1&&(Oi.push(e),du(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function X_(e,t,n,r,a,i,s,l=[-1]){const f=Mo;Bi(e);const u=e.$$={fragment:null,ctx:null,props:i,update:Ci,not_equal:a,bound:su(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:su(),dirty:l,skip_bound:!1,root:t.target||f.$$.root};s&&s(u.root);let m=!1;u.ctx=n?n(e,t.props||{},(c,b,..._)=>{const o=_.length?_[0]:b;return u.ctx&&a(u.ctx[c],u.ctx[c]=o)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](o),m&&q_(e,c)),b}):[],u.update(),m=!0,Ii(u.before_update),u.fragment=r?r(u.ctx):!1,t.target&&(u.fragment&&u.fragment.c(),V_(e,t.target,void 0,void 0),fu()),Bi(f)}class Y_{$destroy(){U_(this,1),this.$destroy=Ci}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const a=r.indexOf(n);a!==-1&&r.splice(a,1)}}$set(t){this.$$set&&!F_(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const mu=[[-1,"\u2728","custom"],[0,"\u{1F600}","smileys-emotion"],[1,"\u{1F44B}","people-body"],[3,"\u{1F431}","animals-nature"],[4,"\u{1F34E}","food-drink"],[5,"\u{1F3E0}\uFE0F","travel-places"],[6,"\u26BD","activities"],[7,"\u{1F4DD}","objects"],[8,"\u26D4\uFE0F","symbols"],[9,"\u{1F3C1}","flags"]].map(([e,t,n])=>({id:e,emoji:t,name:n})),za=mu.slice(1),K_=mu[0],G_=2,hu=6,vu=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function pu(e){return e.unicode.includes("\u200D")}const W_={"\u{1FAE0}":14,"\u{1F972}":13.1,"\u{1F97B}":12.1,"\u{1F970}":11,"\u{1F929}":5,"\u{1F471}\u200D\u2640\uFE0F":4,"\u{1F923}":3,"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":2,"\u{1F600}":1,"\u{1F610}\uFE0F":.7,"\u{1F603}":.6},Z_=1e3,Q_="\u{1F590}\uFE0F",J_=8,$_=["\u{1F60A}","\u{1F612}","\u2665\uFE0F","\u{1F44D}\uFE0F","\u{1F60D}","\u{1F602}","\u{1F62D}","\u263A\uFE0F","\u{1F614}","\u{1F629}","\u{1F60F}","\u{1F495}","\u{1F64C}","\u{1F618}"],_u='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',eg=(e,t)=>e<t?-1:e>t?1:0,gu=(e,t)=>{const n=document.createElement("canvas");n.width=n.height=1;const r=n.getContext("2d");return r.textBaseline="top",r.font=`100px ${_u}`,r.fillStyle=t,r.scale(.01,.01),r.fillText(e,0,0),r.getImageData(0,0,1,1).data},tg=(e,t)=>{const n=[...e].join(","),r=[...t].join(",");return n===r&&!n.startsWith("0,0,0,")};function ng(e){const t=gu(e,"#000"),n=gu(e,"#fff");return t&&n&&tg(t,n)}function rg(){const e=Object.entries(W_);try{for(const[t,n]of e)if(ng(t))return n}catch{}finally{}return e[0][1]}const Co=new Promise(e=>vu(()=>e(rg()))),Io=new Map,ig="\uFE0F",ag="\uD83C",sg="\u200D",og=127995,lg=57339;function cg(e,t){if(t===0)return e;const n=e.indexOf(sg);return n!==-1?e.substring(0,n)+String.fromCodePoint(og+t-1)+e.substring(n):(e.endsWith(ig)&&(e=e.substring(0,e.length-1)),e+ag+String.fromCodePoint(lg+t-1))}function or(e){e.preventDefault(),e.stopPropagation()}function Bo(e,t,n){return t+=e?-1:1,t<0?t=n.length-1:t>=n.length&&(t=0),t}function bu(e,t){const n=new Set,r=[];for(const a of e){const i=t(a);n.has(i)||(n.add(i),r.push(a))}return r}function ug(e,t){const n=r=>{const a={};for(const i of r)typeof i.tone=="number"&&i.version<=t&&(a[i.tone]=i.unicode);return a};return e.map(({unicode:r,skins:a,shortcodes:i,url:s,name:l,category:f})=>({unicode:r,name:l,shortcodes:i,url:s,category:f,id:r||l,skins:a&&n(a),title:(i||[]).join(", ")}))}const Pa=requestAnimationFrame;let dg=typeof ResizeObserver=="function";function fg(e,t){let n;return dg?(n=new ResizeObserver(r=>t(r[0].contentRect.width)),n.observe(e)):Pa(()=>t(e.getBoundingClientRect().width)),{destroy(){n&&n.disconnect()}}}function xu(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}let Oo;function mg(e,t,n){for(const r of e){const a=n(r),i=xu(a);typeof Oo=="undefined"&&(Oo=xu(t));const s=i/1.8<Oo;Io.set(r.unicode,s)}}function hg(e){return bu(e,t=>t)}const{Map:ji}=P_;function yu(e,t,n){const r=e.slice();return r[63]=t[n],r[65]=n,r}function wu(e,t,n){const r=e.slice();return r[66]=t[n],r[65]=n,r}function ku(e,t,n){const r=e.slice();return r[63]=t[n],r[65]=n,r}function Su(e,t,n){const r=e.slice();return r[69]=t[n],r}function Au(e,t,n){const r=e.slice();return r[72]=t[n],r[65]=n,r}function Mu(e,t){let n,r=t[72]+"",a,i,s,l,f,u;return{key:e,first:null,c(){n=gt("div"),a=Bn(r),ie(n,"id",i="skintone-"+t[65]),ie(n,"class",s="emoji hide-focus "+(t[65]===t[20]?"active":"")),ie(n,"aria-selected",l=t[65]===t[20]),ie(n,"role","option"),ie(n,"title",f=t[0].skinTones[t[65]]),ie(n,"tabindex","-1"),ie(n,"aria-label",u=t[0].skinTones[t[65]]),this.first=n},m(m,c){gn(m,n,c),wt(n,a)},p(m,c){t=m,c[0]&512&&r!==(r=t[72]+"")&&On(a,r),c[0]&512&&i!==(i="skintone-"+t[65])&&ie(n,"id",i),c[0]&1049088&&s!==(s="emoji hide-focus "+(t[65]===t[20]?"active":""))&&ie(n,"class",s),c[0]&1049088&&l!==(l=t[65]===t[20])&&ie(n,"aria-selected",l),c[0]&513&&f!==(f=t[0].skinTones[t[65]])&&ie(n,"title",f),c[0]&513&&u!==(u=t[0].skinTones[t[65]])&&ie(n,"aria-label",u)},d(m){m&&bn(n)}}}function Eu(e,t){let n,r,a=t[69].emoji+"",i,s,l,f,u,m,c;function b(){return t[49](t[69])}return{key:e,first:null,c(){n=gt("button"),r=gt("div"),i=Bn(a),ie(r,"class","nav-emoji emoji"),ie(n,"role","tab"),ie(n,"class","nav-button"),ie(n,"aria-controls",s="tab-"+t[69].id),ie(n,"aria-label",l=t[0].categories[t[69].name]),ie(n,"aria-selected",f=!t[4]&&t[13].id===t[69].id),ie(n,"title",u=t[0].categories[t[69].name]),this.first=n},m(_,o){gn(_,n,o),wt(n,r),wt(r,i),m||(c=xn(n,"click",b),m=!0)},p(_,o){t=_,o[0]&4096&&a!==(a=t[69].emoji+"")&&On(i,a),o[0]&4096&&s!==(s="tab-"+t[69].id)&&ie(n,"aria-controls",s),o[0]&4097&&l!==(l=t[0].categories[t[69].name])&&ie(n,"aria-label",l),o[0]&12304&&f!==(f=!t[4]&&t[13].id===t[69].id)&&ie(n,"aria-selected",f),o[0]&4097&&u!==(u=t[0].categories[t[69].name])&&ie(n,"title",u)},d(_){_&&bn(n),m=!1,c()}}}function vg(e){let t,n;return{c(){t=gt("img"),ie(t,"class","custom-emoji"),Na(t.src,n=e[63].url)||ie(t,"src",n),ie(t,"alt",""),ie(t,"loading","lazy")},m(r,a){gn(r,t,a)},p(r,a){a[0]&32768&&!Na(t.src,n=r[63].url)&&ie(t,"src",n)},d(r){r&&bn(t)}}}function pg(e){let t=e[27](e[63],e[8])+"",n;return{c(){n=Bn(t)},m(r,a){gn(r,n,a)},p(r,a){a[0]&33024&&t!==(t=r[27](r[63],r[8])+"")&&On(n,t)},d(r){r&&bn(n)}}}function Tu(e,t){let n,r,a,i,s,l,f;function u(b,_){return b[63].unicode?pg:vg}let m=u(t),c=m(t);return{key:e,first:null,c(){n=gt("button"),c.c(),ie(n,"role",r=t[4]?"option":"menuitem"),ie(n,"aria-selected",a=t[4]?t[65]==t[5]:""),ie(n,"aria-label",i=t[28](t[63],t[8])),ie(n,"title",s=t[63].title),ie(n,"class",l="emoji "+(t[4]&&t[65]===t[5]?"active":"")),ie(n,"id",f="emo-"+t[63].id),this.first=n},m(b,_){gn(b,n,_),c.m(n,null)},p(b,_){t=b,m===(m=u(t))&&c?c.p(t,_):(c.d(1),c=m(t),c&&(c.c(),c.m(n,null))),_[0]&16&&r!==(r=t[4]?"option":"menuitem")&&ie(n,"role",r),_[0]&32816&&a!==(a=t[4]?t[65]==t[5]:"")&&ie(n,"aria-selected",a),_[0]&33024&&i!==(i=t[28](t[63],t[8]))&&ie(n,"aria-label",i),_[0]&32768&&s!==(s=t[63].title)&&ie(n,"title",s),_[0]&32816&&l!==(l="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&ie(n,"class",l),_[0]&32768&&f!==(f="emo-"+t[63].id)&&ie(n,"id",f)},d(b){b&&bn(n),c.d()}}}function Ru(e,t){let n,r=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",a,i,s,l,f=[],u=new ji,m,c,b,_=t[66].emojis;const o=B=>B[63].id;for(let B=0;B<_.length;B+=1){let T=ku(t,_,B),C=o(T);u.set(C,f[B]=Tu(C,T))}return{key:e,first:null,c(){n=gt("div"),a=Bn(r),l=gt("div");for(let B=0;B<f.length;B+=1)f[B].c();ie(n,"id",i="menu-label-"+t[65]),ie(n,"class",s="category "+(t[15].length===1&&t[15][0].category===""?"gone":"")),ie(n,"aria-hidden","true"),ie(l,"class","emoji-menu"),ie(l,"role",m=t[4]?"listbox":"menu"),ie(l,"aria-labelledby",c="menu-label-"+t[65]),ie(l,"id",b=t[4]?"search-results":""),this.first=n},m(B,T){gn(B,n,T),wt(n,a),gn(B,l,T);for(let C=0;C<f.length;C+=1)f[C].m(l,null)},p(B,T){t=B,T[0]&40977&&r!==(r=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&On(a,r),T[0]&32768&&i!==(i="menu-label-"+t[65])&&ie(n,"id",i),T[0]&32768&&s!==(s="category "+(t[15].length===1&&t[15][0].category===""?"gone":""))&&ie(n,"class",s),T[0]&402686256&&(_=t[66].emojis,f=Fi(f,T,o,1,t,_,u,l,Li,Tu,null,ku)),T[0]&16&&m!==(m=t[4]?"listbox":"menu")&&ie(l,"role",m),T[0]&32768&&c!==(c="menu-label-"+t[65])&&ie(l,"aria-labelledby",c),T[0]&16&&b!==(b=t[4]?"search-results":"")&&ie(l,"id",b)},d(B){B&&bn(n),B&&bn(l);for(let T=0;T<f.length;T+=1)f[T].d()}}}function _g(e){let t,n;return{c(){t=gt("img"),ie(t,"class","custom-emoji"),Na(t.src,n=e[63].url)||ie(t,"src",n),ie(t,"alt",""),ie(t,"loading","lazy")},m(r,a){gn(r,t,a)},p(r,a){a[0]&1024&&!Na(t.src,n=r[63].url)&&ie(t,"src",n)},d(r){r&&bn(t)}}}function gg(e){let t=e[27](e[63],e[8])+"",n;return{c(){n=Bn(t)},m(r,a){gn(r,n,a)},p(r,a){a[0]&1280&&t!==(t=r[27](r[63],r[8])+"")&&On(n,t)},d(r){r&&bn(n)}}}function Cu(e,t){let n,r,a,i;function s(u,m){return u[63].unicode?gg:_g}let l=s(t),f=l(t);return{key:e,first:null,c(){n=gt("button"),f.c(),ie(n,"role","menuitem"),ie(n,"aria-label",r=t[28](t[63],t[8])),ie(n,"title",a=t[63].title),ie(n,"class","emoji"),ie(n,"id",i="fav-"+t[63].id),this.first=n},m(u,m){gn(u,n,m),f.m(n,null)},p(u,m){t=u,l===(l=s(t))&&f?f.p(t,m):(f.d(1),f=l(t),f&&(f.c(),f.m(n,null))),m[0]&1280&&r!==(r=t[28](t[63],t[8]))&&ie(n,"aria-label",r),m[0]&1024&&a!==(a=t[63].title)&&ie(n,"title",a),m[0]&1024&&i!==(i="fav-"+t[63].id)&&ie(n,"id",i)},d(u){u&&bn(n),f.d()}}}function bg(e){let t,n,r,a,i,s,l,f,u,m=e[0].searchLabel+"",c,b,_=e[0].searchDescription+"",o,B,T,C,p,A,F,R=e[0].skinToneDescription+"",I,h,M=[],S=new ji,v,y,x,w,k,g=[],D=new ji,Y,z,U,d,E,W,O,me,Se=[],_e=new ji,pe,De,Ce,he,Ue,rt=[],P=new ji,X,ne,ce,de,Ae,Ee,ye=e[9];const Me=ue=>ue[72];for(let ue=0;ue<ye.length;ue+=1){let we=Au(e,ye,ue),ee=Me(we);S.set(ee,M[ue]=Mu(ee,we))}let ge=e[12];const ze=ue=>ue[69].id;for(let ue=0;ue<ge.length;ue+=1){let we=Su(e,ge,ue),ee=ze(we);D.set(ee,g[ue]=Eu(ee,we))}let je=e[15];const Pe=ue=>ue[66].category;for(let ue=0;ue<je.length;ue+=1){let we=wu(e,je,ue),ee=Pe(we);_e.set(ee,Se[ue]=Ru(ee,we))}let Ve=e[10];const Ge=ue=>ue[63].id;for(let ue=0;ue<Ve.length;ue+=1){let we=yu(e,Ve,ue),ee=Ge(we);P.set(ee,rt[ue]=Cu(ee,we))}return{c(){t=gt("section"),n=gt("div"),r=gt("div"),a=gt("div"),i=gt("input"),u=gt("label"),c=Bn(m),b=gt("span"),o=Bn(_),B=gt("div"),T=gt("button"),C=Bn(e[21]),F=gt("span"),I=Bn(R),h=gt("div");for(let ue=0;ue<M.length;ue+=1)M[ue].c();k=gt("div");for(let ue=0;ue<g.length;ue+=1)g[ue].c();z=gt("div"),U=gt("div"),d=gt("div"),E=Bn(e[18]),O=gt("div"),me=gt("div");for(let ue=0;ue<Se.length;ue+=1)Se[ue].c();Ue=gt("div");for(let ue=0;ue<rt.length;ue+=1)rt[ue].c();ce=gt("button"),ce.textContent="\u{1F600}",ie(n,"class","pad-top"),ie(i,"id","search"),ie(i,"class","search"),ie(i,"type","search"),ie(i,"role","combobox"),ie(i,"enterkeyhint","search"),ie(i,"placeholder",s=e[0].searchLabel),ie(i,"autocapitalize","none"),ie(i,"autocomplete","off"),ie(i,"spellcheck","true"),ie(i,"aria-expanded",l=!!(e[4]&&e[1].length)),ie(i,"aria-controls","search-results"),ie(i,"aria-describedby","search-description"),ie(i,"aria-autocomplete","list"),ie(i,"aria-activedescendant",f=e[26]?`emo-${e[26]}`:""),ie(u,"class","sr-only"),ie(u,"for","search"),ie(b,"id","search-description"),ie(b,"class","sr-only"),ie(a,"class","search-wrapper"),ie(T,"id","skintone-button"),ie(T,"class",p="emoji "+(e[6]?"hide-focus":"")),ie(T,"aria-label",e[23]),ie(T,"title",e[23]),ie(T,"aria-describedby","skintone-description"),ie(T,"aria-haspopup","listbox"),ie(T,"aria-expanded",e[6]),ie(T,"aria-controls","skintone-list"),ie(B,"class",A="skintone-button-wrapper "+(e[19]?"expanded":"")),ie(F,"id","skintone-description"),ie(F,"class","sr-only"),ie(h,"id","skintone-list"),ie(h,"class",v="skintone-list "+(e[6]?"":"hidden no-animate")),sr(h,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),ie(h,"role","listbox"),ie(h,"aria-label",y=e[0].skinTonesLabel),ie(h,"aria-activedescendant",x="skintone-"+e[20]),ie(h,"aria-hidden",w=!e[6]),ie(r,"class","search-row"),ie(k,"class","nav"),ie(k,"role","tablist"),sr(k,"grid-template-columns","repeat("+e[12].length+", 1fr)"),ie(k,"aria-label",Y=e[0].categoriesLabel),ie(U,"class","indicator"),sr(U,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),ie(z,"class","indicator-wrapper"),ie(d,"class",W="message "+(e[18]?"":"gone")),ie(d,"role","alert"),ie(d,"aria-live","polite"),ie(O,"class",pe="tabpanel "+(!e[14]||e[18]?"gone":"")),ie(O,"role",De=e[4]?"region":"tabpanel"),ie(O,"aria-label",Ce=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),ie(O,"id",he=e[4]?"":`tab-${e[13].id}`),ie(O,"tabindex","0"),ie(Ue,"class",X="favorites emoji-menu "+(e[18]?"gone":"")),ie(Ue,"role","menu"),ie(Ue,"aria-label",ne=e[0].favoritesLabel),sr(Ue,"padding-inline-end",e[25]+"px"),ie(ce,"aria-hidden","true"),ie(ce,"tabindex","-1"),ie(ce,"class","abs-pos hidden emoji"),ie(t,"class","picker"),ie(t,"aria-label",de=e[0].regionLabel),ie(t,"style",e[22])},m(ue,we){gn(ue,t,we),wt(t,n),wt(t,r),wt(r,a),wt(a,i),lu(i,e[2]),wt(a,u),wt(u,c),wt(a,b),wt(b,o),wt(r,B),wt(B,T),wt(T,C),wt(r,F),wt(F,I),wt(r,h);for(let ee=0;ee<M.length;ee+=1)M[ee].m(h,null);e[48](h),wt(t,k);for(let ee=0;ee<g.length;ee+=1)g[ee].m(k,null);wt(t,z),wt(z,U),wt(t,d),wt(d,E),wt(t,O),wt(O,me);for(let ee=0;ee<Se.length;ee+=1)Se[ee].m(me,null);e[50](O),wt(t,Ue);for(let ee=0;ee<rt.length;ee+=1)rt[ee].m(Ue,null);wt(t,ce),e[51](ce),e[52](t),Ae||(Ee=[xn(i,"input",e[47]),xn(i,"keydown",e[30]),xn(T,"click",e[35]),xn(h,"focusout",e[38]),xn(h,"click",e[34]),xn(h,"keydown",e[36]),xn(h,"keyup",e[37]),xn(k,"keydown",e[32]),j_(e[29].call(null,me)),xn(O,"click",e[33]),xn(Ue,"click",e[33])],Ae=!0)},p(ue,we){we[0]&1&&s!==(s=ue[0].searchLabel)&&ie(i,"placeholder",s),we[0]&18&&l!==(l=!!(ue[4]&&ue[1].length))&&ie(i,"aria-expanded",l),we[0]&67108864&&f!==(f=ue[26]?`emo-${ue[26]}`:"")&&ie(i,"aria-activedescendant",f),we[0]&4&&lu(i,ue[2]),we[0]&1&&m!==(m=ue[0].searchLabel+"")&&On(c,m),we[0]&1&&_!==(_=ue[0].searchDescription+"")&&On(o,_),we[0]&2097152&&On(C,ue[21]),we[0]&64&&p!==(p="emoji "+(ue[6]?"hide-focus":""))&&ie(T,"class",p),we[0]&8388608&&ie(T,"aria-label",ue[23]),we[0]&8388608&&ie(T,"title",ue[23]),we[0]&64&&ie(T,"aria-expanded",ue[6]),we[0]&524288&&A!==(A="skintone-button-wrapper "+(ue[19]?"expanded":""))&&ie(B,"class",A),we[0]&1&&R!==(R=ue[0].skinToneDescription+"")&&On(I,R),we[0]&1049089&&(ye=ue[9],M=Fi(M,we,Me,1,ue,ye,S,h,Li,Mu,null,Au)),we[0]&64&&v!==(v="skintone-list "+(ue[6]?"":"hidden no-animate"))&&ie(h,"class",v),we[0]&64&&sr(h,"transform","translateY("+(ue[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),we[0]&1&&y!==(y=ue[0].skinTonesLabel)&&ie(h,"aria-label",y),we[0]&1048576&&x!==(x="skintone-"+ue[20])&&ie(h,"aria-activedescendant",x),we[0]&64&&w!==(w=!ue[6])&&ie(h,"aria-hidden",w),we[0]&12305|we[1]&1&&(ge=ue[12],g=Fi(g,we,ze,1,ue,ge,D,k,Li,Eu,null,Su)),we[0]&4096&&sr(k,"grid-template-columns","repeat("+ue[12].length+", 1fr)"),we[0]&1&&Y!==(Y=ue[0].categoriesLabel)&&ie(k,"aria-label",Y),we[0]&16779264&&sr(U,"transform","translateX("+(ue[24]?-1:1)*ue[11]*100+"%)"),we[0]&262144&&On(E,ue[18]),we[0]&262144&&W!==(W="message "+(ue[18]?"":"gone"))&&ie(d,"class",W),we[0]&402694449&&(je=ue[15],Se=Fi(Se,we,Pe,1,ue,je,_e,me,Li,Ru,null,wu)),we[0]&278528&&pe!==(pe="tabpanel "+(!ue[14]||ue[18]?"gone":""))&&ie(O,"class",pe),we[0]&16&&De!==(De=ue[4]?"region":"tabpanel")&&ie(O,"role",De),we[0]&8209&&Ce!==(Ce=ue[4]?ue[0].searchResultsLabel:ue[0].categories[ue[13].name])&&ie(O,"aria-label",Ce),we[0]&8208&&he!==(he=ue[4]?"":`tab-${ue[13].id}`)&&ie(O,"id",he),we[0]&402654464&&(Ve=ue[10],rt=Fi(rt,we,Ge,1,ue,Ve,P,Ue,Li,Cu,null,yu)),we[0]&262144&&X!==(X="favorites emoji-menu "+(ue[18]?"gone":""))&&ie(Ue,"class",X),we[0]&1&&ne!==(ne=ue[0].favoritesLabel)&&ie(Ue,"aria-label",ne),we[0]&33554432&&sr(Ue,"padding-inline-end",ue[25]+"px"),we[0]&1&&de!==(de=ue[0].regionLabel)&&ie(t,"aria-label",de),we[0]&4194304&&ie(t,"style",ue[22])},i:Ci,o:Ci,d(ue){ue&&bn(t);for(let we=0;we<M.length;we+=1)M[we].d();e[48](null);for(let we=0;we<g.length;we+=1)g[we].d();for(let we=0;we<Se.length;we+=1)Se[we].d();e[50](null);for(let we=0;we<rt.length;we+=1)rt[we].d();e[51](null),e[52](null),Ae=!1,Ii(Ee)}}}function xg(e,t,n){let{skinToneEmoji:r}=t,{i18n:a}=t,{database:i}=t,{customEmoji:s}=t,{customCategorySorting:l}=t,f=!0,u=[],m=[],c="",b="",_,o,B,T=!1,C=-1,p,A=!1,F=!1,R,I=0,h=0,M,S,v="",y=[],x=[],w,k=J_,g=!1,D=0,Y=0,z=za,U,d=!1,E;const W=ee=>{_.getRootNode().getElementById(ee).focus()},O=(ee,Be)=>{_.dispatchEvent(new CustomEvent(ee,{detail:Be,bubbles:!0,composed:!0}))},me=(ee,Be)=>Be&&ee.skins&&ee.skins[Be]||ee.unicode,Se=(ee,Be)=>hg([ee.name||me(ee,Be),...ee.shortcodes||[]]).join(", "),_e=ee=>/^skintone-/.test(ee.id);Co.then(ee=>{ee||n(18,p=a.emojiUnsupportedMessage)});function pe(ee){return fg(ee,Be=>{{const L=getComputedStyle(_),N=parseInt(L.getPropertyValue("--num-columns"),10),V=L.getPropertyValue("direction")==="rtl",K=ee.parentElement.getBoundingClientRect().width-Be;n(46,k=N),n(25,D=K),n(24,g=V)}})}function De(ee){const Be=_.getRootNode();mg(ee,o,N=>Be.getElementById(`emo-${N.id}`)),n(1,u=u)}function Ce(ee){return!ee.unicode||!pu(ee)||Io.get(ee.unicode)}async function he(ee){const Be=await Co;return ee.filter(({version:L})=>!L||L<=Be)}async function Ue(ee){return ug(ee,await Co)}async function rt(ee){if(typeof ee=="undefined")return[];const Be=ee===-1?s:await i.getEmojiByGroup(ee);return Ue(await he(Be))}async function P(ee){return Ue(await he(await i.getEmojiBySearchQuery(ee)))}function X(ee){if(!T||!u.length)return;const Be=L=>{or(ee),n(5,C=Bo(L,C,u))};switch(ee.key){case"ArrowDown":return Be(!1);case"ArrowUp":return Be(!0);case"Enter":if(C!==-1)return or(ee),de(u[C].id);u.length&&n(5,C=0)}}function ne(ee){n(2,c=""),n(44,b=""),n(5,C=-1),n(11,Y=z.findIndex(Be=>Be.id===ee.id))}function ce(ee){const{target:Be,key:L}=ee,N=V=>{V&&(or(ee),V.focus())};switch(L){case"ArrowLeft":return N(Be.previousSibling);case"ArrowRight":return N(Be.nextSibling);case"Home":return N(Be.parentElement.firstChild);case"End":return N(Be.parentElement.lastChild)}}async function de(ee){const Be=await i.getEmojiByUnicodeOrName(ee),L=[...u,...x].find(V=>V.id===ee),N=L.unicode&&me(L,I);await i.incrementFavoriteEmojiCount(ee),O("emoji-click",{emoji:Be,skinTone:I,...N&&{unicode:N},...L.name&&{name:L.name}})}async function Ae(ee){const{target:Be}=ee;if(!Be.classList.contains("emoji"))return;or(ee);const L=Be.id.substring(4);de(L)}async function Ee(ee){const{target:Be}=ee;if(!_e(Be))return;or(ee);const L=parseInt(Be.id.slice(9),10);n(8,I=L),n(6,A=!1),W("skintone-button"),O("skin-tone-change",{skinTone:L}),i.setPreferredSkinTone(L)}async function ye(ee){n(6,A=!A),n(20,h=I),A&&(or(ee),Pa(()=>W(`skintone-${h}`)))}function Me(ee){if(!A)return;const Be=async L=>{or(ee),n(20,h=L),await N_(),W(`skintone-${h}`)};switch(ee.key){case"ArrowUp":return Be(Bo(!0,h,y));case"ArrowDown":return Be(Bo(!1,h,y));case"Home":return Be(0);case"End":return Be(y.length-1);case"Enter":return Ee(ee);case"Escape":return or(ee),n(6,A=!1),W("skintone-button")}}function ge(ee){if(!!A)switch(ee.key){case" ":return Ee(ee)}}async function ze(ee){const{relatedTarget:Be}=ee;(!Be||!_e(Be))&&n(6,A=!1)}function je(){c=this.value,n(2,c)}function Pe(ee){ei[ee?"unshift":"push"](()=>{R=ee,n(7,R)})}const Ve=ee=>ne(ee);function Ge(ee){ei[ee?"unshift":"push"](()=>{B=ee,n(3,B)})}function ue(ee){ei[ee?"unshift":"push"](()=>{o=ee,n(17,o)})}function we(ee){ei[ee?"unshift":"push"](()=>{_=ee,n(16,_)})}return e.$$set=ee=>{"skinToneEmoji"in ee&&n(40,r=ee.skinToneEmoji),"i18n"in ee&&n(0,a=ee.i18n),"database"in ee&&n(39,i=ee.database),"customEmoji"in ee&&n(41,s=ee.customEmoji),"customCategorySorting"in ee&&n(42,l=ee.customCategorySorting)},e.$$.update=()=>{if(e.$$.dirty[1]&1280&&s&&i&&n(39,i.customEmoji=s,i),e.$$.dirty[0]&1|e.$$.dirty[1]&256){async function ee(){let Be=!1;const L=setTimeout(()=>{Be=!0,n(18,p=a.loadingMessage)},Z_);try{await i.ready(),n(14,d=!0)}catch(N){console.error(N),n(18,p=a.networkErrorMessage)}finally{clearTimeout(L),Be&&(Be=!1,n(18,p=""))}}i&&ee()}if(e.$$.dirty[0]&6144|e.$$.dirty[1]&1024&&(s&&s.length?n(12,z=[K_,...za]):z!==za&&(Y&&n(11,Y--,Y),n(12,z=za))),e.$$.dirty[0]&4&&vu(()=>{n(44,b=(c||"").trim()),n(5,C=-1)}),e.$$.dirty[0]&6144&&n(13,U=z[Y]),e.$$.dirty[0]&24576|e.$$.dirty[1]&8192){async function ee(){if(!d)n(1,u=[]),n(4,T=!1);else if(b.length>=G_){const Be=b,L=await P(Be);Be===b&&(n(1,u=L),n(4,T=!0))}else if(U){const Be=U.id,L=await rt(Be);Be===U.id&&(n(1,u=L),n(4,T=!1))}}ee()}if(e.$$.dirty[0]&4112&&n(22,S=`
  --font-family: ${_u};
  --num-groups: ${z.length}; 
  --indicator-opacity: ${T?0:1}; 
  --num-skintones: ${hu};`),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function ee(){d&&n(8,I=await i.getPreferredSkinTone())}ee()}if(e.$$.dirty[1]&512&&n(9,y=Array(hu).fill().map((ee,Be)=>cg(r,Be))),e.$$.dirty[0]&768&&n(21,M=y[I]),e.$$.dirty[0]&257&&n(23,v=a.skinToneLabel.replace("{skinTone}",a.skinTones[I])),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function ee(){n(45,w=(await Promise.all($_.map(Be=>i.getEmojiByUnicodeOrName(Be)))).filter(Boolean))}d&&ee()}if(e.$$.dirty[0]&16384|e.$$.dirty[1]&49408){async function ee(){const Be=await i.getTopFavoriteEmoji(k),L=await Ue(bu([...Be,...w],N=>N.unicode||N.name).slice(0,k));n(10,x=L)}d&&w&&ee()}if(e.$$.dirty[0]&10){const ee=u.filter(Be=>Be.unicode).filter(Be=>pu(Be)&&!Io.has(Be.unicode));ee.length?Pa(()=>De(ee)):(n(1,u=u.filter(Ce)),Pa(()=>{(B||{}).scrollTop=0}))}e.$$.dirty[0]&1026|e.$$.dirty[1]&4096,e.$$.dirty[0]&18|e.$$.dirty[1]&2048&&n(15,m=function(){if(T)return[{category:"",emojis:u}];const Be=new Map;for(const L of u){const N=L.category||"";let V=Be.get(N);V||(V=[],Be.set(N,V)),V.push(L)}return[...Be.entries()].map(([L,N])=>({category:L,emojis:N})).sort((L,N)=>l(L.category,N.category))}()),e.$$.dirty[0]&34&&n(26,E=C!==-1&&u[C].id),e.$$.dirty[0]&192&&(A?R.addEventListener("transitionend",()=>{n(19,F=!0)},{once:!0}):n(19,F=!1))},[a,u,c,B,T,C,A,R,I,y,x,Y,z,U,d,m,_,o,p,F,h,M,S,v,g,D,E,me,Se,pe,X,ne,ce,Ae,Ee,ye,Me,ge,ze,i,r,s,l,f,b,w,k,je,Pe,Ve,Ge,ue,we]}class yg extends Y_{constructor(t){super(),X_(this,t,xg,bg,L_,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const wg="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",kg="en";var Sg={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading\u2026",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Iu=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class Bu extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"});const n=document.createElement("style");n.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(n),this._ctx={locale:kg,dataSource:wg,skinToneEmoji:Q_,customCategorySorting:eg,customEmoji:null,i18n:Sg,...t};for(const r of Iu)r!=="database"&&Object.prototype.hasOwnProperty.call(this,r)&&(this._ctx[r]=this[r],delete this[r]);this._dbFlush()}connectedCallback(){this._cmp=new yg({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:t}=this._ctx;t&&t.close().catch(n=>console.error(n))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(t,n,r){this._set(t.replace(/-([a-z])/g,(a,i)=>i.toUpperCase()),r)}_set(t,n){this._ctx[t]=n,this._cmp&&this._cmp.$set({[t]:n}),["locale","dataSource"].includes(t)&&this._dbFlush()}_dbCreate(){const{locale:t,dataSource:n,database:r}=this._ctx;(!r||r.locale!==t||r.dataSource!==n)&&this._set("database",new iu({locale:t,dataSource:n}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const Ou={};for(const e of Iu)Ou[e]={get(){return e==="database"&&this._dbCreate(),this._ctx[e]},set(t){if(e==="database")throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(Bu.prototype,Ou),customElements.get("emoji-picker")||customElements.define("emoji-picker",Bu);function Lu(e,t){for(;e&&!e.querySelector(t);){e=e.parentNode;const n=e.querySelector(t);if(n)return n}return null}const Ag={name:"EmojiPickerContainer",components:{SvgIcon:Dt},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0}},emits:["add-emoji","open-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:t})=>{this.$emit("add-emoji",{unicode:t.unicode})})},0)}},methods:{addCustomStyling(){const e=`.picker {
				border: none;
			}`,t=`.nav {
				overflow-x: auto;
			}`,n=`.search-wrapper {
				padding-right: 2px;
				padding-left: 2px;
			}`,r=`input.search {
				height: 32px;
				font-size: 14px;
				border-radius: 10rem;
				border: var(--chat-border-style);
				padding: 5px 10px;
				outline: none;
				background: var(--chat-bg-color-input);
				color: var(--chat-color);
			}`,a=document.createElement("style");a.textContent=e+t+n+r,this.$refs.emojiPicker.shadowRoot.appendChild(a)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},setEmojiPickerPosition(e,t,n){const r=t<500||n<700,a=Lu(this.$el,"#room-footer");if(!a){r&&(this.emojiPickerRight="-50px");return}r?(this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=n-200):(a.getBoundingClientRect().top-e>this.emojiPickerHeight-50?this.emojiPickerTop=e+10:this.emojiPickerTop=e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":"")}}},Mg={class:"vac-emoji-wrapper"};function Eg(e,t,n,r,a,i){const s=Xe("svg-icon"),l=Xe("emoji-picker");return Q(),se("div",Mg,[ke("div",{class:nt(["vac-svg-button",{"vac-emoji-reaction":n.emojiReaction}]),onClick:t[0]||(t[0]=(...f)=>i.openEmoji&&i.openEmoji(...f))},[Re(e.$slots,n.messageId?"emoji-picker-reaction-icon_"+n.messageId:"emoji-picker-icon",{},()=>[Oe(s,{name:"emoji",param:n.emojiReaction?"reaction":""},null,8,["param"])])],2),n.emojiOpened?(Q(),dt(It,{key:0,name:"vac-slide-up",appear:""},{default:Ke(()=>[ke("div",{class:nt(["vac-emoji-picker",{"vac-picker-reaction":n.emojiReaction}]),style:St({height:`${a.emojiPickerHeight}px`,top:n.positionTop?a.emojiPickerHeight:`${a.emojiPickerTop}px`,right:a.emojiPickerRight,display:a.emojiPickerTop||!n.emojiReaction?"initial":"none"})},[n.emojiOpened?(Q(),dt(l,{key:0,ref:"emojiPicker","data-source":n.emojiDataSource},null,8,["data-source"])):Te("",!0)],6)]),_:1})):Te("",!0)])}var Fu=xt(Ag,[["render",Eg]]);const Tg={name:"RoomFiles",components:{Loader:ki,SvgIcon:Dt},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return Zr(this.file)},isVideo(){return Ti(this.file)}}},Rg={class:"vac-room-file-container"},Cg=["src"],Ig={class:"vac-text-ellipsis"},Bg={key:0,class:"vac-text-ellipsis vac-text-extension"};function Og(e,t,n,r,a,i){const s=Xe("loader"),l=Xe("svg-icon");return Q(),se("div",Rg,[Oe(s,{show:n.file.loading,type:"room-file"},_t({_:2},[$e(e.$slots,(f,u)=>({name:u,fn:Ke(m=>[Re(e.$slots,u,pt(vt(m)))])}))]),1032,["show"]),ke("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=f=>e.$emit("remove-file",n.index))},[Re(e.$slots,"image-close-icon",{},()=>[Oe(l,{name:"close",param:"image"})])]),i.isImage?(Q(),se("div",{key:0,class:nt(["vac-message-image",{"vac-blur-loading":n.file.loading}]),style:St({"background-image":`url('${n.file.localUrl||n.file.url}')`})},null,6)):i.isVideo?(Q(),se("video",{key:1,controls:"",class:nt({"vac-blur-loading":n.file.loading})},[ke("source",{src:n.file.localUrl||n.file.url},null,8,Cg)],2)):(Q(),se("div",{key:2,class:nt(["vac-file-container",{"vac-blur-loading":n.file.loading}])},[ke("div",null,[Re(e.$slots,"file-icon",{},()=>[Oe(l,{name:"file"})])]),ke("div",Ig,Qe(n.file.name),1),n.file.extension?(Q(),se("div",Bg,Qe(n.file.extension),1)):Te("",!0)],2))])}var Lg=xt(Tg,[["render",Og]]);const Fg={name:"RoomFiles",components:{SvgIcon:Dt,RoomFile:Lg},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},jg={key:0,class:"vac-room-files-container"},Ng={class:"vac-files-box"},Dg={class:"vac-icon-close"};function Hg(e,t,n,r,a,i){const s=Xe("room-file"),l=Xe("svg-icon");return Q(),dt(It,{name:"vac-slide-up"},{default:Ke(()=>[n.files.length?(Q(),se("div",jg,[ke("div",Ng,[(Q(!0),se(st,null,$e(n.files,(f,u)=>(Q(),se("div",{key:u},[Oe(s,{file:f,index:u,onRemoveFile:t[0]||(t[0]=m=>e.$emit("remove-file",m))},_t({_:2},[$e(e.$slots,(m,c)=>({name:c,fn:Ke(b=>[Re(e.$slots,c,pt(vt(b)))])}))]),1032,["file","index"])]))),128))]),ke("div",Dg,[ke("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=f=>e.$emit("reset-message"))},[Re(e.$slots,"files-close-icon",{},()=>[Oe(l,{name:"close-outline"})])])])])):Te("",!0)]),_:3})}var zg=xt(Fg,[["render",Hg]]);const Pg={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const n=t.getBoundingClientRect().width,r=t.getBoundingClientRect().left;let a=(e.clientX-r)/n;return a=a<0?0:a,a=a>1?1:a,a}}},Vg={class:"vac-player-progress"},Ug={class:"vac-line-container"};function qg(e,t,n,r,a,i){return Q(),se("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...s)=>i.onMouseDown&&i.onMouseDown(...s)),onMouseover:t[1]||(t[1]=s=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=s=>e.$emit("hover-audio-progress",!1))},[ke("div",Vg,[ke("div",Ug,[ke("div",{class:"vac-line-progress",style:St({width:`${n.percentage}%`})},null,4),ke("div",{class:nt(["vac-line-dot",{"vac-line-dot__active":a.isMouseDown}]),style:St({left:`${n.percentage}%`})},null,6)])])],544)}var Xg=xt(Pg,[["render",qg]]);const Yg={name:"AudioPlayer",components:{SvgIcon:Dt,AudioControl:Xg},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(e*1e3).toISOString().substr(14,5)},playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},Kg={class:"vac-audio-player"},Gg=["id","src"];function Wg(e,t,n,r,a,i){const s=Xe("svg-icon"),l=Xe("audio-control");return Q(),se("div",null,[ke("div",Kg,[ke("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...f)=>i.playback&&i.playback(...f))},[a.isPlaying?Re(e.$slots,"audio-pause-icon_"+n.messageId,{key:0},()=>[Oe(s,{name:"audio-pause"})]):Re(e.$slots,"audio-play-icon_"+n.messageId,{key:1},()=>[Oe(s,{name:"audio-play"})])]),Oe(l,{percentage:a.progress,"message-selection-enabled":n.messageSelectionEnabled,onChangeLinehead:i.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=f=>e.$emit("hover-audio-progress",f))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),ke("audio",{id:i.playerUniqId,src:i.audioSource},null,8,Gg)])])}var Lo=xt(Yg,[["render",Wg]]);const Zg={name:"RoomMessageReply",components:{SvgIcon:Dt,FormatMessage:Mi,AudioPlayer:Lo},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(t=(e=this.messageReply)==null?void 0:e.files)!=null&&t.length?this.messageReply.files[0]:{}},isImage(){return Zr(this.firstFile)},isVideo(){return Ti(this.firstFile)},isAudio(){return Ra(this.firstFile)},isOtherFile(){var e,t;return((t=(e=this.messageReply)==null?void 0:e.files)==null?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},Qg={key:0,class:"vac-reply-container"},Jg={class:"vac-reply-box"},$g={class:"vac-reply-info"},e3={class:"vac-reply-username"},t3={class:"vac-reply-content"},n3=["src"],r3={key:1,controls:"",class:"vac-image-reply"},i3=["src"],a3={key:3,class:"vac-image-reply vac-file-container"},s3={class:"vac-text-ellipsis"},o3={key:0,class:"vac-text-ellipsis vac-text-extension"},l3={class:"vac-icon-reply"};function c3(e,t,n,r,a,i){const s=Xe("format-message"),l=Xe("audio-player"),f=Xe("svg-icon");return Q(),dt(It,{name:"vac-slide-up"},{default:Ke(()=>[n.messageReply?(Q(),se("div",Qg,[ke("div",Jg,[ke("div",$g,[ke("div",e3,Qe(n.messageReply.username),1),ke("div",t3,[Oe(s,{"message-id":n.messageReply._id,content:n.messageReply.content,users:n.room.users,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),i.isImage?(Q(),se("img",{key:0,src:i.firstFile.url,class:"vac-image-reply"},null,8,n3)):i.isVideo?(Q(),se("video",r3,[ke("source",{src:i.firstFile.url},null,8,i3)])):i.isAudio?(Q(),dt(l,{key:2,src:i.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["src"])):i.isOtherFile?(Q(),se("div",a3,[ke("div",null,[Re(e.$slots,"file-icon",{},()=>[Oe(f,{name:"file"})])]),ke("div",s3,Qe(i.firstFile.name),1),i.firstFile.extension?(Q(),se("div",o3,Qe(i.firstFile.extension),1)):Te("",!0)])):Te("",!0)]),ke("div",l3,[ke("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=u=>e.$emit("reset-message"))},[Re(e.$slots,"reply-close-icon",{},()=>[Oe(f,{name:"close-outline"})])])])])):Te("",!0)]),_:3})}var u3=xt(Zg,[["render",c3]]);const d3={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},f3={key:0,class:"vac-tags-container"},m3=["onMouseover","onClick"],h3={class:"vac-tags-info"},v3={class:"vac-tags-username"};function p3(e,t,n,r,a,i){return Q(),dt(It,{name:"vac-slide-up"},{default:Ke(()=>[n.filteredUsersTag.length?(Q(),se("div",f3,[(Q(!0),se(st,null,$e(n.filteredUsersTag,(s,l)=>(Q(),se("div",{key:s._id,class:nt(["vac-tags-box",{"vac-tags-box-active":l===a.activeItem}]),onMouseover:f=>a.activeItem=l,onClick:f=>e.$emit("select-user-tag",s)},[ke("div",h3,[s.avatar?(Q(),se("div",{key:0,class:"vac-avatar vac-tags-avatar",style:St({"background-image":`url('${s.avatar}')`})},null,4)):Te("",!0),ke("div",v3,Qe(s.username),1)])],42,m3))),128))])):Te("",!0)]),_:1})}var _3=xt(d3,[["render",p3]]);const g3={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},b3={key:0,class:"vac-emojis-container"},x3=["onMouseover","onClick"];function y3(e,t,n,r,a,i){return Q(),dt(It,{name:"vac-slide-up"},{default:Ke(()=>[n.filteredEmojis.length?(Q(),se("div",b3,[(Q(!0),se(st,null,$e(n.filteredEmojis,(s,l)=>(Q(),se("div",{key:s,class:nt(["vac-emoji-element",{"vac-emoji-element-active":l===a.activeItem}]),onMouseover:f=>a.activeItem=l,onClick:f=>e.$emit("select-emoji",s)},Qe(s),43,x3))),128))])):Te("",!0)]),_:1})}var w3=xt(g3,[["render",y3]]);const k3={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},S3={key:0,class:"vac-template-container vac-app-box-shadow"},A3=["onMouseover","onClick"],M3={class:"vac-template-info"},E3={class:"vac-template-tag"},T3={class:"vac-template-text"};function R3(e,t,n,r,a,i){return Q(),dt(It,{name:"vac-slide-up"},{default:Ke(()=>[n.filteredTemplatesText.length?(Q(),se("div",S3,[(Q(!0),se(st,null,$e(n.filteredTemplatesText,(s,l)=>(Q(),se("div",{key:l,class:nt(["vac-template-box",{"vac-template-active":l===a.activeItem}]),onMouseover:f=>a.activeItem=l,onClick:f=>e.$emit("select-template-text",s)},[ke("div",M3,[ke("div",E3," /"+Qe(s.tag),1),ke("div",T3,Qe(s.text),1)])],42,A3))),128))])):Te("",!0)]),_:1})}var C3=xt(k3,[["render",R3]]);function I3(e){return new Int8Array(e)}function ju(e){return new Int16Array(e)}function Nu(e){return new Int32Array(e)}function Du(e){return new Float32Array(e)}function B3(e){return new Float64Array(e)}function Hu(e){if(e.length==1)return Du(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(Hu(e));return n}function zu(e){if(e.length==1)return Nu(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(zu(e));return n}function Pu(e){if(e.length==1)return ju(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(Pu(e));return n}function Vu(e){if(e.length==1)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(Vu(e));return n}var Uu={};Uu.fill=function(e,t,n,r){if(arguments.length==2)for(var a=0;a<e.length;a++)e[a]=arguments[1];else for(var a=t;a<n;a++)e[a]=r};var Ni={};Ni.arraycopy=function(e,t,n,r,a){for(var i=t+a;t<i;)n[r++]=e[t++]},Ni.out={},Ni.out.println=function(e){console.log(e)},Ni.out.printf=function(){console.log.apply(console,arguments)};var Va={};Va.SQRT2=1.4142135623730951,Va.FAST_LOG10=function(e){return Math.log10(e)},Va.FAST_LOG10_X=function(e,t){return Math.log10(e)*t};function Gn(e){this.ordinal=e}Gn.short_block_allowed=new Gn(0),Gn.short_block_coupled=new Gn(1),Gn.short_block_dispensed=new Gn(2),Gn.short_block_forced=new Gn(3);var qu={};qu.MAX_VALUE=34028235e31;function sn(e){this.ordinal=e}sn.vbr_off=new sn(0),sn.vbr_mt=new sn(1),sn.vbr_rh=new sn(2),sn.vbr_abr=new sn(3),sn.vbr_mtrh=new sn(4),sn.vbr_default=sn.vbr_mtrh;var O3=function(e){},Ie={System:Ni,VbrMode:sn,Float:qu,ShortBlock:Gn,Util:Va,Arrays:Uu,new_array_n:Vu,new_byte:I3,new_double:B3,new_float:Du,new_float_n:Hu,new_int:Nu,new_int_n:zu,new_short:ju,new_short_n:Pu,assert:O3},L3=Ie.System,Rt=Ie.Util,F3=Ie.Arrays,j3=Ie.new_float;function N3(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Rt.SQRT2*.5/2384e-9,.017876148*Rt.SQRT2*.5/2384e-9,.003134727*Rt.SQRT2*.5/2384e-9,.002457142*Rt.SQRT2*.5/2384e-9,971317e-9*Rt.SQRT2*.5/2384e-9,218868e-9*Rt.SQRT2*.5/2384e-9,101566e-9*Rt.SQRT2*.5/2384e-9,13828e-9*Rt.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,n=36,r=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],a=r[j.SHORT_TYPE],i=r[j.SHORT_TYPE],s=r[j.SHORT_TYPE],l=r[j.SHORT_TYPE],f=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function u(b,_,o){for(var B=10,T=_+238-14-286,C=-15;C<0;C++){var p,A,F;p=e[B+-10],A=b[T+-224]*p,F=b[_+224]*p,p=e[B+-9],A+=b[T+-160]*p,F+=b[_+160]*p,p=e[B+-8],A+=b[T+-96]*p,F+=b[_+96]*p,p=e[B+-7],A+=b[T+-32]*p,F+=b[_+32]*p,p=e[B+-6],A+=b[T+32]*p,F+=b[_+-32]*p,p=e[B+-5],A+=b[T+96]*p,F+=b[_+-96]*p,p=e[B+-4],A+=b[T+160]*p,F+=b[_+-160]*p,p=e[B+-3],A+=b[T+224]*p,F+=b[_+-224]*p,p=e[B+-2],A+=b[_+-256]*p,F-=b[T+256]*p,p=e[B+-1],A+=b[_+-192]*p,F-=b[T+192]*p,p=e[B+0],A+=b[_+-128]*p,F-=b[T+128]*p,p=e[B+1],A+=b[_+-64]*p,F-=b[T+64]*p,p=e[B+2],A+=b[_+0]*p,F-=b[T+0]*p,p=e[B+3],A+=b[_+64]*p,F-=b[T+-64]*p,p=e[B+4],A+=b[_+128]*p,F-=b[T+-128]*p,p=e[B+5],A+=b[_+192]*p,F-=b[T+-192]*p,A*=e[B+6],p=F-A,o[30+C*2]=F+A,o[31+C*2]=e[B+7]*p,B+=18,_--,T++}{var A,F,R,I;F=b[_+-16]*e[B+-10],A=b[_+-32]*e[B+-2],F+=(b[_+-48]-b[_+16])*e[B+-9],A+=b[_+-96]*e[B+-1],F+=(b[_+-80]+b[_+48])*e[B+-8],A+=b[_+-160]*e[B+0],F+=(b[_+-112]-b[_+80])*e[B+-7],A+=b[_+-224]*e[B+1],F+=(b[_+-144]+b[_+112])*e[B+-6],A-=b[_+32]*e[B+2],F+=(b[_+-176]-b[_+144])*e[B+-5],A-=b[_+96]*e[B+3],F+=(b[_+-208]+b[_+176])*e[B+-4],A-=b[_+160]*e[B+4],F+=(b[_+-240]-b[_+208])*e[B+-3],A-=b[_+224],R=A-F,I=A+F,F=o[14],A=o[15]-F,o[31]=I+F,o[30]=R+A,o[15]=R-A,o[14]=I-F}{var h;h=o[28]-o[0],o[0]+=o[28],o[28]=h*e[B+-2*18+7],h=o[29]-o[1],o[1]+=o[29],o[29]=h*e[B+-2*18+7],h=o[26]-o[2],o[2]+=o[26],o[26]=h*e[B+-4*18+7],h=o[27]-o[3],o[3]+=o[27],o[27]=h*e[B+-4*18+7],h=o[24]-o[4],o[4]+=o[24],o[24]=h*e[B+-6*18+7],h=o[25]-o[5],o[5]+=o[25],o[25]=h*e[B+-6*18+7],h=o[22]-o[6],o[6]+=o[22],o[22]=h*Rt.SQRT2,h=o[23]-o[7],o[7]+=o[23],o[23]=h*Rt.SQRT2-o[7],o[7]-=o[6],o[22]-=o[7],o[23]-=o[22],h=o[6],o[6]=o[31]-h,o[31]=o[31]+h,h=o[7],o[7]=o[30]-h,o[30]=o[30]+h,h=o[22],o[22]=o[15]-h,o[15]=o[15]+h,h=o[23],o[23]=o[14]-h,o[14]=o[14]+h,h=o[20]-o[8],o[8]+=o[20],o[20]=h*e[B+-10*18+7],h=o[21]-o[9],o[9]+=o[21],o[21]=h*e[B+-10*18+7],h=o[18]-o[10],o[10]+=o[18],o[18]=h*e[B+-12*18+7],h=o[19]-o[11],o[11]+=o[19],o[19]=h*e[B+-12*18+7],h=o[16]-o[12],o[12]+=o[16],o[16]=h*e[B+-14*18+7],h=o[17]-o[13],o[13]+=o[17],o[17]=h*e[B+-14*18+7],h=-o[20]+o[24],o[20]+=o[24],o[24]=h*e[B+-12*18+7],h=-o[21]+o[25],o[21]+=o[25],o[25]=h*e[B+-12*18+7],h=o[4]-o[8],o[4]+=o[8],o[8]=h*e[B+-12*18+7],h=o[5]-o[9],o[5]+=o[9],o[9]=h*e[B+-12*18+7],h=o[0]-o[12],o[0]+=o[12],o[12]=h*e[B+-4*18+7],h=o[1]-o[13],o[1]+=o[13],o[13]=h*e[B+-4*18+7],h=o[16]-o[28],o[16]+=o[28],o[28]=h*e[B+-4*18+7],h=-o[17]+o[29],o[17]+=o[29],o[29]=h*e[B+-4*18+7],h=Rt.SQRT2*(o[2]-o[10]),o[2]+=o[10],o[10]=h,h=Rt.SQRT2*(o[3]-o[11]),o[3]+=o[11],o[11]=h,h=Rt.SQRT2*(-o[18]+o[26]),o[18]+=o[26],o[26]=h-o[18],h=Rt.SQRT2*(-o[19]+o[27]),o[19]+=o[27],o[27]=h-o[19],h=o[2],o[19]-=o[3],o[3]-=h,o[2]=o[31]-h,o[31]+=h,h=o[3],o[11]-=o[19],o[18]-=h,o[3]=o[30]-h,o[30]+=h,h=o[18],o[27]-=o[11],o[19]-=h,o[18]=o[15]-h,o[15]+=h,h=o[19],o[10]-=h,o[19]=o[14]-h,o[14]+=h,h=o[10],o[11]-=h,o[10]=o[23]-h,o[23]+=h,h=o[11],o[26]-=h,o[11]=o[22]-h,o[22]+=h,h=o[26],o[27]-=h,o[26]=o[7]-h,o[7]+=h,h=o[27],o[27]=o[6]-h,o[6]+=h,h=Rt.SQRT2*(o[0]-o[4]),o[0]+=o[4],o[4]=h,h=Rt.SQRT2*(o[1]-o[5]),o[1]+=o[5],o[5]=h,h=Rt.SQRT2*(o[16]-o[20]),o[16]+=o[20],o[20]=h,h=Rt.SQRT2*(o[17]-o[21]),o[17]+=o[21],o[21]=h,h=-Rt.SQRT2*(o[8]-o[12]),o[8]+=o[12],o[12]=h-o[8],h=-Rt.SQRT2*(o[9]-o[13]),o[9]+=o[13],o[13]=h-o[9],h=-Rt.SQRT2*(o[25]-o[29]),o[25]+=o[29],o[29]=h-o[25],h=-Rt.SQRT2*(o[24]+o[28]),o[24]-=o[28],o[28]=h-o[24],h=o[24]-o[16],o[24]=h,h=o[20]-h,o[20]=h,h=o[28]-h,o[28]=h,h=o[25]-o[17],o[25]=h,h=o[21]-h,o[21]=h,h=o[29]-h,o[29]=h,h=o[17]-o[1],o[17]=h,h=o[9]-h,o[9]=h,h=o[25]-h,o[25]=h,h=o[5]-h,o[5]=h,h=o[21]-h,o[21]=h,h=o[13]-h,o[13]=h,h=o[29]-h,o[29]=h,h=o[1]-o[0],o[1]=h,h=o[16]-h,o[16]=h,h=o[17]-h,o[17]=h,h=o[8]-h,o[8]=h,h=o[9]-h,o[9]=h,h=o[24]-h,o[24]=h,h=o[25]-h,o[25]=h,h=o[4]-h,o[4]=h,h=o[5]-h,o[5]=h,h=o[20]-h,o[20]=h,h=o[21]-h,o[21]=h,h=o[12]-h,o[12]=h,h=o[13]-h,o[13]=h,h=o[28]-h,o[28]=h,h=o[29]-h,o[29]=h,h=o[0],o[0]+=o[31],o[31]-=h,h=o[1],o[1]+=o[30],o[30]-=h,h=o[16],o[16]+=o[15],o[15]-=h,h=o[17],o[17]+=o[14],o[14]-=h,h=o[8],o[8]+=o[23],o[23]-=h,h=o[9],o[9]+=o[22],o[22]-=h,h=o[24],o[24]+=o[7],o[7]-=h,h=o[25],o[25]+=o[6],o[6]-=h,h=o[4],o[4]+=o[27],o[27]-=h,h=o[5],o[5]+=o[26],o[26]-=h,h=o[20],o[20]+=o[11],o[11]-=h,h=o[21],o[21]+=o[10],o[10]-=h,h=o[12],o[12]+=o[19],o[19]-=h,h=o[13],o[13]+=o[18],o[18]-=h,h=o[28],o[28]+=o[3],o[3]-=h,h=o[29],o[29]+=o[2],o[2]-=h}}function m(b,_){for(var o=0;o<3;o++){var B,T,C,p,A,F;p=b[_+2*3]*r[j.SHORT_TYPE][0]-b[_+5*3],B=b[_+0*3]*r[j.SHORT_TYPE][2]-b[_+3*3],T=p+B,C=p-B,p=b[_+5*3]*r[j.SHORT_TYPE][0]+b[_+2*3],B=b[_+3*3]*r[j.SHORT_TYPE][2]+b[_+0*3],A=p+B,F=-p+B,B=(b[_+1*3]*r[j.SHORT_TYPE][1]-b[_+4*3])*2069978111953089e-26,p=(b[_+4*3]*r[j.SHORT_TYPE][1]+b[_+1*3])*2069978111953089e-26,b[_+3*0]=T*190752519173728e-25+B,b[_+3*5]=-A*190752519173728e-25+p,C=C*.8660254037844387*1907525191737281e-26,A=A*.5*1907525191737281e-26+p,b[_+3*1]=C-A,b[_+3*2]=C+A,T=T*.5*1907525191737281e-26-B,F=F*.8660254037844387*1907525191737281e-26,b[_+3*3]=T+F,b[_+3*4]=T-F,_++}}function c(b,_,o){var B,T;{var C,p,A,F,R,I,h,M;C=o[17]-o[9],A=o[15]-o[11],F=o[14]-o[12],R=o[0]+o[8],I=o[1]+o[7],h=o[2]+o[6],M=o[3]+o[5],b[_+17]=R+h-M-(I-o[4]),T=(R+h-M)*i[12+7]+(I-o[4]),B=(C-A-F)*i[12+6],b[_+5]=B+T,b[_+6]=B-T,p=(o[16]-o[10])*i[12+6],I=I*i[12+7]+o[4],B=C*i[12+0]+p+A*i[12+1]+F*i[12+2],T=-R*i[12+4]+I-h*i[12+5]+M*i[12+3],b[_+1]=B+T,b[_+2]=B-T,B=C*i[12+1]-p-A*i[12+2]+F*i[12+0],T=-R*i[12+5]+I-h*i[12+3]+M*i[12+4],b[_+9]=B+T,b[_+10]=B-T,B=C*i[12+2]-p+A*i[12+0]-F*i[12+1],T=R*i[12+3]-I+h*i[12+4]-M*i[12+5],b[_+13]=B+T,b[_+14]=B-T}{var S,v,y,x,w,k,g,D;S=o[8]-o[0],y=o[6]-o[2],x=o[5]-o[3],w=o[17]+o[9],k=o[16]+o[10],g=o[15]+o[11],D=o[14]+o[12],b[_+0]=w+g+D+(k+o[13]),B=(w+g+D)*i[12+7]-(k+o[13]),T=(S-y+x)*i[12+6],b[_+11]=B+T,b[_+12]=B-T,v=(o[7]-o[1])*i[12+6],k=o[13]-k*i[12+7],B=w*i[12+3]-k+g*i[12+4]+D*i[12+5],T=S*i[12+2]+v+y*i[12+0]+x*i[12+1],b[_+3]=B+T,b[_+4]=B-T,B=-w*i[12+5]+k-g*i[12+3]-D*i[12+4],T=S*i[12+1]+v-y*i[12+2]-x*i[12+0],b[_+7]=B+T,b[_+8]=B-T,B=-w*i[12+4]+k-g*i[12+5]-D*i[12+3],T=S*i[12+0]-v+y*i[12+1]-x*i[12+2],b[_+15]=B+T,b[_+16]=B-T}}this.mdct_sub48=function(b,_,o){for(var B=_,T=286,C=0;C<b.channels_out;C++){for(var p=0;p<b.mode_gr;p++){for(var A,F=b.l3_side.tt[p][C],R=F.xr,I=0,h=b.sb_sample[C][1-p],M=0,S=0;S<18/2;S++)for(u(B,T,h[M]),u(B,T+32,h[M+1]),M+=2,T+=64,A=1;A<32;A+=2)h[M-1][A]*=-1;for(A=0;A<32;A++,I+=18){var v=F.block_type,y=b.sb_sample[C][p],x=b.sb_sample[C][1-p];if(F.mixed_block_flag!=0&&A<2&&(v=0),b.amp_filter[A]<1e-12)F3.fill(R,I+0,I+18,0);else{if(b.amp_filter[A]<1)for(var S=0;S<18;S++)x[S][f[A]]*=b.amp_filter[A];if(v==j.SHORT_TYPE){for(var S=-t/4;S<0;S++){var w=r[j.SHORT_TYPE][S+3];R[I+S*3+9]=y[9+S][f[A]]*w-y[8-S][f[A]],R[I+S*3+18]=y[14-S][f[A]]*w+y[15+S][f[A]],R[I+S*3+10]=y[15+S][f[A]]*w-y[14-S][f[A]],R[I+S*3+19]=x[2-S][f[A]]*w+x[3+S][f[A]],R[I+S*3+11]=x[3+S][f[A]]*w-x[2-S][f[A]],R[I+S*3+20]=x[8-S][f[A]]*w+x[9+S][f[A]]}m(R,I)}else{for(var k=j3(18),S=-n/4;S<0;S++){var g,D;g=r[v][S+27]*x[S+9][f[A]]+r[v][S+36]*x[8-S][f[A]],D=r[v][S+9]*y[S+9][f[A]]-r[v][S+18]*y[8-S][f[A]],k[S+9]=g-D*a[3+S+9],k[S+18]=g*a[3+S+9]+D}c(R,I,k)}}if(v!=j.SHORT_TYPE&&A!=0)for(var S=7;S>=0;--S){var Y,z;Y=R[I+S]*s[20+S]+R[I+-1-S]*l[28+S],z=R[I+S]*l[28+S]-R[I+-1-S]*s[20+S],R[I+-1-S]=Y,R[I+S]=z}}}if(B=o,T=286,b.mode_gr==1)for(var U=0;U<18;U++)L3.arraycopy(b.sb_sample[C][1][U],0,b.sb_sample[C][0][U],0,32)}}}var D3=Ie.System,H3=Ie.new_float,z3=Ie.new_float_n;function Ua(){this.l=H3(j.SBMAX_l),this.s=z3([j.SBMAX_s,3]);var e=this;this.assign=function(t){D3.arraycopy(t.l,0,e.l,0,j.SBMAX_l);for(var n=0;n<j.SBMAX_s;n++)for(var r=0;r<3;r++)e.s[n][r]=t.s[n][r]}}function lr(){this.thm=new Ua,this.en=new Ua}function ft(e){var t=e;this.ordinal=function(){return t}}ft.STEREO=new ft(0),ft.JOINT_STEREO=new ft(1),ft.DUAL_CHANNEL=new ft(2),ft.MONO=new ft(3),ft.NOT_SET=new ft(4);var Xu=Ie.System,qa=Ie.VbrMode,Yu=Ie.new_array_n,Ku=Ie.new_float,P3=Ie.new_float_n,V3=Ie.new_int,Xa=Ie.assert;j.ENCDELAY=576,j.POSTDELAY=1152,j.MDCTDELAY=48,j.FFTOFFSET=224+j.MDCTDELAY,j.DECDELAY=528,j.SBLIMIT=32,j.CBANDS=64,j.SBPSY_l=21,j.SBPSY_s=12,j.SBMAX_l=22,j.SBMAX_s=13,j.PSFB21=6,j.PSFB12=6,j.BLKSIZE=1024,j.HBLKSIZE=j.BLKSIZE/2+1,j.BLKSIZE_s=256,j.HBLKSIZE_s=j.BLKSIZE_s/2+1,j.NORM_TYPE=0,j.START_TYPE=1,j.SHORT_TYPE=2,j.STOP_TYPE=3,j.MPG_MD_LR_LR=0,j.MPG_MD_LR_I=1,j.MPG_MD_MS_LR=2,j.MPG_MD_MS_I=3,j.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function j(){var e=j.FFTOFFSET,t=j.MPG_MD_MS_LR,n=null;this.psy=null;var r=null,a=null,i=null;this.setModules=function(m,c,b,_){n=m,this.psy=c,r=c,a=_,i=b};var s=new N3;function l(m){var c,b;if(m.ATH.useAdjust==0){m.ATH.adjust=1;return}if(b=m.loudness_sq[0][0],c=m.loudness_sq[1][0],m.channels_out==2?(b+=m.loudness_sq[0][1],c+=m.loudness_sq[1][1]):(b+=b,c+=c),m.mode_gr==2&&(b=Math.max(b,c)),b*=.5,b*=m.ATH.aaSensitivityP,b>.03125)m.ATH.adjust>=1?m.ATH.adjust=1:m.ATH.adjust<m.ATH.adjustLimit&&(m.ATH.adjust=m.ATH.adjustLimit),m.ATH.adjustLimit=1;else{var _=31.98*b+625e-6;m.ATH.adjust>=_?(m.ATH.adjust*=_*.075+.925,m.ATH.adjust<_&&(m.ATH.adjust=_)):m.ATH.adjustLimit>=_?m.ATH.adjust=_:m.ATH.adjust<m.ATH.adjustLimit&&(m.ATH.adjust=m.ATH.adjustLimit),m.ATH.adjustLimit=_}}function f(m){var c,b;for(Xa(m.bitrate_index>=0&&m.bitrate_index<16),Xa(m.mode_ext>=0&&m.mode_ext<4),m.bitrate_stereoMode_Hist[m.bitrate_index][4]++,m.bitrate_stereoMode_Hist[15][4]++,m.channels_out==2&&(m.bitrate_stereoMode_Hist[m.bitrate_index][m.mode_ext]++,m.bitrate_stereoMode_Hist[15][m.mode_ext]++),c=0;c<m.mode_gr;++c)for(b=0;b<m.channels_out;++b){var _=m.l3_side.tt[c][b].block_type|0;m.l3_side.tt[c][b].mixed_block_flag!=0&&(_=4),m.bitrate_blockType_Hist[m.bitrate_index][_]++,m.bitrate_blockType_Hist[m.bitrate_index][5]++,m.bitrate_blockType_Hist[15][_]++,m.bitrate_blockType_Hist[15][5]++}}function u(m,c){var b=m.internal_flags,_,o;if(b.lame_encode_frame_init==0){var B,T,C=Ku(2014),p=Ku(286+1152+576);for(b.lame_encode_frame_init=1,B=0,T=0;B<286+576*(1+b.mode_gr);++B)B<576*b.mode_gr?(C[B]=0,b.channels_out==2&&(p[B]=0)):(C[B]=c[0][T],b.channels_out==2&&(p[B]=c[1][T]),++T);for(o=0;o<b.mode_gr;o++)for(_=0;_<b.channels_out;_++)b.l3_side.tt[o][_].block_type=j.SHORT_TYPE;s.mdct_sub48(b,C,p),Xa(b.mf_size>=j.BLKSIZE+m.framesize-j.FFTOFFSET),Xa(b.mf_size>=512+m.framesize-32)}}this.lame_encode_mp3_frame=function(m,c,b,_,o,B){var T,C=Yu([2,2]);C[0][0]=new lr,C[0][1]=new lr,C[1][0]=new lr,C[1][1]=new lr;var p=Yu([2,2]);p[0][0]=new lr,p[0][1]=new lr,p[1][0]=new lr,p[1][1]=new lr;var A,F=[null,null],R=m.internal_flags,I=P3([2,4]),h=[.5,.5],M=[[0,0],[0,0]],S=[[0,0],[0,0]],v,y,x;if(F[0]=c,F[1]=b,R.lame_encode_frame_init==0&&u(m,F),R.padding=0,(R.slot_lag-=R.frac_SpF)<0&&(R.slot_lag+=m.out_samplerate,R.padding=1),R.psymodel!=0){var w,k=[null,null],g=0,D=V3(2);for(x=0;x<R.mode_gr;x++){for(y=0;y<R.channels_out;y++)k[y]=F[y],g=576+x*576-j.FFTOFFSET;if(m.VBR==qa.vbr_mtrh||m.VBR==qa.vbr_mt?w=r.L3psycho_anal_vbr(m,k,g,x,C,p,M[x],S[x],I[x],D):w=r.L3psycho_anal_ns(m,k,g,x,C,p,M[x],S[x],I[x],D),w!=0)return-4;for(m.mode==ft.JOINT_STEREO&&(h[x]=I[x][2]+I[x][3],h[x]>0&&(h[x]=I[x][3]/h[x])),y=0;y<R.channels_out;y++){var Y=R.l3_side.tt[x][y];Y.block_type=D[y],Y.mixed_block_flag=0}}}else for(x=0;x<R.mode_gr;x++)for(y=0;y<R.channels_out;y++)R.l3_side.tt[x][y].block_type=j.NORM_TYPE,R.l3_side.tt[x][y].mixed_block_flag=0,S[x][y]=M[x][y]=700;if(l(R),s.mdct_sub48(R,F[0],F[1]),R.mode_ext=j.MPG_MD_LR_LR,m.force_ms)R.mode_ext=j.MPG_MD_MS_LR;else if(m.mode==ft.JOINT_STEREO){var z=0,U=0;for(x=0;x<R.mode_gr;x++)for(y=0;y<R.channels_out;y++)z+=S[x][y],U+=M[x][y];if(z<=1*U){var d=R.l3_side.tt[0],E=R.l3_side.tt[R.mode_gr-1];d[0].block_type==d[1].block_type&&E[0].block_type==E[1].block_type&&(R.mode_ext=j.MPG_MD_MS_LR)}}if(R.mode_ext==t?(A=p,v=S):(A=C,v=M),m.analysis&&R.pinfo!=null)for(x=0;x<R.mode_gr;x++)for(y=0;y<R.channels_out;y++)R.pinfo.ms_ratio[x]=R.ms_ratio[x],R.pinfo.ms_ener_ratio[x]=h[x],R.pinfo.blocktype[x][y]=R.l3_side.tt[x][y].block_type,R.pinfo.pe[x][y]=v[x][y],Xu.arraycopy(R.l3_side.tt[x][y].xr,0,R.pinfo.xr[x][y],0,576),R.mode_ext==t&&(R.pinfo.ers[x][y]=R.pinfo.ers[x][y+2],Xu.arraycopy(R.pinfo.energy[x][y+2],0,R.pinfo.energy[x][y],0,R.pinfo.energy[x][y].length));if(m.VBR==qa.vbr_off||m.VBR==qa.vbr_abr){var W,O;for(W=0;W<18;W++)R.nsPsy.pefirbuf[W]=R.nsPsy.pefirbuf[W+1];for(O=0,x=0;x<R.mode_gr;x++)for(y=0;y<R.channels_out;y++)O+=v[x][y];for(R.nsPsy.pefirbuf[18]=O,O=R.nsPsy.pefirbuf[9],W=0;W<9;W++)O+=(R.nsPsy.pefirbuf[W]+R.nsPsy.pefirbuf[18-W])*j.fircoef[W];for(O=670*5*R.mode_gr*R.channels_out/O,x=0;x<R.mode_gr;x++)for(y=0;y<R.channels_out;y++)v[x][y]*=O}if(R.iteration_loop.iteration_loop(m,v,h,A),n.format_bitstream(m),T=n.copy_buffer(R,_,o,B,1),m.bWriteVbrTag&&a.addVbrFrame(m),m.analysis&&R.pinfo!=null){for(y=0;y<R.channels_out;y++){var me;for(me=0;me<e;me++)R.pinfo.pcmdata[y][me]=R.pinfo.pcmdata[y][me+m.framesize];for(me=e;me<1600;me++)R.pinfo.pcmdata[y][me]=F[y][me-e]}i.set_frame_pinfo(m,A)}return f(R),T}}var Gu=Ie.Util,Wu=Ie.new_float;function U3(){var e=Wu(j.BLKSIZE),t=Wu(j.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(i,s,l){var f=0,u,m,c;l<<=1;var b=s+l;u=4;do{var _,o,B,T,C,p,A;A=u>>1,T=u,C=u<<1,p=C+T,u=C<<1,m=s,c=m+A;do{var F,R,I,h;R=i[m+0]-i[m+T],F=i[m+0]+i[m+T],h=i[m+C]-i[m+p],I=i[m+C]+i[m+p],i[m+C]=F-I,i[m+0]=F+I,i[m+p]=R-h,i[m+T]=R+h,R=i[c+0]-i[c+T],F=i[c+0]+i[c+T],h=Gu.SQRT2*i[c+p],I=Gu.SQRT2*i[c+C],i[c+C]=F-I,i[c+0]=F+I,i[c+p]=R-h,i[c+T]=R+h,c+=u,m+=u}while(m<b);for(o=n[f+0],_=n[f+1],B=1;B<A;B++){var M,S;M=1-2*_*_,S=2*_*o,m=s+B,c=s+T-B;do{var v,y,x,F,R,w,I,k,h,g;y=S*i[m+T]-M*i[c+T],v=M*i[m+T]+S*i[c+T],R=i[m+0]-v,F=i[m+0]+v,w=i[c+0]-y,x=i[c+0]+y,y=S*i[m+p]-M*i[c+p],v=M*i[m+p]+S*i[c+p],h=i[m+C]-v,I=i[m+C]+v,g=i[c+C]-y,k=i[c+C]+y,y=_*I-o*g,v=o*I+_*g,i[m+C]=F-v,i[m+0]=F+v,i[c+p]=w-y,i[c+T]=w+y,y=o*k-_*h,v=_*k+o*h,i[c+C]=x-v,i[c+0]=x+v,i[m+p]=R-y,i[m+T]=R+y,c+=u,m+=u}while(m<b);M=o,o=M*n[f+0]-_*n[f+1],_=M*n[f+1]+_*n[f+0]}f+=2}while(u<l)}var a=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(i,s,l,f,u){for(var m=0;m<3;m++){var c=j.BLKSIZE_s/2,b=65535&576/3*(m+1),_=j.BLKSIZE_s/8-1;do{var o,B,T,C,p,A=a[_<<2]&255;o=t[A]*f[l][u+A+b],p=t[127-A]*f[l][u+A+b+128],B=o-p,o=o+p,T=t[A+64]*f[l][u+A+b+64],p=t[63-A]*f[l][u+A+b+192],C=T-p,T=T+p,c-=4,s[m][c+0]=o+T,s[m][c+2]=o-T,s[m][c+1]=B+C,s[m][c+3]=B-C,o=t[A+1]*f[l][u+A+b+1],p=t[126-A]*f[l][u+A+b+129],B=o-p,o=o+p,T=t[A+65]*f[l][u+A+b+65],p=t[62-A]*f[l][u+A+b+193],C=T-p,T=T+p,s[m][c+j.BLKSIZE_s/2+0]=o+T,s[m][c+j.BLKSIZE_s/2+2]=o-T,s[m][c+j.BLKSIZE_s/2+1]=B+C,s[m][c+j.BLKSIZE_s/2+3]=B-C}while(--_>=0);r(s[m],c,j.BLKSIZE_s/2)}},this.fft_long=function(i,s,l,f,u){var m=j.BLKSIZE/8-1,c=j.BLKSIZE/2;do{var b,_,o,B,T,C=a[m]&255;b=e[C]*f[l][u+C],T=e[C+512]*f[l][u+C+512],_=b-T,b=b+T,o=e[C+256]*f[l][u+C+256],T=e[C+768]*f[l][u+C+768],B=o-T,o=o+T,c-=4,s[c+0]=b+o,s[c+2]=b-o,s[c+1]=_+B,s[c+3]=_-B,b=e[C+1]*f[l][u+C+1],T=e[C+513]*f[l][u+C+513],_=b-T,b=b+T,o=e[C+257]*f[l][u+C+257],T=e[C+769]*f[l][u+C+769],B=o-T,o=o+T,s[c+j.BLKSIZE/2+0]=b+o,s[c+j.BLKSIZE/2+2]=b-o,s[c+j.BLKSIZE/2+1]=_+B,s[c+j.BLKSIZE/2+3]=_-B}while(--m>=0);r(s,c,j.BLKSIZE/2)},this.init_fft=function(i){for(var s=0;s<j.BLKSIZE;s++)e[s]=.42-.5*Math.cos(2*Math.PI*(s+.5)/j.BLKSIZE)+.08*Math.cos(4*Math.PI*(s+.5)/j.BLKSIZE);for(var s=0;s<j.BLKSIZE_s/2;s++)t[s]=.5*(1-Math.cos(2*Math.PI*(s+.5)/j.BLKSIZE_s))}}var ti=Ie.VbrMode,Zu=Ie.Float,ni=Ie.ShortBlock,Qt=Ie.Util,q3=Ie.Arrays,Ot=Ie.new_float,mn=Ie.new_float_n,Rr=Ie.new_int,et=Ie.assert;function Fo(){var e=new U3,t=2.302585092994046,n=2,r=16,a=2,i=16,s=.34,l=1/(14752*14752)/(j.BLKSIZE/2),f=.01,u=.8,m=.6,c=.3,b=3.5,_=21,o=.2302585093;function B(L){return L}function T(L,N){for(var V=0,q=0;q<j.BLKSIZE/2;++q)V+=L[q]*N.ATH.eql_w[q];return V*=l,V}function C(L,N,V,q,K,H,Z,$,G,oe,te){var le=L.internal_flags;if(G<2)e.fft_long(le,q[K],G,oe,te),e.fft_short(le,H[Z],G,oe,te);else if(G==2){for(var J=j.BLKSIZE-1;J>=0;--J){var ve=q[K+0][J],fe=q[K+1][J];q[K+0][J]=(ve+fe)*Qt.SQRT2*.5,q[K+1][J]=(ve-fe)*Qt.SQRT2*.5}for(var He=2;He>=0;--He)for(var J=j.BLKSIZE_s-1;J>=0;--J){var ve=H[Z+0][He][J],fe=H[Z+1][He][J];H[Z+0][He][J]=(ve+fe)*Qt.SQRT2*.5,H[Z+1][He][J]=(ve-fe)*Qt.SQRT2*.5}}N[0]=q[K+0][0],N[0]*=N[0];for(var J=j.BLKSIZE/2-1;J>=0;--J){var re=q[K+0][j.BLKSIZE/2-J],Le=q[K+0][j.BLKSIZE/2+J];N[j.BLKSIZE/2-J]=(re*re+Le*Le)*.5}for(var He=2;He>=0;--He){V[He][0]=H[Z+0][He][0],V[He][0]*=V[He][0];for(var J=j.BLKSIZE_s/2-1;J>=0;--J){var re=H[Z+0][He][j.BLKSIZE_s/2-J],Le=H[Z+0][He][j.BLKSIZE_s/2+J];V[He][j.BLKSIZE_s/2-J]=(re*re+Le*Le)*.5}}{for(var Ye=0,J=11;J<j.HBLKSIZE;J++)Ye+=N[J];le.tot_ener[G]=Ye}if(L.analysis){for(var J=0;J<j.HBLKSIZE;J++)le.pinfo.energy[$][G][J]=le.pinfo.energy_save[G][J],le.pinfo.energy_save[G][J]=N[J];le.pinfo.pe[$][G]=le.pe[G]}L.athaa_loudapprox==2&&G<2&&(le.loudness_sq[$][G]=le.loudness_sq_save[G],le.loudness_sq_save[G]=T(N,le))}var p=8,A=23,F=15,R,I,h,M=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function S(){R=Math.pow(10,(p+1)/16),I=Math.pow(10,(A+1)/16),h=Math.pow(10,F/10)}var v=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],y=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],x=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function w(L,N,V,q,K,H){var Z;if(N>L)if(N<L*I)Z=N/L;else return L+N;else{if(L>=N*I)return L+N;Z=L/N}if(L+=N,q+3<=3+3){if(Z>=R)return L;var $=0|Qt.FAST_LOG10_X(Z,16);return L*y[$]}var $=0|Qt.FAST_LOG10_X(Z,16);if(H!=0?N=K.ATH.cb_s[V]*K.ATH.adjust:N=K.ATH.cb_l[V]*K.ATH.adjust,L<h*N){if(L>N){var G,oe;return G=1,$<=13&&(G=x[$]),oe=Qt.FAST_LOG10_X(L/N,10/15),L*((v[$]-G)*oe+G)}return $>13?L:L*x[$]}return L*v[$]}var k=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function g(L,N,V){var q;if(L<0&&(L=0),N<0&&(N=0),L<=0)return N;if(N<=0)return L;if(N>L?q=N/L:q=L/N,V>=-2&&V<=2){if(q>=R)return L+N;var K=0|Qt.FAST_LOG10_X(q,16);return(L+N)*k[K]}return q<I?L+N:(L<N&&(L=N),L)}function D(L,N){var V=L.internal_flags;if(V.channels_out>1){for(var q=0;q<j.SBMAX_l;q++){var K=V.thm[0].l[q],H=V.thm[1].l[q];V.thm[0].l[q]+=H*N,V.thm[1].l[q]+=K*N}for(var q=0;q<j.SBMAX_s;q++)for(var Z=0;Z<3;Z++){var K=V.thm[0].s[q][Z],H=V.thm[1].s[q][Z];V.thm[0].s[q][Z]+=H*N,V.thm[1].s[q][Z]+=K*N}}}function Y(L){for(var N=0;N<j.SBMAX_l;N++)if(!(L.thm[0].l[N]>1.58*L.thm[1].l[N]||L.thm[1].l[N]>1.58*L.thm[0].l[N])){var V=L.mld_l[N]*L.en[3].l[N],q=Math.max(L.thm[2].l[N],Math.min(L.thm[3].l[N],V));V=L.mld_l[N]*L.en[2].l[N];var K=Math.max(L.thm[3].l[N],Math.min(L.thm[2].l[N],V));L.thm[2].l[N]=q,L.thm[3].l[N]=K}for(var N=0;N<j.SBMAX_s;N++)for(var H=0;H<3;H++)if(!(L.thm[0].s[N][H]>1.58*L.thm[1].s[N][H]||L.thm[1].s[N][H]>1.58*L.thm[0].s[N][H])){var V=L.mld_s[N]*L.en[3].s[N][H],q=Math.max(L.thm[2].s[N][H],Math.min(L.thm[3].s[N][H],V));V=L.mld_s[N]*L.en[2].s[N][H];var K=Math.max(L.thm[3].s[N][H],Math.min(L.thm[2].s[N][H],V));L.thm[2].s[N][H]=q,L.thm[3].s[N][H]=K}}function z(L,N,V){var q=N,K=Math.pow(10,V);N*=2,q*=2;for(var H=0;H<j.SBMAX_l;H++){var Z,$,G,oe;if(oe=L.ATH.cb_l[L.bm_l[H]]*K,Z=Math.min(Math.max(L.thm[0].l[H],oe),Math.max(L.thm[1].l[H],oe)),$=Math.max(L.thm[2].l[H],oe),G=Math.max(L.thm[3].l[H],oe),Z*N<$+G){var te=Z*q/($+G);$*=te,G*=te}L.thm[2].l[H]=Math.min($,L.thm[2].l[H]),L.thm[3].l[H]=Math.min(G,L.thm[3].l[H])}K*=j.BLKSIZE_s/j.BLKSIZE;for(var H=0;H<j.SBMAX_s;H++)for(var le=0;le<3;le++){var Z,$,G,oe;if(oe=L.ATH.cb_s[L.bm_s[H]]*K,Z=Math.min(Math.max(L.thm[0].s[H][le],oe),Math.max(L.thm[1].s[H][le],oe)),$=Math.max(L.thm[2].s[H][le],oe),G=Math.max(L.thm[3].s[H][le],oe),Z*N<$+G){var te=Z*N/($+G);$*=te,G*=te}L.thm[2].s[H][le]=Math.min(L.thm[2].s[H][le],$),L.thm[3].s[H][le]=Math.min(L.thm[3].s[H][le],G)}}function U(L,N,V,q,K){var H,Z,$=0,G=0;for(H=Z=0;H<j.SBMAX_s;++Z,++H){for(var oe=L.bo_s[H],te=L.npart_s,le=oe<te?oe:te;Z<le;)et(N[Z]>=0),et(V[Z]>=0),$+=N[Z],G+=V[Z],Z++;if(L.en[q].s[H][K]=$,L.thm[q].s[H][K]=G,Z>=te){++H;break}et(N[Z]>=0),et(V[Z]>=0);{var J=L.PSY.bo_s_weight[H],ve=1-J;$=J*N[Z],G=J*V[Z],L.en[q].s[H][K]+=$,L.thm[q].s[H][K]+=G,$=ve*N[Z],G=ve*V[Z]}}for(;H<j.SBMAX_s;++H)L.en[q].s[H][K]=0,L.thm[q].s[H][K]=0}function d(L,N,V,q){var K,H,Z=0,$=0;for(K=H=0;K<j.SBMAX_l;++H,++K){for(var G=L.bo_l[K],oe=L.npart_l,te=G<oe?G:oe;H<te;)et(N[H]>=0),et(V[H]>=0),Z+=N[H],$+=V[H],H++;if(L.en[q].l[K]=Z,L.thm[q].l[K]=$,H>=oe){++K;break}et(N[H]>=0),et(V[H]>=0);{var le=L.PSY.bo_l_weight[K],J=1-le;Z=le*N[H],$=le*V[H],L.en[q].l[K]+=Z,L.thm[q].l[K]+=$,Z=J*N[H],$=J*V[H]}}for(;K<j.SBMAX_l;++K)L.en[q].l[K]=0,L.thm[q].l[K]=0}function E(L,N,V,q,K,H){var Z=L.internal_flags,$,G;for(G=$=0;G<Z.npart_s;++G){for(var oe=0,te=Z.numlines_s[G],le=0;le<te;++le,++$){var J=N[H][$];oe+=J}V[G]=oe}for(et(G==Z.npart_s),$=G=0;G<Z.npart_s;G++){var ve=Z.s3ind_s[G][0],fe=Z.s3_ss[$++]*V[ve];for(++ve;ve<=Z.s3ind_s[G][1];)fe+=Z.s3_ss[$]*V[ve],++$,++ve;{var He=a*Z.nb_s1[K][G];q[G]=Math.min(fe,He)}if(Z.blocktype_old[K&1]==j.SHORT_TYPE){var He=i*Z.nb_s2[K][G],re=q[G];q[G]=Math.min(He,re)}Z.nb_s2[K][G]=Z.nb_s1[K][G],Z.nb_s1[K][G]=fe,et(q[G]>=0)}for(;G<=j.CBANDS;++G)V[G]=0,q[G]=0}function W(L,N,V,q){var K=L.internal_flags;L.short_blocks==ni.short_block_coupled&&!(N[0]!=0&&N[1]!=0)&&(N[0]=N[1]=0);for(var H=0;H<K.channels_out;H++)q[H]=j.NORM_TYPE,L.short_blocks==ni.short_block_dispensed&&(N[H]=1),L.short_blocks==ni.short_block_forced&&(N[H]=0),N[H]!=0?(et(K.blocktype_old[H]!=j.START_TYPE),K.blocktype_old[H]==j.SHORT_TYPE&&(q[H]=j.STOP_TYPE)):(q[H]=j.SHORT_TYPE,K.blocktype_old[H]==j.NORM_TYPE&&(K.blocktype_old[H]=j.START_TYPE),K.blocktype_old[H]==j.STOP_TYPE&&(K.blocktype_old[H]=j.SHORT_TYPE)),V[H]=K.blocktype_old[H],K.blocktype_old[H]=q[H]}function O(L,N,V){return V>=1?L:V<=0?N:N>0?Math.pow(L/N,V)*N:0}var me=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Se(L,N){for(var V=309.07,q=0;q<j.SBMAX_s-1;q++)for(var K=0;K<3;K++){var H=L.thm.s[q][K];if(H>0){var Z=H*N,$=L.en.s[q][K];$>Z&&($>Z*1e10?V+=me[q]*(10*t):V+=me[q]*Qt.FAST_LOG10($/Z))}}return V}var _e=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function pe(L,N){for(var V=281.0575,q=0;q<j.SBMAX_l-1;q++){var K=L.thm.l[q];if(K>0){var H=K*N,Z=L.en.l[q];Z>H&&(Z>H*1e10?V+=_e[q]*(10*t):V+=_e[q]*Qt.FAST_LOG10(Z/H))}}return V}function De(L,N,V,q,K){var H,Z;for(H=Z=0;H<L.npart_l;++H){var $=0,G=0,oe;for(oe=0;oe<L.numlines_l[H];++oe,++Z){var te=N[Z];$+=te,G<te&&(G=te)}V[H]=$,q[H]=G,K[H]=$*L.rnumlines_l[H],et(L.rnumlines_l[H]>=0),et(V[H]>=0),et(q[H]>=0),et(K[H]>=0)}}function Ce(L,N,V,q){var K=M.length-1,H=0,Z=V[H]+V[H+1];if(Z>0){var $=N[H];$<N[H+1]&&($=N[H+1]),et(L.numlines_l[H]+L.numlines_l[H+1]-1>0),Z=20*($*2-Z)/(Z*(L.numlines_l[H]+L.numlines_l[H+1]-1));var G=0|Z;G>K&&(G=K),q[H]=G}else q[H]=0;for(H=1;H<L.npart_l-1;H++)if(Z=V[H-1]+V[H]+V[H+1],Z>0){var $=N[H-1];$<N[H]&&($=N[H]),$<N[H+1]&&($=N[H+1]),et(L.numlines_l[H-1]+L.numlines_l[H]+L.numlines_l[H+1]-1>0),Z=20*($*3-Z)/(Z*(L.numlines_l[H-1]+L.numlines_l[H]+L.numlines_l[H+1]-1));var G=0|Z;G>K&&(G=K),q[H]=G}else q[H]=0;if(et(H==L.npart_l-1),Z=V[H-1]+V[H],Z>0){var $=N[H-1];$<N[H]&&($=N[H]),et(L.numlines_l[H-1]+L.numlines_l[H]-1>0),Z=20*($*2-Z)/(Z*(L.numlines_l[H-1]+L.numlines_l[H]-1));var G=0|Z;G>K&&(G=K),q[H]=G}else q[H]=0;et(H==L.npart_l-1)}var he=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(L,N,V,q,K,H,Z,$,G,oe){var te=L.internal_flags,le=mn([2,j.BLKSIZE]),J=mn([2,3,j.BLKSIZE_s]),ve=Ot(j.CBANDS+1),fe=Ot(j.CBANDS+1),He=Ot(j.CBANDS+2),re=Rr(2),Le=Rr(2),Ye,be,Ne,xe,qe,At,Fe,Ze,tt=mn([2,576]),Mt,on=Rr(j.CBANDS+2),Bt=Rr(j.CBANDS+2);for(q3.fill(Bt,0),Ye=te.channels_out,L.mode==ft.JOINT_STEREO&&(Ye=4),L.VBR==ti.vbr_off?Mt=te.ResvMax==0?0:te.ResvSize/te.ResvMax*.5:L.VBR==ti.vbr_rh||L.VBR==ti.vbr_mtrh||L.VBR==ti.vbr_mt?Mt=.6:Mt=1,be=0;be<te.channels_out;be++){var Et=N[be],$t=V+576-350-_+192;for(xe=0;xe<576;xe++){var ln,cn;for(ln=Et[$t+xe+10],cn=0,qe=0;qe<(_-1)/2-1;qe+=2)ln+=he[qe]*(Et[$t+xe+qe]+Et[$t+xe+_-qe]),cn+=he[qe+1]*(Et[$t+xe+qe+1]+Et[$t+xe+_-qe-1]);tt[be][xe]=ln+cn}K[q][be].en.assign(te.en[be]),K[q][be].thm.assign(te.thm[be]),Ye>2&&(H[q][be].en.assign(te.en[be+2]),H[q][be].thm.assign(te.thm[be+2]))}for(be=0;be<Ye;be++){var wn,kn,Ut=Ot(12),Nn=[0,0,0,0],ai=Ot(12),Xo=1,h1,v1=Ot(j.CBANDS),p1=Ot(j.CBANDS),Tt=[0,0,0,0],_1=Ot(j.HBLKSIZE),g1=mn([3,j.HBLKSIZE_s]);for(et(te.npart_s<=j.CBANDS),et(te.npart_l<=j.CBANDS),xe=0;xe<3;xe++)Ut[xe]=te.nsPsy.last_en_subshort[be][xe+6],et(te.nsPsy.last_en_subshort[be][xe+4]>0),ai[xe]=Ut[xe]/te.nsPsy.last_en_subshort[be][xe+4],Nn[0]+=Ut[xe];if(be==2)for(xe=0;xe<576;xe++){var Yo,Ko;Yo=tt[0][xe],Ko=tt[1][xe],tt[0][xe]=Yo+Ko,tt[1][xe]=Yo-Ko}{var b1=tt[be&1],qi=0;for(xe=0;xe<9;xe++){for(var I5=qi+64,Nt=1;qi<I5;qi++)Nt<Math.abs(b1[qi])&&(Nt=Math.abs(b1[qi]));te.nsPsy.last_en_subshort[be][xe]=Ut[xe+3]=Nt,Nn[1+xe/3]+=Nt,Nt>Ut[xe+3-2]?(et(Ut[xe+3-2]>0),Nt=Nt/Ut[xe+3-2]):Ut[xe+3-2]>Nt*10?Nt=Ut[xe+3-2]/(Nt*10):Nt=0,ai[xe+3]=Nt}}if(L.analysis){var Go=ai[0];for(xe=1;xe<12;xe++)Go<ai[xe]&&(Go=ai[xe]);te.pinfo.ers[q][be]=te.pinfo.ers_save[be],te.pinfo.ers_save[be]=Go}for(h1=be==3?te.nsPsy.attackthre_s:te.nsPsy.attackthre,xe=0;xe<12;xe++)Tt[xe/3]==0&&ai[xe]>h1&&(Tt[xe/3]=xe%3+1);for(xe=1;xe<4;xe++){var Wo;Nn[xe-1]>Nn[xe]?(et(Nn[xe]>0),Wo=Nn[xe-1]/Nn[xe]):(et(Nn[xe-1]>0),Wo=Nn[xe]/Nn[xe-1]),Wo<1.7&&(Tt[xe]=0,xe==1&&(Tt[0]=0))}for(Tt[0]!=0&&te.nsPsy.lastAttacks[be]!=0&&(Tt[0]=0),(te.nsPsy.lastAttacks[be]==3||Tt[0]+Tt[1]+Tt[2]+Tt[3]!=0)&&(Xo=0,Tt[1]!=0&&Tt[0]!=0&&(Tt[1]=0),Tt[2]!=0&&Tt[1]!=0&&(Tt[2]=0),Tt[3]!=0&&Tt[2]!=0&&(Tt[3]=0)),be<2?Le[be]=Xo:Xo==0&&(Le[0]=Le[1]=0),G[be]=te.tot_ener[be],kn=J,wn=le,C(L,_1,g1,wn,be&1,kn,be&1,q,be,N,V),De(te,_1,ve,v1,p1),Ce(te,v1,p1,on),Ze=0;Ze<3;Ze++){var Zo,en;for(E(L,g1,fe,He,be,Ze),U(te,fe,He,be,Ze),Fe=0;Fe<j.SBMAX_s;Fe++){if(en=te.thm[be].s[Fe][Ze],en*=u,Tt[Ze]>=2||Tt[Ze+1]==1){var Xi=Ze!=0?Ze-1:2,Nt=O(te.thm[be].s[Fe][Xi],en,m*Mt);en=Math.min(en,Nt)}if(Tt[Ze]==1){var Xi=Ze!=0?Ze-1:2,Nt=O(te.thm[be].s[Fe][Xi],en,c*Mt);en=Math.min(en,Nt)}else if(Ze!=0&&Tt[Ze-1]==3||Ze==0&&te.nsPsy.lastAttacks[be]==3){var Xi=Ze!=2?Ze+1:0,Nt=O(te.thm[be].s[Fe][Xi],en,c*Mt);en=Math.min(en,Nt)}Zo=Ut[Ze*3+3]+Ut[Ze*3+4]+Ut[Ze*3+5],Ut[Ze*3+5]*6<Zo&&(en*=.5,Ut[Ze*3+4]*6<Zo&&(en*=.5)),te.thm[be].s[Fe][Ze]=en}}for(te.nsPsy.lastAttacks[be]=Tt[2],At=0,Ne=0;Ne<te.npart_l;Ne++){for(var jr=te.s3ind[Ne][0],Qo=ve[jr]*M[on[jr]],Nr=te.s3_ll[At++]*Qo;++jr<=te.s3ind[Ne][1];)Qo=ve[jr]*M[on[jr]],Nr=w(Nr,te.s3_ll[At++]*Qo,jr,jr-Ne,te,0);Nr*=.158489319246111,te.blocktype_old[be&1]==j.SHORT_TYPE?He[Ne]=Nr:He[Ne]=O(Math.min(Nr,Math.min(n*te.nb_1[be][Ne],r*te.nb_2[be][Ne])),Nr,Mt),te.nb_2[be][Ne]=te.nb_1[be][Ne],te.nb_1[be][Ne]=Nr}for(;Ne<=j.CBANDS;++Ne)ve[Ne]=0,He[Ne]=0;d(te,ve,He,be)}if((L.mode==ft.STEREO||L.mode==ft.JOINT_STEREO)&&L.interChRatio>0&&D(L,L.interChRatio),L.mode==ft.JOINT_STEREO){var Jo;Y(te),Jo=L.msfix,Math.abs(Jo)>0&&z(te,Jo,L.ATHlower*te.ATH.adjust)}for(W(L,Le,oe,re),be=0;be<Ye;be++){var Yi,Ki=0,$a,es;be>1?(Yi=$,Ki=-2,$a=j.NORM_TYPE,(oe[0]==j.SHORT_TYPE||oe[1]==j.SHORT_TYPE)&&($a=j.SHORT_TYPE),es=H[q][be-2]):(Yi=Z,Ki=0,$a=oe[be],es=K[q][be]),$a==j.SHORT_TYPE?Yi[Ki+be]=Se(es,te.masking_lower):Yi[Ki+be]=pe(es,te.masking_lower),L.analysis&&(te.pinfo.pe[q][be]=Yi[Ki+be])}return 0};function Ue(L,N,V,q,K,H,Z,$){var G=L.internal_flags;if(q<2)e.fft_long(G,Z[$],q,N,V);else if(q==2)for(var oe=j.BLKSIZE-1;oe>=0;--oe){var te=Z[$+0][oe],le=Z[$+1][oe];Z[$+0][oe]=(te+le)*Qt.SQRT2*.5,Z[$+1][oe]=(te-le)*Qt.SQRT2*.5}H[0]=Z[$+0][0],H[0]*=H[0];for(var oe=j.BLKSIZE/2-1;oe>=0;--oe){var J=Z[$+0][j.BLKSIZE/2-oe],ve=Z[$+0][j.BLKSIZE/2+oe];H[j.BLKSIZE/2-oe]=(J*J+ve*ve)*.5}{for(var fe=0,oe=11;oe<j.HBLKSIZE;oe++)fe+=H[oe];G.tot_ener[q]=fe}if(L.analysis){for(var oe=0;oe<j.HBLKSIZE;oe++)G.pinfo.energy[K][q][oe]=G.pinfo.energy_save[q][oe],G.pinfo.energy_save[q][oe]=H[oe];G.pinfo.pe[K][q]=G.pe[q]}}function rt(L,N,V,q,K,H,Z,$){var G=L.internal_flags;if(K==0&&q<2&&e.fft_short(G,Z[$],q,N,V),q==2)for(var oe=j.BLKSIZE_s-1;oe>=0;--oe){var te=Z[$+0][K][oe],le=Z[$+1][K][oe];Z[$+0][K][oe]=(te+le)*Qt.SQRT2*.5,Z[$+1][K][oe]=(te-le)*Qt.SQRT2*.5}H[K][0]=Z[$+0][K][0],H[K][0]*=H[K][0];for(var oe=j.BLKSIZE_s/2-1;oe>=0;--oe){var J=Z[$+0][K][j.BLKSIZE_s/2-oe],ve=Z[$+0][K][j.BLKSIZE_s/2+oe];H[K][j.BLKSIZE_s/2-oe]=(J*J+ve*ve)*.5}}function P(L,N,V,q){var K=L.internal_flags;L.athaa_loudapprox==2&&V<2&&(K.loudness_sq[N][V]=K.loudness_sq_save[V],K.loudness_sq_save[V]=T(q,K))}var X=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function ne(L,N,V,q,K,H,Z,$,G,oe){for(var te=mn([2,576]),le=L.internal_flags,J=le.channels_out,ve=L.mode==ft.JOINT_STEREO?4:J,fe=0;fe<J;fe++){firbuf=N[fe];for(var He=V+576-350-_+192,re=0;re<576;re++){var Le,Ye;Le=firbuf[He+re+10],Ye=0;for(var be=0;be<(_-1)/2-1;be+=2)Le+=X[be]*(firbuf[He+re+be]+firbuf[He+re+_-be]),Ye+=X[be+1]*(firbuf[He+re+be+1]+firbuf[He+re+_-be-1]);te[fe][re]=Le+Ye}K[q][fe].en.assign(le.en[fe]),K[q][fe].thm.assign(le.thm[fe]),ve>2&&(H[q][fe].en.assign(le.en[fe+2]),H[q][fe].thm.assign(le.thm[fe+2]))}for(var fe=0;fe<ve;fe++){var Ne=Ot(12),xe=Ot(12),qe=[0,0,0,0],At=te[fe&1],Fe=0,Ze=fe==3?le.nsPsy.attackthre_s:le.nsPsy.attackthre,tt=1;if(fe==2)for(var re=0,be=576;be>0;++re,--be){var Mt=te[0][re],on=te[1][re];te[0][re]=Mt+on,te[1][re]=Mt-on}for(var re=0;re<3;re++)xe[re]=le.nsPsy.last_en_subshort[fe][re+6],et(le.nsPsy.last_en_subshort[fe][re+4]>0),Ne[re]=xe[re]/le.nsPsy.last_en_subshort[fe][re+4],qe[0]+=xe[re];for(var re=0;re<9;re++){for(var Bt=Fe+64,Et=1;Fe<Bt;Fe++)Et<Math.abs(At[Fe])&&(Et=Math.abs(At[Fe]));le.nsPsy.last_en_subshort[fe][re]=xe[re+3]=Et,qe[1+re/3]+=Et,Et>xe[re+3-2]?(et(xe[re+3-2]>0),Et=Et/xe[re+3-2]):xe[re+3-2]>Et*10?Et=xe[re+3-2]/(Et*10):Et=0,Ne[re+3]=Et}for(var re=0;re<3;++re){var $t=xe[re*3+3]+xe[re*3+4]+xe[re*3+5],ln=1;xe[re*3+5]*6<$t&&(ln*=.5,xe[re*3+4]*6<$t&&(ln*=.5)),$[fe][re]=ln}if(L.analysis){for(var cn=Ne[0],re=1;re<12;re++)cn<Ne[re]&&(cn=Ne[re]);le.pinfo.ers[q][fe]=le.pinfo.ers_save[fe],le.pinfo.ers_save[fe]=cn}for(var re=0;re<12;re++)G[fe][re/3]==0&&Ne[re]>Ze&&(G[fe][re/3]=re%3+1);for(var re=1;re<4;re++){var wn=qe[re-1],kn=qe[re],Ut=Math.max(wn,kn);Ut<4e4&&wn<1.7*kn&&kn<1.7*wn&&(re==1&&G[fe][0]<=G[fe][re]&&(G[fe][0]=0),G[fe][re]=0)}G[fe][0]<=le.nsPsy.lastAttacks[fe]&&(G[fe][0]=0),(le.nsPsy.lastAttacks[fe]==3||G[fe][0]+G[fe][1]+G[fe][2]+G[fe][3]!=0)&&(tt=0,G[fe][1]!=0&&G[fe][0]!=0&&(G[fe][1]=0),G[fe][2]!=0&&G[fe][1]!=0&&(G[fe][2]=0),G[fe][3]!=0&&G[fe][2]!=0&&(G[fe][3]=0)),fe<2?oe[fe]=tt:tt==0&&(oe[0]=oe[1]=0),Z[fe]=le.tot_ener[fe]}}function ce(L,N,V){if(V==0)for(var q=0;q<L.npart_s;q++)L.nb_s2[N][q]=L.nb_s1[N][q],L.nb_s1[N][q]=0}function de(L,N){for(var V=0;V<L.npart_l;V++)L.nb_2[N][V]=L.nb_1[N][V],L.nb_1[N][V]=0}function Ae(L,N,V,q){var K=M.length-1,H=0,Z=V[H]+V[H+1];if(Z>0){var $=N[H];$<N[H+1]&&($=N[H+1]),et(L.numlines_s[H]+L.numlines_s[H+1]-1>0),Z=20*($*2-Z)/(Z*(L.numlines_s[H]+L.numlines_s[H+1]-1));var G=0|Z;G>K&&(G=K),q[H]=G}else q[H]=0;for(H=1;H<L.npart_s-1;H++)if(Z=V[H-1]+V[H]+V[H+1],et(H+1<L.npart_s),Z>0){var $=N[H-1];$<N[H]&&($=N[H]),$<N[H+1]&&($=N[H+1]),et(L.numlines_s[H-1]+L.numlines_s[H]+L.numlines_s[H+1]-1>0),Z=20*($*3-Z)/(Z*(L.numlines_s[H-1]+L.numlines_s[H]+L.numlines_s[H+1]-1));var G=0|Z;G>K&&(G=K),q[H]=G}else q[H]=0;if(et(H==L.npart_s-1),Z=V[H-1]+V[H],Z>0){var $=N[H-1];$<N[H]&&($=N[H]),et(L.numlines_s[H-1]+L.numlines_s[H]-1>0),Z=20*($*2-Z)/(Z*(L.numlines_s[H-1]+L.numlines_s[H]-1));var G=0|Z;G>K&&(G=K),q[H]=G}else q[H]=0;et(H==L.npart_s-1)}function Ee(L,N,V,q,K,H){var Z=L.internal_flags,$=new float[j.CBANDS],G=Ot(j.CBANDS),oe,te,le,J=new int[j.CBANDS];for(le=te=0;le<Z.npart_s;++le){var ve=0,fe=0,He=Z.numlines_s[le];for(oe=0;oe<He;++oe,++te){var re=N[H][te];ve+=re,fe<re&&(fe=re)}V[le]=ve,$[le]=fe,G[le]=ve/He,et(G[le]>=0)}for(et(le==Z.npart_s);le<j.CBANDS;++le)$[le]=0,G[le]=0;for(Ae(Z,$,G,J),te=le=0;le<Z.npart_s;le++){var Le=Z.s3ind_s[le][0],Ye=Z.s3ind_s[le][1],be,Ne,xe,qe,At;for(be=J[Le],Ne=1,qe=Z.s3_ss[te]*V[Le]*M[J[Le]],++te,++Le;Le<=Ye;)be+=J[Le],Ne+=1,xe=Z.s3_ss[te]*V[Le]*M[J[Le]],qe=g(qe,xe,Le-le),++te,++Le;be=(1+2*be)/(2*Ne),At=M[be]*.5,qe*=At,q[le]=qe,Z.nb_s2[K][le]=Z.nb_s1[K][le],Z.nb_s1[K][le]=qe,xe=$[le],xe*=Z.minval_s[le],xe*=At,q[le]>xe&&(q[le]=xe),Z.masking_lower>1&&(q[le]*=Z.masking_lower),q[le]>V[le]&&(q[le]=V[le]),Z.masking_lower<1&&(q[le]*=Z.masking_lower),et(q[le]>=0)}for(;le<j.CBANDS;++le)V[le]=0,q[le]=0}function ye(L,N,V,q,K){var H=Ot(j.CBANDS),Z=Ot(j.CBANDS),$=Rr(j.CBANDS+2),G;De(L,N,V,H,Z),Ce(L,H,Z,$);var oe=0;for(G=0;G<L.npart_l;G++){var te,le,J,ve,fe=L.s3ind[G][0],He=L.s3ind[G][1],re=0,Le=0;for(re=$[fe],Le+=1,le=L.s3_ll[oe]*V[fe]*M[$[fe]],++oe,++fe;fe<=He;)re+=$[fe],Le+=1,te=L.s3_ll[oe]*V[fe]*M[$[fe]],ve=g(le,te,fe-G),le=ve,++oe,++fe;if(re=(1+2*re)/(2*Le),J=M[re]*.5,le*=J,L.blocktype_old[K&1]==j.SHORT_TYPE){var Ye=n*L.nb_1[K][G];Ye>0?q[G]=Math.min(le,Ye):q[G]=Math.min(le,V[G]*c)}else{var be=r*L.nb_2[K][G],Ne=n*L.nb_1[K][G],Ye;be<=0&&(be=le),Ne<=0&&(Ne=le),L.blocktype_old[K&1]==j.NORM_TYPE?Ye=Math.min(Ne,be):Ye=Ne,q[G]=Math.min(le,Ye)}L.nb_2[K][G]=L.nb_1[K][G],L.nb_1[K][G]=le,te=H[G],te*=L.minval_l[G],te*=J,q[G]>te&&(q[G]=te),L.masking_lower>1&&(q[G]*=L.masking_lower),q[G]>V[G]&&(q[G]=V[G]),L.masking_lower<1&&(q[G]*=L.masking_lower),et(q[G]>=0)}for(;G<j.CBANDS;++G)V[G]=0,q[G]=0}function Me(L,N){var V=L.internal_flags;L.short_blocks==ni.short_block_coupled&&!(N[0]!=0&&N[1]!=0)&&(N[0]=N[1]=0);for(var q=0;q<V.channels_out;q++)L.short_blocks==ni.short_block_dispensed&&(N[q]=1),L.short_blocks==ni.short_block_forced&&(N[q]=0)}function ge(L,N,V){for(var q=L.internal_flags,K=0;K<q.channels_out;K++){var H=j.NORM_TYPE;N[K]!=0?(et(q.blocktype_old[K]!=j.START_TYPE),q.blocktype_old[K]==j.SHORT_TYPE&&(H=j.STOP_TYPE)):(H=j.SHORT_TYPE,q.blocktype_old[K]==j.NORM_TYPE&&(q.blocktype_old[K]=j.START_TYPE),q.blocktype_old[K]==j.STOP_TYPE&&(q.blocktype_old[K]=j.SHORT_TYPE)),V[K]=q.blocktype_old[K],q.blocktype_old[K]=H}}function ze(L,N,V,q,K,H,Z){for(var $=H*2,G=H>0?Math.pow(10,K):1,oe,te,le=0;le<Z;++le){var J=L[2][le],ve=L[3][le],fe=N[0][le],He=N[1][le],re=N[2][le],Le=N[3][le];if(fe<=1.58*He&&He<=1.58*fe){var Ye=V[le]*ve,be=V[le]*J;te=Math.max(re,Math.min(Le,Ye)),oe=Math.max(Le,Math.min(re,be))}else te=re,oe=Le;if(H>0){var Ne,xe,qe=q[le]*G;if(Ne=Math.min(Math.max(fe,qe),Math.max(He,qe)),re=Math.max(te,qe),Le=Math.max(oe,qe),xe=re+Le,xe>0&&Ne*$<xe){var At=Ne*$/xe;re*=At,Le*=At}te=Math.min(re,te),oe=Math.min(Le,oe)}te>J&&(te=J),oe>ve&&(oe=ve),N[2][le]=te,N[3][le]=oe}}this.L3psycho_anal_vbr=function(L,N,V,q,K,H,Z,$,G,oe){var te=L.internal_flags,le,J,ve=Ot(j.HBLKSIZE),fe=mn([3,j.HBLKSIZE_s]),He=mn([2,j.BLKSIZE]),re=mn([2,3,j.BLKSIZE_s]),Le=mn([4,j.CBANDS]),Ye=mn([4,j.CBANDS]),be=mn([4,3]),Ne=.6,xe=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],qe=Rr(2),At=L.mode==ft.JOINT_STEREO?4:te.channels_out;ne(L,N,V,q,K,H,G,be,xe,qe),Me(L,qe);{for(var Fe=0;Fe<At;Fe++){var Ze=Fe&1;le=He,Ue(L,N,V,Fe,q,ve,le,Ze),P(L,q,Fe,ve),qe[Ze]!=0?ye(te,ve,Le[Fe],Ye[Fe],Fe):de(te,Fe)}qe[0]+qe[1]==2&&L.mode==ft.JOINT_STEREO&&ze(Le,Ye,te.mld_cb_l,te.ATH.cb_l,L.ATHlower*te.ATH.adjust,L.msfix,te.npart_l);for(var Fe=0;Fe<At;Fe++){var Ze=Fe&1;qe[Ze]!=0&&d(te,Le[Fe],Ye[Fe],Fe)}}{for(var tt=0;tt<3;tt++){for(var Fe=0;Fe<At;++Fe){var Ze=Fe&1;qe[Ze]!=0?ce(te,Fe,tt):(J=re,rt(L,N,V,Fe,tt,fe,J,Ze),Ee(L,fe,Le[Fe],Ye[Fe],Fe,tt))}qe[0]+qe[1]==0&&L.mode==ft.JOINT_STEREO&&ze(Le,Ye,te.mld_cb_s,te.ATH.cb_s,L.ATHlower*te.ATH.adjust,L.msfix,te.npart_s);for(var Fe=0;Fe<At;++Fe){var Ze=Fe&1;qe[Ze]==0&&U(te,Le[Fe],Ye[Fe],Fe,tt)}}for(var Fe=0;Fe<At;Fe++){var Ze=Fe&1;if(qe[Ze]==0)for(var Mt=0;Mt<j.SBMAX_s;Mt++){for(var on=Ot(3),tt=0;tt<3;tt++){var Bt=te.thm[Fe].s[Mt][tt];if(Bt*=u,xe[Fe][tt]>=2||xe[Fe][tt+1]==1){var Et=tt!=0?tt-1:2,$t=O(te.thm[Fe].s[Mt][Et],Bt,m*Ne);Bt=Math.min(Bt,$t)}else if(xe[Fe][tt]==1){var Et=tt!=0?tt-1:2,$t=O(te.thm[Fe].s[Mt][Et],Bt,c*Ne);Bt=Math.min(Bt,$t)}else if(tt!=0&&xe[Fe][tt-1]==3||tt==0&&te.nsPsy.lastAttacks[Fe]==3){var Et=tt!=2?tt+1:0,$t=O(te.thm[Fe].s[Mt][Et],Bt,c*Ne);Bt=Math.min(Bt,$t)}Bt*=be[Fe][tt],on[tt]=Bt}for(var tt=0;tt<3;tt++)te.thm[Fe].s[Mt][tt]=on[tt]}}}for(var Fe=0;Fe<At;Fe++)te.nsPsy.lastAttacks[Fe]=xe[Fe][2];ge(L,qe,oe);for(var Fe=0;Fe<At;Fe++){var ln,cn,wn,kn;Fe>1?(ln=$,cn=-2,wn=j.NORM_TYPE,(oe[0]==j.SHORT_TYPE||oe[1]==j.SHORT_TYPE)&&(wn=j.SHORT_TYPE),kn=H[q][Fe-2]):(ln=Z,cn=0,wn=oe[Fe],kn=K[q][Fe]),wn==j.SHORT_TYPE?ln[cn+Fe]=Se(kn,te.masking_lower):ln[cn+Fe]=pe(kn,te.masking_lower),L.analysis&&(te.pinfo.pe[q][Fe]=ln[cn+Fe])}return 0};function je(L,N){var V=L,q;return V>=0?q=-V*27:q=V*N,q<=-72?0:Math.exp(q*o)}function Pe(L){var N=0,V=0;{var q=0,K,H;for(q=0;je(q,L)>1e-20;q-=1);for(K=q,H=0;Math.abs(H-K)>1e-12;)q=(H+K)/2,je(q,L)>0?H=q:K=q;N=K}{var q=0,K,H;for(q=0;je(q,L)>1e-20;q+=1);for(K=0,H=q;Math.abs(H-K)>1e-12;)q=(H+K)/2,je(q,L)>0?K=q:H=q;V=H}{var Z=0,$=1e3,G;for(G=0;G<=$;++G){var q=N+G*(V-N)/$,oe=je(q,L);Z+=oe}{var te=($+1)/(Z*(V-N));return te}}}function Ve(L){var N,V,q,K;return N=L,N>=0?N*=3:N*=1.5,N>=.5&&N<=2.5?(K=N-.5,V=8*(K*K-2*K)):V=0,N+=.474,q=15.811389+7.5*N-17.5*Math.sqrt(1+N*N),q<=-60?0:(N=Math.exp((V+q)*o),N/=.6609193,N)}function Ge(L){return L<0&&(L=0),L=L*.001,13*Math.atan(.76*L)+3.5*Math.atan(L*L/(7.5*7.5))}function ue(L,N,V,q,K,H,Z,$,G,oe,te,le){var J=Ot(j.CBANDS+1),ve=$/(le>15?2*576:2*192),fe=Rr(j.HBLKSIZE),He;$/=G;var re=0,Le=0;for(He=0;He<j.CBANDS;He++){var Ye,be;for(Ye=Ge($*re),J[He]=$*re,be=re;Ge($*be)-Ye<s&&be<=G/2;be++);for(L[He]=be-re,Le=He+1;re<be;)fe[re++]=He;if(re>G/2){re=G/2,++He;break}}J[He]=$*re;for(var Ne=0;Ne<le;Ne++){var xe,qe,At,Fe,Ze;At=oe[Ne],Fe=oe[Ne+1],xe=0|Math.floor(.5+te*(At-.5)),xe<0&&(xe=0),qe=0|Math.floor(.5+te*(Fe-.5)),qe>G/2&&(qe=G/2),V[Ne]=(fe[xe]+fe[qe])/2,N[Ne]=fe[qe];var tt=ve*Fe;Z[Ne]=(tt-J[N[Ne]])/(J[N[Ne]+1]-J[N[Ne]]),Z[Ne]<0?Z[Ne]=0:Z[Ne]>1&&(Z[Ne]=1),Ze=Ge($*oe[Ne]*te),Ze=Math.min(Ze,15.5)/15.5,H[Ne]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Ze))-2.5)}re=0;for(var Mt=0;Mt<Le;Mt++){var on=L[Mt],Ye,Bt;Ye=Ge($*re),Bt=Ge($*(re+on-1)),q[Mt]=.5*(Ye+Bt),Ye=Ge($*(re-.5)),Bt=Ge($*(re+on-.5)),K[Mt]=Bt-Ye,re+=on}return Le}function we(L,N,V,q,K,H){var Z=mn([j.CBANDS,j.CBANDS]),$,G=0;if(H)for(var oe=0;oe<N;oe++)for($=0;$<N;$++){var te=Ve(V[oe]-V[$])*q[$];Z[oe][$]=te*K[oe]}else for($=0;$<N;$++)for(var le=15+Math.min(21/V[$],12),J=Pe(le),oe=0;oe<N;oe++){var te=J*je(V[oe]-V[$],le)*q[$];Z[oe][$]=te*K[oe]}for(var oe=0;oe<N;oe++){for($=0;$<N&&!(Z[oe][$]>0);$++);for(L[oe][0]=$,$=N-1;$>0&&!(Z[oe][$]>0);$--);L[oe][1]=$,G+=L[oe][1]-L[oe][0]+1}for(var ve=Ot(G),fe=0,oe=0;oe<N;oe++)for($=L[oe][0];$<=L[oe][1];$++)ve[fe++]=Z[oe][$];return ve}function ee(L){var N=Ge(L);return N=Math.min(N,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*N))-2.5)}this.psymodel_init=function(L){var N=L.internal_flags,V,q=!0,K=13,H=24,Z=0,$=0,G=-8.25,oe=-4.5,te=Ot(j.CBANDS),le=Ot(j.CBANDS),J=Ot(j.CBANDS),ve=L.out_samplerate;switch(L.experimentalZ){default:case 0:q=!0;break;case 1:q=!(L.VBR==ti.vbr_mtrh||L.VBR==ti.vbr_mt);break;case 2:q=!1;break;case 3:K=8,Z=-1.75,$=-.0125,G=-8.25,oe=-2.25;break}for(N.ms_ener_ratio_old=.25,N.blocktype_old[0]=N.blocktype_old[1]=j.NORM_TYPE,V=0;V<4;++V){for(var re=0;re<j.CBANDS;++re)N.nb_1[V][re]=1e20,N.nb_2[V][re]=1e20,N.nb_s1[V][re]=N.nb_s2[V][re]=1;for(var fe=0;fe<j.SBMAX_l;fe++)N.en[V].l[fe]=1e20,N.thm[V].l[fe]=1e20;for(var re=0;re<3;++re){for(var fe=0;fe<j.SBMAX_s;fe++)N.en[V].s[fe][re]=1e20,N.thm[V].s[fe][re]=1e20;N.nsPsy.lastAttacks[V]=0}for(var re=0;re<9;re++)N.nsPsy.last_en_subshort[V][re]=10}for(N.loudness_sq_save[0]=N.loudness_sq_save[1]=0,N.npart_l=ue(N.numlines_l,N.bo_l,N.bm_l,te,le,N.mld_l,N.PSY.bo_l_weight,ve,j.BLKSIZE,N.scalefac_band.l,j.BLKSIZE/(2*576),j.SBMAX_l),et(N.npart_l<j.CBANDS),V=0;V<N.npart_l;V++){var He=Z;te[V]>=K&&(He=$*(te[V]-K)/(H-K)+Z*(H-te[V])/(H-K)),J[V]=Math.pow(10,He/10),N.numlines_l[V]>0?N.rnumlines_l[V]=1/N.numlines_l[V]:N.rnumlines_l[V]=0}N.s3_ll=we(N.s3ind,N.npart_l,te,le,J,q);var re=0;for(V=0;V<N.npart_l;V++){var Le;Le=Zu.MAX_VALUE;for(var Ye=0;Ye<N.numlines_l[V];Ye++,re++){var be=ve*re/(1e3*j.BLKSIZE),Ne;Ne=this.ATHformula(be*1e3,L)-20,Ne=Math.pow(10,.1*Ne),Ne*=N.numlines_l[V],Le>Ne&&(Le=Ne)}N.ATH.cb_l[V]=Le,Le=-20+te[V]*20/10,Le>6&&(Le=100),Le<-15&&(Le=-15),Le-=8,N.minval_l[V]=Math.pow(10,Le/10)*N.numlines_l[V]}for(N.npart_s=ue(N.numlines_s,N.bo_s,N.bm_s,te,le,N.mld_s,N.PSY.bo_s_weight,ve,j.BLKSIZE_s,N.scalefac_band.s,j.BLKSIZE_s/(2*192),j.SBMAX_s),et(N.npart_s<j.CBANDS),re=0,V=0;V<N.npart_s;V++){var Le,He=G;te[V]>=K&&(He=oe*(te[V]-K)/(H-K)+G*(H-te[V])/(H-K)),J[V]=Math.pow(10,He/10),Le=Zu.MAX_VALUE;for(var Ye=0;Ye<N.numlines_s[V];Ye++,re++){var be=ve*re/(1e3*j.BLKSIZE_s),Ne;Ne=this.ATHformula(be*1e3,L)-20,Ne=Math.pow(10,.1*Ne),Ne*=N.numlines_s[V],Le>Ne&&(Le=Ne)}N.ATH.cb_s[V]=Le,Le=-7+te[V]*7/12,te[V]>12&&(Le*=1+Math.log(1+Le)*3.1),te[V]<12&&(Le*=1+Math.log(1-Le)*2.3),Le<-15&&(Le=-15),Le-=8,N.minval_s[V]=Math.pow(10,Le/10)*N.numlines_s[V]}N.s3_ss=we(N.s3ind_s,N.npart_s,te,le,J,q),S(),e.init_fft(N),N.decay=Math.exp(-1*t/(f*ve/192));{var xe;xe=b,(L.exp_nspsytune&2)!=0&&(xe=1),Math.abs(L.msfix)>0&&(xe=L.msfix),L.msfix=xe;for(var qe=0;qe<N.npart_l;qe++)N.s3ind[qe][1]>N.npart_l-1&&(N.s3ind[qe][1]=N.npart_l-1)}var At=576*N.mode_gr/ve;if(N.ATH.decay=Math.pow(10,-12/10*At),N.ATH.adjust=.01,N.ATH.adjustLimit=1,et(N.bo_l[j.SBMAX_l-1]<=N.npart_l),et(N.bo_s[j.SBMAX_s-1]<=N.npart_s),L.ATHtype!=-1){var be,Fe=L.out_samplerate/j.BLKSIZE,Ze=0;for(be=0,V=0;V<j.BLKSIZE/2;++V)be+=Fe,N.ATH.eql_w[V]=1/Math.pow(10,this.ATHformula(be,L)/10),Ze+=N.ATH.eql_w[V];for(Ze=1/Ze,V=j.BLKSIZE/2;--V>=0;)N.ATH.eql_w[V]*=Ze}{for(var qe=re=0;qe<N.npart_s;++qe)for(V=0;V<N.numlines_s[qe];++V)++re;for(var qe=re=0;qe<N.npart_l;++qe)for(V=0;V<N.numlines_l[qe];++V)++re}for(re=0,V=0;V<N.npart_l;V++){var be=ve*(re+N.numlines_l[V]/2)/(1*j.BLKSIZE);N.mld_cb_l[V]=ee(be),re+=N.numlines_l[V]}for(;V<j.CBANDS;++V)N.mld_cb_l[V]=1;for(re=0,V=0;V<N.npart_s;V++){var be=ve*(re+N.numlines_s[V]/2)/(1*j.BLKSIZE_s);N.mld_cb_s[V]=ee(be),re+=N.numlines_s[V]}for(;V<j.CBANDS;++V)N.mld_cb_s[V]=1;return 0};function Be(L,N){L<-.3&&(L=3410),L/=1e3,L=Math.max(.1,L);var V=3.64*Math.pow(L,-.8)-6.8*Math.exp(-.6*Math.pow(L-3.4,2))+6*Math.exp(-.15*Math.pow(L-8.7,2))+(.6+.04*N)*.001*Math.pow(L,4);return V}this.ATHformula=function(L,N){var V;switch(N.ATHtype){case 0:V=Be(L,9);break;case 1:V=Be(L,-1);break;case 2:V=Be(L,0);break;case 3:V=Be(L,1)+6;break;case 4:V=Be(L,N.ATHcurve);break;default:V=Be(L,0);break}return V}}function X3(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=ft.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var cr={};cr.SFBMAX=j.SBMAX_s*3;var Y3=Ie.new_float,Cr=Ie.new_int;function Ya(){this.xr=Y3(576),this.l3_enc=Cr(576),this.scalefac=Cr(cr.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=Cr(3),this.subblock_gain=Cr(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=Cr(cr.SFBMAX),this.window=Cr(cr.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=Cr(4),this.max_nonzero_coeff=0;var e=this;function t(r){return new Int32Array(r)}function n(r){return new Float32Array(r)}this.assign=function(r){e.xr=n(r.xr),e.l3_enc=t(r.l3_enc),e.scalefac=t(r.scalefac),e.xrpow_max=r.xrpow_max,e.part2_3_length=r.part2_3_length,e.big_values=r.big_values,e.count1=r.count1,e.global_gain=r.global_gain,e.scalefac_compress=r.scalefac_compress,e.block_type=r.block_type,e.mixed_block_flag=r.mixed_block_flag,e.table_select=t(r.table_select),e.subblock_gain=t(r.subblock_gain),e.region0_count=r.region0_count,e.region1_count=r.region1_count,e.preflag=r.preflag,e.scalefac_scale=r.scalefac_scale,e.count1table_select=r.count1table_select,e.part2_length=r.part2_length,e.sfb_lmax=r.sfb_lmax,e.sfb_smin=r.sfb_smin,e.psy_lmax=r.psy_lmax,e.sfbmax=r.sfbmax,e.psymax=r.psymax,e.sfbdivide=r.sfbdivide,e.width=t(r.width),e.window=t(r.window),e.count1bits=r.count1bits,e.sfb_partition_table=r.sfb_partition_table.slice(0),e.slen=t(r.slen),e.max_nonzero_coeff=r.max_nonzero_coeff}}var Qu=Ie.new_int;function K3(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Qu(4),Qu(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new Ya}var Ka=Ie.System,Ga=Ie.new_int;function Ln(e,t,n,r){this.l=Ga(1+j.SBMAX_l),this.s=Ga(1+j.SBMAX_s),this.psfb21=Ga(1+j.PSFB21),this.psfb12=Ga(1+j.PSFB12);var a=this.l,i=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Ka.arraycopy(this.arrL,0,a,0,Math.min(this.arrL.length,this.l.length)),Ka.arraycopy(this.arrS,0,i,0,Math.min(this.arrS.length,this.s.length)),Ka.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Ka.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var jo=Ie.new_float,G3=Ie.new_float_n,W3=Ie.new_int;function Z3(){this.last_en_subshort=G3([4,9]),this.lastAttacks=W3(4),this.pefirbuf=jo(19),this.longfact=jo(j.SBMAX_l),this.shortfact=jo(j.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function Q3(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var J3=Ie.new_byte,$3=Ie.new_double,hn=Ie.new_float,Ir=Ie.new_float_n,yn=Ie.new_int,Wa=Ie.new_int_n;ut.MFSIZE=3*1152+j.ENCDELAY-j.MDCTDELAY,ut.MAX_HEADER_BUF=256,ut.MAX_BITS_PER_CHANNEL=4095,ut.MAX_BITS_PER_GRANULE=7680,ut.BPC=320;function ut(){var e=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Ir([2,ut.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new K3,this.ms_ratio=hn(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=yn(2),this.CurrentStep=yn(2),this.masking_lower=0,this.bv_scf=yn(576),this.pseudohalf=yn(cr.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*ut.BPC+1),this.itime=$3(2),this.sideinfo_len=0,this.sb_sample=Ir([2,2,18,j.SBLIMIT]),this.amp_filter=hn(32);function t(){this.write_timing=0,this.ptr=0,this.buf=J3(e)}this.header=new Array(ut.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Ln,this.minval_l=hn(j.CBANDS),this.minval_s=hn(j.CBANDS),this.nb_1=Ir([4,j.CBANDS]),this.nb_2=Ir([4,j.CBANDS]),this.nb_s1=Ir([4,j.CBANDS]),this.nb_s2=Ir([4,j.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=hn(4),this.loudness_sq=Ir([2,2]),this.loudness_sq_save=hn(2),this.mld_l=hn(j.SBMAX_l),this.mld_s=hn(j.SBMAX_s),this.bm_l=yn(j.SBMAX_l),this.bo_l=yn(j.SBMAX_l),this.bm_s=yn(j.SBMAX_s),this.bo_s=yn(j.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Wa([j.CBANDS,2]),this.s3ind_s=Wa([j.CBANDS,2]),this.numlines_s=yn(j.CBANDS),this.numlines_l=yn(j.CBANDS),this.rnumlines_l=hn(j.CBANDS),this.mld_cb_l=hn(j.CBANDS),this.mld_cb_s=hn(j.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=hn(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=yn(2),this.nsPsy=new Z3,this.VBR_seek_table=new Q3,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Wa([16,4+1]),this.bitrate_blockType_Hist=Wa([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var n=0;n<this.en.length;n++)this.en[n]=new Ua;for(var n=0;n<this.thm.length;n++)this.thm[n]=new Ua;for(var n=0;n<this.header.length;n++)this.header[n]=new t}var Br=Ie.new_float;function e4(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Br(j.SBMAX_l),this.s=Br(j.SBMAX_s),this.psfb21=Br(j.PSFB21),this.psfb12=Br(j.PSFB12),this.cb_l=Br(j.CBANDS),this.cb_s=Br(j.CBANDS),this.eql_w=Br(j.BLKSIZE/2)}var Jt=Ie.System,Ju=Ie.Arrays;Ct.STEPS_per_dB=100,Ct.MAX_dB=120,Ct.GAIN_NOT_ENOUGH_SAMPLES=-24601,Ct.GAIN_ANALYSIS_ERROR=0,Ct.GAIN_ANALYSIS_OK=1,Ct.INIT_GAIN_ANALYSIS_ERROR=0,Ct.INIT_GAIN_ANALYSIS_OK=1,Ct.YULE_ORDER=10,Ct.MAX_ORDER=Ct.YULE_ORDER,Ct.MAX_SAMP_FREQ=48e3,Ct.RMS_WINDOW_TIME_NUMERATOR=1,Ct.RMS_WINDOW_TIME_DENOMINATOR=20,Ct.MAX_SAMPLES_PER_WINDOW=Ct.MAX_SAMP_FREQ*Ct.RMS_WINDOW_TIME_NUMERATOR/Ct.RMS_WINDOW_TIME_DENOMINATOR+1;function Ct(){var e=64.82,t=.95,n=Ct.RMS_WINDOW_TIME_NUMERATOR,r=Ct.RMS_WINDOW_TIME_DENOMINATOR,a=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],i=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function s(c,b,_,o,B,T){for(;B--!=0;)_[o]=1e-10+c[b+0]*T[0]-_[o-1]*T[1]+c[b-1]*T[2]-_[o-2]*T[3]+c[b-2]*T[4]-_[o-3]*T[5]+c[b-3]*T[6]-_[o-4]*T[7]+c[b-4]*T[8]-_[o-5]*T[9]+c[b-5]*T[10]-_[o-6]*T[11]+c[b-6]*T[12]-_[o-7]*T[13]+c[b-7]*T[14]-_[o-8]*T[15]+c[b-8]*T[16]-_[o-9]*T[17]+c[b-9]*T[18]-_[o-10]*T[19]+c[b-10]*T[20],++o,++b}function l(c,b,_,o,B,T){for(;B--!=0;)_[o]=c[b+0]*T[0]-_[o-1]*T[1]+c[b-1]*T[2]-_[o-2]*T[3]+c[b-2]*T[4],++o,++b}function f(c,b){for(var _=0;_<MAX_ORDER;_++)c.linprebuf[_]=c.lstepbuf[_]=c.loutbuf[_]=c.rinprebuf[_]=c.rstepbuf[_]=c.routbuf[_]=0;switch(0|b){case 48e3:c.reqindex=0;break;case 44100:c.reqindex=1;break;case 32e3:c.reqindex=2;break;case 24e3:c.reqindex=3;break;case 22050:c.reqindex=4;break;case 16e3:c.reqindex=5;break;case 12e3:c.reqindex=6;break;case 11025:c.reqindex=7;break;case 8e3:c.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return c.sampleWindow=0|(b*n+r-1)/r,c.lsum=0,c.rsum=0,c.totsamp=0,Ju.ill(c.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(c,b){return f(c,b)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(c.linpre=MAX_ORDER,c.rinpre=MAX_ORDER,c.lstep=MAX_ORDER,c.rstep=MAX_ORDER,c.lout=MAX_ORDER,c.rout=MAX_ORDER,Ju.fill(c.B,0),INIT_GAIN_ANALYSIS_OK)};function u(c){return c*c}this.AnalyzeSamples=function(c,b,_,o,B,T,C){var p,A,F,R,I,h,M;if(T==0)return GAIN_ANALYSIS_OK;switch(M=0,I=T,C){case 1:o=b,B=_;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(T<MAX_ORDER?(Jt.arraycopy(b,_,c.linprebuf,MAX_ORDER,T),Jt.arraycopy(o,B,c.rinprebuf,MAX_ORDER,T)):(Jt.arraycopy(b,_,c.linprebuf,MAX_ORDER,MAX_ORDER),Jt.arraycopy(o,B,c.rinprebuf,MAX_ORDER,MAX_ORDER));I>0;){h=I>c.sampleWindow-c.totsamp?c.sampleWindow-c.totsamp:I,M<MAX_ORDER?(p=c.linpre+M,A=c.linprebuf,F=c.rinpre+M,R=c.rinprebuf,h>MAX_ORDER-M&&(h=MAX_ORDER-M)):(p=_+M,A=b,F=B+M,R=o),s(A,p,c.lstepbuf,c.lstep+c.totsamp,h,a[c.reqindex]),s(R,F,c.rstepbuf,c.rstep+c.totsamp,h,a[c.reqindex]),l(c.lstepbuf,c.lstep+c.totsamp,c.loutbuf,c.lout+c.totsamp,h,i[c.reqindex]),l(c.rstepbuf,c.rstep+c.totsamp,c.routbuf,c.rout+c.totsamp,h,i[c.reqindex]),p=c.lout+c.totsamp,A=c.loutbuf,F=c.rout+c.totsamp,R=c.routbuf;for(var S=h%8;S--!=0;)c.lsum+=u(A[p++]),c.rsum+=u(R[F++]);for(S=h/8;S--!=0;)c.lsum+=u(A[p+0])+u(A[p+1])+u(A[p+2])+u(A[p+3])+u(A[p+4])+u(A[p+5])+u(A[p+6])+u(A[p+7]),p+=8,c.rsum+=u(R[F+0])+u(R[F+1])+u(R[F+2])+u(R[F+3])+u(R[F+4])+u(R[F+5])+u(R[F+6])+u(R[F+7]),F+=8;if(I-=h,M+=h,c.totsamp+=h,c.totsamp==c.sampleWindow){var v=Ct.STEPS_per_dB*10*Math.log10((c.lsum+c.rsum)/c.totsamp*.5+1e-37),y=v<=0?0:0|v;y>=c.A.length&&(y=c.A.length-1),c.A[y]++,c.lsum=c.rsum=0,Jt.arraycopy(c.loutbuf,c.totsamp,c.loutbuf,0,MAX_ORDER),Jt.arraycopy(c.routbuf,c.totsamp,c.routbuf,0,MAX_ORDER),Jt.arraycopy(c.lstepbuf,c.totsamp,c.lstepbuf,0,MAX_ORDER),Jt.arraycopy(c.rstepbuf,c.totsamp,c.rstepbuf,0,MAX_ORDER),c.totsamp=0}if(c.totsamp>c.sampleWindow)return GAIN_ANALYSIS_ERROR}return T<MAX_ORDER?(Jt.arraycopy(c.linprebuf,T,c.linprebuf,0,MAX_ORDER-T),Jt.arraycopy(c.rinprebuf,T,c.rinprebuf,0,MAX_ORDER-T),Jt.arraycopy(b,_,c.linprebuf,MAX_ORDER-T,T),Jt.arraycopy(o,B,c.rinprebuf,MAX_ORDER-T,T)):(Jt.arraycopy(b,_+T-MAX_ORDER,c.linprebuf,0,MAX_ORDER),Jt.arraycopy(o,B+T-MAX_ORDER,c.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function m(c,b){var _,o=0;for(_=0;_<b;_++)o+=c[_];if(o==0)return GAIN_NOT_ENOUGH_SAMPLES;var B=0|Math.ceil(o*(1-t));for(_=b;_-- >0&&!((B-=c[_])<=0););return e-_/Ct.STEPS_per_dB}this.GetTitleGain=function(c){for(var b=m(c.A,c.A.length),_=0;_<c.A.length;_++)c.B[_]+=c.A[_],c.A[_]=0;for(var _=0;_<MAX_ORDER;_++)c.linprebuf[_]=c.lstepbuf[_]=c.loutbuf[_]=c.rinprebuf[_]=c.rstepbuf[_]=c.routbuf[_]=0;return c.totsamp=0,c.lsum=c.rsum=0,b}}var ri=Ie.new_float,$u=Ie.new_int;function t4(){this.linprebuf=ri(void 0*2),this.linpre=0,this.lstepbuf=ri(void 0+void 0),this.lstep=0,this.loutbuf=ri(void 0+void 0),this.lout=0,this.rinprebuf=ri(void 0*2),this.rinpre=0,this.rstepbuf=ri(void 0+void 0),this.rstep=0,this.routbuf=ri(void 0+void 0),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=$u(0|void 0*void 0),this.B=$u(0|void 0*void 0)}function e1(e){this.bits=e}var t1=Ie.new_float,n4=Ie.new_int,n1=Ie.assert;function r4(e){var t=e;this.quantize=t,this.iteration_loop=function(n,r,a,i){var s=n.internal_flags,l=t1(cr.SFBMAX),f=t1(576),u=n4(2),m=0,c,b=s.l3_side,_=new e1(m);this.quantize.rv.ResvFrameBegin(n,_),m=_.bits;for(var o=0;o<s.mode_gr;o++){c=this.quantize.qupvt.on_pe(n,r,u,m,o,o),s.mode_ext==j.MPG_MD_MS_LR&&(this.quantize.ms_convert(s.l3_side,o),this.quantize.qupvt.reduce_side(u,a[o],m,c));for(var B=0;B<s.channels_out;B++){var T,C,p=b.tt[o][B];p.block_type!=j.SHORT_TYPE?(T=0,C=s.PSY.mask_adjust-T):(T=0,C=s.PSY.mask_adjust_short-T),s.masking_lower=Math.pow(10,C*.1),this.quantize.init_outer_loop(s,p),this.quantize.init_xrpow(s,p,f)&&(this.quantize.qupvt.calc_xmin(n,i[o][B],p,l),this.quantize.outer_loop(n,p,l,f,B,u[B])),this.quantize.iteration_finish_one(s,o,B),n1(p.part2_3_length<=ut.MAX_BITS_PER_CHANNEL),n1(p.part2_3_length<=u[B])}}this.quantize.rv.ResvFrameEnd(s,m)}}function ct(e,t,n,r){this.xlen=e,this.linmax=t,this.table=n,this.hlen=r}var ae={};ae.t1HB=[1,1,1,0],ae.t2HB=[1,2,1,3,1,1,3,2,0],ae.t3HB=[3,2,1,1,1,1,3,2,0],ae.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],ae.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],ae.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],ae.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],ae.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],ae.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],ae.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],ae.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],ae.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],ae.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],ae.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],ae.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],ae.t32HB=[1<<0,5<<1,4<<1,5<<2,6<<1,5<<2,4<<2,4<<3,7<<1,3<<2,6<<2,0<<3,7<<2,2<<3,3<<3,1<<4],ae.t33HB=[15<<0,14<<1,13<<1,12<<2,11<<1,10<<2,9<<2,8<<3,7<<1,6<<2,5<<2,4<<3,3<<2,2<<3,1<<3,0<<4],ae.t1l=[1,4,3,5],ae.t2l=[1,4,7,4,5,7,6,7,8],ae.t3l=[2,3,7,4,4,7,6,7,8],ae.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],ae.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],ae.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],ae.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],ae.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],ae.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],ae.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],ae.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],ae.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],ae.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],ae.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],ae.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],ae.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],ae.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4],ae.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4],ae.ht=[new ct(0,0,null,null),new ct(2,0,ae.t1HB,ae.t1l),new ct(3,0,ae.t2HB,ae.t2l),new ct(3,0,ae.t3HB,ae.t3l),new ct(0,0,null,null),new ct(4,0,ae.t5HB,ae.t5l),new ct(4,0,ae.t6HB,ae.t6l),new ct(6,0,ae.t7HB,ae.t7l),new ct(6,0,ae.t8HB,ae.t8l),new ct(6,0,ae.t9HB,ae.t9l),new ct(8,0,ae.t10HB,ae.t10l),new ct(8,0,ae.t11HB,ae.t11l),new ct(8,0,ae.t12HB,ae.t12l),new ct(16,0,ae.t13HB,ae.t13l),new ct(0,0,null,ae.t16_5l),new ct(16,0,ae.t15HB,ae.t15l),new ct(1,1,ae.t16HB,ae.t16l),new ct(2,3,ae.t16HB,ae.t16l),new ct(3,7,ae.t16HB,ae.t16l),new ct(4,15,ae.t16HB,ae.t16l),new ct(6,63,ae.t16HB,ae.t16l),new ct(8,255,ae.t16HB,ae.t16l),new ct(10,1023,ae.t16HB,ae.t16l),new ct(13,8191,ae.t16HB,ae.t16l),new ct(4,15,ae.t24HB,ae.t24l),new ct(5,31,ae.t24HB,ae.t24l),new ct(6,63,ae.t24HB,ae.t24l),new ct(7,127,ae.t24HB,ae.t24l),new ct(8,255,ae.t24HB,ae.t24l),new ct(9,511,ae.t24HB,ae.t24l),new ct(11,2047,ae.t24HB,ae.t24l),new ct(13,8191,ae.t24HB,ae.t24l),new ct(0,0,ae.t32HB,ae.t32l),new ct(0,0,ae.t33HB,ae.t33l)],ae.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],ae.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],ae.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],ae.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],ae.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],ae.scfsi_band=[0,6,11,16,21];var Or=Ie.VbrMode,Za=Ie.Float,No=Ie.Util,Lr=Ie.new_float,i4=Ie.new_int,Di=Ie.assert;Vt.Q_MAX=256+1,Vt.Q_MAX2=116,Vt.LARGE_BITS=1e5,Vt.IXMAX_VAL=8206;function Vt(){var e=null,t=null,n=null;this.setModules=function(p,A,F){e=p,t=A,n=F};function r(p){return c[p+Vt.Q_MAX2]}this.IPOW20=function(p){return b[p]};var a=2220446049250313e-31,i=Vt.IXMAX_VAL,s=i+2,l=Vt.Q_MAX,f=Vt.Q_MAX2,u=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var m=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=m,this.sfBandIndex=[new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Ln([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var c=Lr(l+f+1),b=Lr(l),_=Lr(s),o=Lr(s);this.adj43=o;function B(p,A){var F=n.ATHformula(A,p);return F-=u,F=Math.pow(10,F/10+p.ATHlower),F}function T(p){for(var A=p.internal_flags.ATH.l,F=p.internal_flags.ATH.psfb21,R=p.internal_flags.ATH.s,I=p.internal_flags.ATH.psfb12,h=p.internal_flags,M=p.out_samplerate,S=0;S<j.SBMAX_l;S++){var v=h.scalefac_band.l[S],y=h.scalefac_band.l[S+1];A[S]=Za.MAX_VALUE;for(var x=v;x<y;x++){var w=x*M/1152,k=B(p,w);A[S]=Math.min(A[S],k)}}for(var S=0;S<j.PSFB21;S++){var v=h.scalefac_band.psfb21[S],y=h.scalefac_band.psfb21[S+1];F[S]=Za.MAX_VALUE;for(var x=v;x<y;x++){var w=x*M/1152,k=B(p,w);F[S]=Math.min(F[S],k)}}for(var S=0;S<j.SBMAX_s;S++){var v=h.scalefac_band.s[S],y=h.scalefac_band.s[S+1];R[S]=Za.MAX_VALUE;for(var x=v;x<y;x++){var w=x*M/384,k=B(p,w);R[S]=Math.min(R[S],k)}R[S]*=h.scalefac_band.s[S+1]-h.scalefac_band.s[S]}for(var S=0;S<j.PSFB12;S++){var v=h.scalefac_band.psfb12[S],y=h.scalefac_band.psfb12[S+1];I[S]=Za.MAX_VALUE;for(var x=v;x<y;x++){var w=x*M/384,k=B(p,w);I[S]=Math.min(I[S],k)}I[S]*=h.scalefac_band.s[13]-h.scalefac_band.s[12]}if(p.noATH){for(var S=0;S<j.SBMAX_l;S++)A[S]=1e-20;for(var S=0;S<j.PSFB21;S++)F[S]=1e-20;for(var S=0;S<j.SBMAX_s;S++)R[S]=1e-20;for(var S=0;S<j.PSFB12;S++)I[S]=1e-20}h.ATH.floor=10*Math.log10(B(p,-1))}this.iteration_init=function(p){var A=p.internal_flags,F=A.l3_side,R;if(A.iteration_init_init==0){for(A.iteration_init_init=1,F.main_data_begin=0,T(p),_[0]=0,R=1;R<s;R++)_[R]=Math.pow(R,4/3);for(R=0;R<s-1;R++)o[R]=R+1-Math.pow(.5*(_[R]+_[R+1]),.75);for(o[R]=.5,R=0;R<l;R++)b[R]=Math.pow(2,(R-210)*-.1875);for(R=0;R<=l+f;R++)c[R]=Math.pow(2,(R-210-f)*.25);e.huffman_init(A);{var I,h,M,S;for(R=p.exp_nspsytune>>2&63,R>=32&&(R-=64),I=Math.pow(10,R/4/10),R=p.exp_nspsytune>>8&63,R>=32&&(R-=64),h=Math.pow(10,R/4/10),R=p.exp_nspsytune>>14&63,R>=32&&(R-=64),M=Math.pow(10,R/4/10),R=p.exp_nspsytune>>20&63,R>=32&&(R-=64),S=M*Math.pow(10,R/4/10),R=0;R<j.SBMAX_l;R++){var v;R<=6?v=I:R<=13?v=h:R<=20?v=M:v=S,A.nsPsy.longfact[R]=v}for(R=0;R<j.SBMAX_s;R++){var v;R<=5?v=I:R<=10?v=h:R<=11?v=M:v=S,A.nsPsy.shortfact[R]=v}}}},this.on_pe=function(p,A,F,R,I,h){var M=p.internal_flags,S=0,v,y=i4(2),x,w=new e1(S),k=t.ResvMaxBits(p,R,w,h);S=w.bits;var g=S+k;for(g>ut.MAX_BITS_PER_GRANULE&&(g=ut.MAX_BITS_PER_GRANULE),v=0,x=0;x<M.channels_out;++x)F[x]=Math.min(ut.MAX_BITS_PER_CHANNEL,S/M.channels_out),y[x]=0|F[x]*A[I][x]/700-F[x],y[x]>R*3/4&&(y[x]=R*3/4),y[x]<0&&(y[x]=0),y[x]+F[x]>ut.MAX_BITS_PER_CHANNEL&&(y[x]=Math.max(0,ut.MAX_BITS_PER_CHANNEL-F[x])),v+=y[x];if(v>k)for(x=0;x<M.channels_out;++x)y[x]=k*y[x]/v;for(x=0;x<M.channels_out;++x)F[x]+=y[x],k-=y[x];for(v=0,x=0;x<M.channels_out;++x)v+=F[x];if(v>ut.MAX_BITS_PER_GRANULE){var D=0;for(x=0;x<M.channels_out;++x)F[x]*=ut.MAX_BITS_PER_GRANULE,F[x]/=v,D+=F[x]}return g},this.reduce_side=function(p,A,F,R){Di(p[0]+p[1]<=ut.MAX_BITS_PER_GRANULE);var I=.33*(.5-A)/.5;I<0&&(I=0),I>.5&&(I=.5);var h=0|I*.5*(p[0]+p[1]);h>ut.MAX_BITS_PER_CHANNEL-p[0]&&(h=ut.MAX_BITS_PER_CHANNEL-p[0]),h<0&&(h=0),p[1]>=125&&(p[1]-h>125?(p[0]<F&&(p[0]+=h),p[1]-=h):(p[0]+=p[1]-125,p[1]=125)),h=p[0]+p[1],h>R&&(p[0]=R*p[0]/h,p[1]=R*p[1]/h),Di(p[0]<=ut.MAX_BITS_PER_CHANNEL),Di(p[1]<=ut.MAX_BITS_PER_CHANNEL),Di(p[0]+p[1]<=ut.MAX_BITS_PER_GRANULE)},this.athAdjust=function(p,A,F){var R=90.30873362,I=94.82444863,h=No.FAST_LOG10_X(A,10),M=p*p,S=0;return h-=F,M>1e-20&&(S=1+No.FAST_LOG10_X(M,10/R)),S<0&&(S=0),h*=S,h+=F+R-I,Math.pow(10,.1*h)},this.calc_xmin=function(p,A,F,R){var I=0,h=p.internal_flags,M,S=0,v=0,y=h.ATH,x=F.xr,w=p.VBR==Or.vbr_mtrh?1:0,k=h.masking_lower;for((p.VBR==Or.vbr_mtrh||p.VBR==Or.vbr_mt)&&(k=1),M=0;M<F.psy_lmax;M++){var g,D,Y,z,U,d;p.VBR==Or.vbr_rh||p.VBR==Or.vbr_mtrh?D=athAdjust(y.adjust,y.l[M],y.floor):D=y.adjust*y.l[M],U=F.width[M],Y=D/U,z=a,d=U>>1,g=0;do{var E,W;E=x[S]*x[S],g+=E,z+=E<Y?E:Y,S++,W=x[S]*x[S],g+=W,z+=W<Y?W:Y,S++}while(--d>0);if(g>D&&v++,M==j.SBPSY_l){var O=D*h.nsPsy.longfact[M];z<O&&(z=O)}if(w!=0&&(D=z),!p.ATHonly){var me=A.en.l[M];if(me>0){var O;O=g*A.thm.l[M]*k/me,w!=0&&(O*=h.nsPsy.longfact[M]),D<O&&(D=O)}}w!=0?R[I++]=D:R[I++]=D*h.nsPsy.longfact[M]}var Se=575;if(F.block_type!=j.SHORT_TYPE)for(var _e=576;_e--!=0&&vn.EQ(x[_e],0);)Se=_e;F.max_nonzero_coeff=Se;for(var pe=F.sfb_smin;M<F.psymax;pe++,M+=3){var U,De,Ce;for(p.VBR==Or.vbr_rh||p.VBR==Or.vbr_mtrh?Ce=athAdjust(y.adjust,y.s[pe],y.floor):Ce=y.adjust*y.s[pe],U=F.width[M],De=0;De<3;De++){var g=0,D,Y,z,d=U>>1;Y=Ce/U,z=a;do{var E,W;E=x[S]*x[S],g+=E,z+=E<Y?E:Y,S++,W=x[S]*x[S],g+=W,z+=W<Y?W:Y,S++}while(--d>0);if(g>Ce&&v++,pe==j.SBPSY_s){var O=Ce*h.nsPsy.shortfact[pe];z<O&&(z=O)}if(w!=0?D=z:D=Ce,!p.ATHonly&&!p.ATHshort){var me=A.en.s[pe][De];if(me>0){var O;O=g*A.thm.s[pe][De]*k/me,w!=0&&(O*=h.nsPsy.shortfact[pe]),D<O&&(D=O)}}w!=0?R[I++]=D:R[I++]=D*h.nsPsy.shortfact[pe]}p.useTemporal&&(R[I-3]>R[I-3+1]&&(R[I-3+1]+=(R[I-3]-R[I-3+1])*h.decay),R[I-3+1]>R[I-3+2]&&(R[I-3+2]+=(R[I-3+1]-R[I-3+2])*h.decay))}return v};function C(p){this.s=p}this.calc_noise_core=function(p,A,F,R){var I=0,h=A.s,M=p.l3_enc;if(h>p.count1)for(;F--!=0;){var S;S=p.xr[h],h++,I+=S*S,S=p.xr[h],h++,I+=S*S}else if(h>p.big_values){var v=Lr(2);for(v[0]=0,v[1]=R;F--!=0;){var S;S=Math.abs(p.xr[h])-v[M[h]],h++,I+=S*S,S=Math.abs(p.xr[h])-v[M[h]],h++,I+=S*S}}else for(;F--!=0;){var S;S=Math.abs(p.xr[h])-_[M[h]]*R,h++,I+=S*S,S=Math.abs(p.xr[h])-_[M[h]]*R,h++,I+=S*S}return A.s=h,I},this.calc_noise=function(p,A,F,R,I){var h=0,M=0,S,v,y=0,x=0,w=0,k=-20,g=0,D=p.scalefac,Y=0;for(R.over_SSD=0,S=0;S<p.psymax;S++){var z=p.global_gain-(D[Y++]+(p.preflag!=0?m[S]:0)<<p.scalefac_scale+1)-p.subblock_gain[p.window[S]]*8,U=0;if(I!=null&&I.step[S]==z)U=I.noise[S],g+=p.width[S],F[h++]=U/A[M++],U=I.noise_log[S];else{var d=r(z);if(v=p.width[S]>>1,g+p.width[S]>p.max_nonzero_coeff){var E;E=p.max_nonzero_coeff-g+1,E>0?v=E>>1:v=0}var W=new C(g);U=this.calc_noise_core(p,W,v,d),g=W.s,I!=null&&(I.step[S]=z,I.noise[S]=U),U=F[h++]=U/A[M++],U=No.FAST_LOG10(Math.max(U,1e-20)),I!=null&&(I.noise_log[S]=U)}if(I!=null&&(I.global_gain=p.global_gain),w+=U,U>0){var O;O=Math.max(0|U*10+.5,1),R.over_SSD+=O*O,y++,x+=U}k=Math.max(k,U)}return R.over_count=y,R.tot_noise=w,R.over_noise=x,R.max_noise=k,y},this.set_pinfo=function(p,A,F,R,I){var h=p.internal_flags,M,S,v,y,x,w=A.scalefac_scale==0?.5:1,k=A.scalefac,g=Lr(L3Side.SFBMAX),D=Lr(L3Side.SFBMAX),Y=new CalcNoiseResult;calc_xmin(p,F,A,g),calc_noise(A,g,D,Y,null);var z=0;for(S=A.sfb_lmax,A.block_type!=j.SHORT_TYPE&&A.mixed_block_flag==0&&(S=22),M=0;M<S;M++){var U=h.scalefac_band.l[M],d=h.scalefac_band.l[M+1],E=d-U;for(y=0;z<d;z++)y+=A.xr[z]*A.xr[z];y/=E,x=1e15,h.pinfo.en[R][I][M]=x*y,h.pinfo.xfsf[R][I][M]=x*g[M]*D[M]/E,F.en.l[M]>0&&!p.ATHonly?y=y/F.en.l[M]:y=0,h.pinfo.thr[R][I][M]=x*Math.max(y*F.thm.l[M],h.ATH.l[M]),h.pinfo.LAMEsfb[R][I][M]=0,A.preflag!=0&&M>=11&&(h.pinfo.LAMEsfb[R][I][M]=-w*m[M]),M<j.SBPSY_l&&(Di(k[M]>=0),h.pinfo.LAMEsfb[R][I][M]-=w*k[M])}if(A.block_type==j.SHORT_TYPE)for(S=M,M=A.sfb_smin;M<j.SBMAX_s;M++)for(var U=h.scalefac_band.s[M],d=h.scalefac_band.s[M+1],E=d-U,W=0;W<3;W++){for(y=0,v=U;v<d;v++)y+=A.xr[z]*A.xr[z],z++;y=Math.max(y/E,1e-20),x=1e15,h.pinfo.en_s[R][I][3*M+W]=x*y,h.pinfo.xfsf_s[R][I][3*M+W]=x*g[S]*D[S]/E,F.en.s[M][W]>0?y=y/F.en.s[M][W]:y=0,(p.ATHonly||p.ATHshort)&&(y=0),h.pinfo.thr_s[R][I][3*M+W]=x*Math.max(y*F.thm.s[M][W],h.ATH.s[M]),h.pinfo.LAMEsfb_s[R][I][3*M+W]=-2*A.subblock_gain[W],M<j.SBPSY_s&&(h.pinfo.LAMEsfb_s[R][I][3*M+W]-=w*k[S]),S++}h.pinfo.LAMEqss[R][I]=A.global_gain,h.pinfo.LAMEmainbits[R][I]=A.part2_3_length+A.part2_length,h.pinfo.LAMEsfbits[R][I]=A.part2_length,h.pinfo.over[R][I]=Y.over_count,h.pinfo.max_noise[R][I]=Y.max_noise*10,h.pinfo.over_noise[R][I]=Y.over_noise*10,h.pinfo.tot_noise[R][I]=Y.tot_noise*10,h.pinfo.over_SSD[R][I]=Y.over_SSD}}var a4=Ie.System,s4=Ie.Arrays,Hi=Ie.new_int,Do=Ie.assert;function zi(){var e=null;this.qupvt=null,this.setModules=function(v){this.qupvt=v,e=v};function t(v){this.bits=0|v}var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function r(v,y,x,w,k,g){var D=.5946/y;for(v=v>>1;v--!=0;)k[g++]=D>x[w++]?0:1,k[g++]=D>x[w++]?0:1}function a(v,y,x,w,k,g){v=v>>1;var D=v%2;for(v=v>>1;v--!=0;){var Y,z,U,d,E,W,O,me;Y=x[w++]*y,z=x[w++]*y,E=0|Y,U=x[w++]*y,W=0|z,d=x[w++]*y,O=0|U,Y+=e.adj43[E],me=0|d,z+=e.adj43[W],k[g++]=0|Y,U+=e.adj43[O],k[g++]=0|z,d+=e.adj43[me],k[g++]=0|U,k[g++]=0|d}if(D!=0){var Y,z,E,W;Y=x[w++]*y,z=x[w++]*y,E=0|Y,W=0|z,Y+=e.adj43[E],z+=e.adj43[W],k[g++]=0|Y,k[g++]=0|z}}function i(v,y,x,w,k){var g,D,Y=0,z,U=0,d=0,E=0,W=y,O=0,me=W,Se=0,_e=v,pe=0;for(z=k!=null&&w.global_gain==k.global_gain,w.block_type==j.SHORT_TYPE?D=38:D=21,g=0;g<=D;g++){var De=-1;if((z||w.block_type==j.NORM_TYPE)&&(De=w.global_gain-(w.scalefac[g]+(w.preflag!=0?e.pretab[g]:0)<<w.scalefac_scale+1)-w.subblock_gain[w.window[g]]*8),Do(w.width[g]>=0),z&&k.step[g]==De)U!=0&&(a(U,x,_e,pe,me,Se),U=0),d!=0&&(r(d,x,_e,pe,me,Se),d=0);else{var Ce=w.width[g];if(Y+w.width[g]>w.max_nonzero_coeff){var he;he=w.max_nonzero_coeff-Y+1,s4.fill(y,w.max_nonzero_coeff,576,0),Ce=he,Ce<0&&(Ce=0),g=D+1}if(U==0&&d==0&&(me=W,Se=O,_e=v,pe=E),k!=null&&k.sfb_count1>0&&g>=k.sfb_count1&&k.step[g]>0&&De>=k.step[g]?(U!=0&&(a(U,x,_e,pe,me,Se),U=0,me=W,Se=O,_e=v,pe=E),d+=Ce):(d!=0&&(r(d,x,_e,pe,me,Se),d=0,me=W,Se=O,_e=v,pe=E),U+=Ce),Ce<=0){d!=0&&(r(d,x,_e,pe,me,Se),d=0),U!=0&&(a(U,x,_e,pe,me,Se),U=0);break}}g<=D&&(O+=w.width[g],E+=w.width[g],Y+=w.width[g])}U!=0&&(a(U,x,_e,pe,me,Se),U=0),d!=0&&(r(d,x,_e,pe,me,Se),d=0)}function s(v,y,x){var w=0,k=0;do{var g=v[y++],D=v[y++];w<g&&(w=g),k<D&&(k=D)}while(y<x);return w<k&&(w=k),w}function l(v,y,x,w,k,g){var D=ae.ht[w].xlen*65536+ae.ht[k].xlen,Y=0,z;do{var U=v[y++],d=v[y++];U!=0&&(U>14&&(U=15,Y+=D),U*=16),d!=0&&(d>14&&(d=15,Y+=D),U+=d),Y+=ae.largetbl[U]}while(y<x);return z=Y&65535,Y>>=16,Y>z&&(Y=z,w=k),g.bits+=Y,w}function f(v,y,x,w){var k=0,g=ae.ht[1].hlen;do{var D=v[y+0]*2+v[y+1];y+=2,k+=g[D]}while(y<x);return w.bits+=k,1}function u(v,y,x,w,k){var g=0,D,Y=ae.ht[w].xlen,z;w==2?z=ae.table23:z=ae.table56;do{var U=v[y+0]*Y+v[y+1];y+=2,g+=z[U]}while(y<x);return D=g&65535,g>>=16,g>D&&(g=D,w++),k.bits+=g,w}function m(v,y,x,w,k){var g=0,D=0,Y=0,z=ae.ht[w].xlen,U=ae.ht[w].hlen,d=ae.ht[w+1].hlen,E=ae.ht[w+2].hlen;do{var W=v[y+0]*z+v[y+1];y+=2,g+=U[W],D+=d[W],Y+=E[W]}while(y<x);var O=w;return g>D&&(g=D,O++),g>Y&&(g=Y,O=w+2),k.bits+=g,O}var c=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function b(v,y,x,w){var k=s(v,y,x);switch(k){case 0:return k;case 1:return f(v,y,x,w);case 2:case 3:return u(v,y,x,c[k-1],w);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return m(v,y,x,c[k-1],w);default:if(k>Vt.IXMAX_VAL)return w.bits=Vt.LARGE_BITS,-1;k-=15;var g;for(g=24;g<32&&!(ae.ht[g].linmax>=k);g++);var D;for(D=g-8;D<24&&!(ae.ht[D].linmax>=k);D++);return l(v,y,x,D,g,w)}}this.noquant_count_bits=function(v,y,x){var w=y.l3_enc,k=Math.min(576,y.max_nonzero_coeff+2>>1<<1);for(x!=null&&(x.sfb_count1=0);k>1&&(w[k-1]|w[k-2])==0;k-=2);y.count1=k;for(var g=0,D=0;k>3;k-=4){var Y;if(((w[k-1]|w[k-2]|w[k-3]|w[k-4])&2147483647)>1)break;Y=((w[k-4]*2+w[k-3])*2+w[k-2])*2+w[k-1],g+=ae.t32l[Y],D+=ae.t33l[Y]}var z=g;if(y.count1table_select=0,g>D&&(z=D,y.count1table_select=1),y.count1bits=z,y.big_values=k,k==0)return z;if(y.block_type==j.SHORT_TYPE)g=3*v.scalefac_band.s[3],g>y.big_values&&(g=y.big_values),D=y.big_values;else if(y.block_type==j.NORM_TYPE){if(g=y.region0_count=v.bv_scf[k-2],D=y.region1_count=v.bv_scf[k-1],D=v.scalefac_band.l[g+D+2],g=v.scalefac_band.l[g+1],D<k){var U=new t(z);y.table_select[2]=b(w,D,k,U),z=U.bits}}else y.region0_count=7,y.region1_count=j.SBMAX_l-1-7-1,g=v.scalefac_band.l[7+1],D=k,g>D&&(g=D);if(g=Math.min(g,k),D=Math.min(D,k),g>0){var U=new t(z);y.table_select[0]=b(w,0,g,U),z=U.bits}if(g<D){var U=new t(z);y.table_select[1]=b(w,g,D,U),z=U.bits}if(v.use_best_huffman==2&&(y.part2_3_length=z,best_huffman_divide(v,y),z=y.part2_3_length),x!=null&&y.block_type==j.NORM_TYPE){for(var d=0;v.scalefac_band.l[d]<y.big_values;)d++;x.sfb_count1=d}return z},this.count_bits=function(v,y,x,w){var k=x.l3_enc,g=Vt.IXMAX_VAL/e.IPOW20(x.global_gain);if(x.xrpow_max>g)return Vt.LARGE_BITS;if(i(y,k,e.IPOW20(x.global_gain),x,w),(v.substep_shaping&2)!=0)for(var D=0,Y=x.global_gain+x.scalefac_scale,z=.634521682242439/e.IPOW20(Y),U=0;U<x.sfbmax;U++){var d=x.width[U];if(v.pseudohalf[U]==0)D+=d;else{var E;for(E=D,D+=d;E<D;++E)k[E]=y[E]>=z?k[E]:0}}return this.noquant_count_bits(v,x,w)};function _(v,y,x,w,k,g,D){for(var Y=y.big_values,z=0;z<=7+15;z++)w[z]=Vt.LARGE_BITS;for(var z=0;z<16;z++){var U=v.scalefac_band.l[z+1];if(U>=Y)break;var d=0,E=new t(d),W=b(x,0,U,E);d=E.bits;for(var O=0;O<8;O++){var me=v.scalefac_band.l[z+O+2];if(me>=Y)break;var Se=d;E=new t(Se);var _e=b(x,U,me,E);Se=E.bits,w[z+O]>Se&&(w[z+O]=Se,k[z+O]=z,g[z+O]=W,D[z+O]=_e)}}}function o(v,y,x,w,k,g,D,Y){for(var z=y.big_values,U=2;U<j.SBMAX_l+1;U++){var d=v.scalefac_band.l[U];if(d>=z)break;var E=k[U-2]+y.count1bits;if(x.part2_3_length<=E)break;var W=new t(E),O=b(w,d,z,W);E=W.bits,!(x.part2_3_length<=E)&&(x.assign(y),x.part2_3_length=E,x.region0_count=g[U-2],x.region1_count=U-2-g[U-2],x.table_select[0]=D[U-2],x.table_select[1]=Y[U-2],x.table_select[2]=O)}}this.best_huffman_divide=function(v,y){var x=new Ya,w=y.l3_enc,k=Hi(7+15+1),g=Hi(7+15+1),D=Hi(7+15+1),Y=Hi(7+15+1);if(!(y.block_type==j.SHORT_TYPE&&v.mode_gr==1)){x.assign(y),y.block_type==j.NORM_TYPE&&(_(v,y,w,k,g,D,Y),o(v,x,y,w,k,g,D,Y));var z=x.big_values;if(!(z==0||(w[z-2]|w[z-1])>1)&&(z=y.count1+2,!(z>576))){x.assign(y),x.count1=z;for(var U=0,d=0;z>x.big_values;z-=4){var E=((w[z-4]*2+w[z-3])*2+w[z-2])*2+w[z-1];U+=ae.t32l[E],d+=ae.t33l[E]}if(x.big_values=z,x.count1table_select=0,U>d&&(U=d,x.count1table_select=1),x.count1bits=U,x.block_type==j.NORM_TYPE)o(v,x,y,w,k,g,D,Y);else{if(x.part2_3_length=U,U=v.scalefac_band.l[7+1],U>z&&(U=z),U>0){var W=new t(x.part2_3_length);x.table_select[0]=b(w,0,U,W),x.part2_3_length=W.bits}if(z>U){var W=new t(x.part2_3_length);x.table_select[1]=b(w,U,z,W),x.part2_3_length=W.bits}y.part2_3_length>x.part2_3_length&&y.assign(x)}}}};var B=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],T=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],C=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],p=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];zi.slen1_tab=C,zi.slen2_tab=p;function A(v,y){for(var x,w=y.tt[1][v],k=y.tt[0][v],g=0;g<ae.scfsi_band.length-1;g++){for(x=ae.scfsi_band[g];x<ae.scfsi_band[g+1]&&!(k.scalefac[x]!=w.scalefac[x]&&w.scalefac[x]>=0);x++);if(x==ae.scfsi_band[g+1]){for(x=ae.scfsi_band[g];x<ae.scfsi_band[g+1];x++)w.scalefac[x]=-1;y.scfsi[v][g]=1}}var D=0,Y=0;for(x=0;x<11;x++)w.scalefac[x]!=-1&&(Y++,D<w.scalefac[x]&&(D=w.scalefac[x]));for(var z=0,U=0;x<j.SBPSY_l;x++)w.scalefac[x]!=-1&&(U++,z<w.scalefac[x]&&(z=w.scalefac[x]));for(var g=0;g<16;g++)if(D<B[g]&&z<T[g]){var d=C[g]*Y+p[g]*U;w.part2_length>d&&(w.part2_length=d,w.scalefac_compress=g)}}this.best_scalefac_store=function(v,y,x,w){var k=w.tt[y][x],g,D,Y,z,U=0;for(Y=0,g=0;g<k.sfbmax;g++){var d=k.width[g];for(Y+=d,z=-d;z<0&&k.l3_enc[z+Y]==0;z++);z==0&&(k.scalefac[g]=U=-2)}if(k.scalefac_scale==0&&k.preflag==0){var E=0;for(g=0;g<k.sfbmax;g++)k.scalefac[g]>0&&(E|=k.scalefac[g]);if((E&1)==0&&E!=0){for(g=0;g<k.sfbmax;g++)k.scalefac[g]>0&&(k.scalefac[g]>>=1);k.scalefac_scale=U=1}}if(k.preflag==0&&k.block_type!=j.SHORT_TYPE&&v.mode_gr==2){for(g=11;g<j.SBPSY_l&&!(k.scalefac[g]<e.pretab[g]&&k.scalefac[g]!=-2);g++);if(g==j.SBPSY_l){for(g=11;g<j.SBPSY_l;g++)k.scalefac[g]>0&&(k.scalefac[g]-=e.pretab[g]);k.preflag=U=1}}for(D=0;D<4;D++)w.scfsi[x][D]=0;for(v.mode_gr==2&&y==1&&w.tt[0][x].block_type!=j.SHORT_TYPE&&w.tt[1][x].block_type!=j.SHORT_TYPE&&(A(x,w),U=0),g=0;g<k.sfbmax;g++)k.scalefac[g]==-2&&(k.scalefac[g]=0);U!=0&&(v.mode_gr==2?this.scale_bitcount(k):this.scale_bitcount_lsf(v,k))};function F(v,y){for(var x=0;x<y;++x)if(v[x]<0)return!1;return!0}var R=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],I=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],h=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(v){var y,x,w=0,k=0,g,D=v.scalefac;if(Do(F(D,v.sfbmax)),v.block_type==j.SHORT_TYPE)g=R,v.mixed_block_flag!=0&&(g=I);else if(g=h,v.preflag==0){for(x=11;x<j.SBPSY_l&&!(D[x]<e.pretab[x]);x++);if(x==j.SBPSY_l)for(v.preflag=1,x=11;x<j.SBPSY_l;x++)D[x]-=e.pretab[x]}for(x=0;x<v.sfbdivide;x++)w<D[x]&&(w=D[x]);for(;x<v.sfbmax;x++)k<D[x]&&(k=D[x]);for(v.part2_length=Vt.LARGE_BITS,y=0;y<16;y++)w<B[y]&&k<T[y]&&v.part2_length>g[y]&&(v.part2_length=g[y],v.scalefac_compress=y);return v.part2_length==Vt.LARGE_BITS};var M=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(v,y){var x,w,k,g,D,Y,z,U,d=Hi(4),E=y.scalefac;for(y.preflag!=0?x=2:x=0,z=0;z<4;z++)d[z]=0;if(y.block_type==j.SHORT_TYPE){w=1;var W=e.nr_of_sfb_block[x][w];for(U=0,k=0;k<4;k++)for(g=W[k]/3,z=0;z<g;z++,U++)for(D=0;D<3;D++)E[U*3+D]>d[k]&&(d[k]=E[U*3+D])}else{w=0;var W=e.nr_of_sfb_block[x][w];for(U=0,k=0;k<4;k++)for(g=W[k],z=0;z<g;z++,U++)E[U]>d[k]&&(d[k]=E[U])}for(Y=!1,k=0;k<4;k++)d[k]>M[x][k]&&(Y=!0);if(!Y){var O,me,Se,_e;for(y.sfb_partition_table=e.nr_of_sfb_block[x][w],k=0;k<4;k++)y.slen[k]=S[d[k]];switch(O=y.slen[0],me=y.slen[1],Se=y.slen[2],_e=y.slen[3],x){case 0:y.scalefac_compress=(O*5+me<<4)+(Se<<2)+_e;break;case 1:y.scalefac_compress=400+(O*5+me<<2)+Se;break;case 2:y.scalefac_compress=500+O*3+me;break;default:a4.err.printf(`intensity stereo not implemented yet
`);break}}if(!Y)for(Do(y.sfb_partition_table!=null),y.part2_length=0,k=0;k<4;k++)y.part2_length+=y.slen[k]*y.sfb_partition_table[k];return Y};var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(v){for(var y=2;y<=576;y+=2){for(var x=0,w;v.scalefac_band.l[++x]<y;);for(w=n[x][0];v.scalefac_band.l[w+1]>y;)w--;for(w<0&&(w=n[x][0]),v.bv_scf[y-2]=w,w=n[x][1];v.scalefac_band.l[w+v.bv_scf[y-2]+2]>y;)w--;w<0&&(w=n[x][1]),v.bv_scf[y-1]=w}}}var Fn=Ie.System,o4=Ie.Arrays,l4=Ie.new_byte,c4=Ie.new_float_n,u4=Ie.new_int,Lt=Ie.assert;vn.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=Math.abs(e)*1e-6:Math.abs(e-t)<=Math.abs(t)*1e-6},vn.NEQ=function(e,t){return!vn.EQ(e,t)};function vn(){var e=this,t=32773,n=null,r=null,a=null,i=null;this.setModules=function(M,S,v,y){n=M,r=S,a=v,i=y};var s=null,l=0,f=0,u=0;this.getframebits=function(M){var S=M.internal_flags,v;S.bitrate_index!=0?v=ae.bitrate_table[M.version][S.bitrate_index]:v=M.brate;var y=0|(M.version+1)*72e3*v/M.out_samplerate+S.padding;return 8*y};function m(M){Fn.arraycopy(M.header[M.w_ptr].buf,0,s,f,M.sideinfo_len),f+=M.sideinfo_len,l+=M.sideinfo_len*8,M.w_ptr=M.w_ptr+1&ut.MAX_HEADER_BUF-1}function c(M,S,v){for(;v>0;){var y;u==0&&(u=8,f++,Lt(M.header[M.w_ptr].write_timing>=l),M.header[M.w_ptr].write_timing==l&&m(M),s[f]=0),y=Math.min(v,u),v-=y,u-=y,s[f]|=S>>v<<u,l+=y}}function b(M,S,v){for(;v>0;){var y;u==0&&(u=8,f++,s[f]=0),y=Math.min(v,u),v-=y,u-=y,s[f]|=S>>v<<u,l+=y}}function _(M,S){var v=M.internal_flags,y;if(S>=8&&(c(v,76,8),S-=8),S>=8&&(c(v,65,8),S-=8),S>=8&&(c(v,77,8),S-=8),S>=8&&(c(v,69,8),S-=8),S>=32){var x=a.getLameShortVersion();if(S>=32)for(y=0;y<x.length&&S>=8;++y)S-=8,c(v,x.charAt(y),8)}for(;S>=1;S-=1)c(v,v.ancillary_flag,1),v.ancillary_flag^=M.disable_reservoir?0:1}function o(M,S,v){for(var y=M.header[M.h_ptr].ptr;v>0;){var x=Math.min(v,8-(y&7));v-=x,M.header[M.h_ptr].buf[y>>3]|=S>>v<<8-(y&7)-x,y+=x}M.header[M.h_ptr].ptr=y}function B(M,S){M<<=8;for(var v=0;v<8;v++)M<<=1,S<<=1,((S^M)&65536)!=0&&(S^=t);return S}this.CRC_writeheader=function(M,S){var v=65535;v=B(S[2]&255,v),v=B(S[3]&255,v);for(var y=6;y<M.sideinfo_len;y++)v=B(S[y]&255,v);S[4]=byte(v>>8),S[5]=byte(v&255)};function T(M,S){var v=M.internal_flags,y,x,w;if(y=v.l3_side,v.header[v.h_ptr].ptr=0,o4.fill(v.header[v.h_ptr].buf,0,v.sideinfo_len,0),M.out_samplerate<16e3?o(v,4094,12):o(v,4095,12),o(v,M.version,1),o(v,4-3,2),o(v,M.error_protection?0:1,1),o(v,v.bitrate_index,4),o(v,v.samplerate_index,2),o(v,v.padding,1),o(v,M.extension,1),o(v,M.mode.ordinal(),2),o(v,v.mode_ext,2),o(v,M.copyright,1),o(v,M.original,1),o(v,M.emphasis,2),M.error_protection&&o(v,0,16),M.version==1){for(Lt(y.main_data_begin>=0),o(v,y.main_data_begin,9),v.channels_out==2?o(v,y.private_bits,3):o(v,y.private_bits,5),w=0;w<v.channels_out;w++){var k;for(k=0;k<4;k++)o(v,y.scfsi[w][k],1)}for(x=0;x<2;x++)for(w=0;w<v.channels_out;w++){var g=y.tt[x][w];o(v,g.part2_3_length+g.part2_length,12),o(v,g.big_values/2,9),o(v,g.global_gain,8),o(v,g.scalefac_compress,4),g.block_type!=j.NORM_TYPE?(o(v,1,1),o(v,g.block_type,2),o(v,g.mixed_block_flag,1),g.table_select[0]==14&&(g.table_select[0]=16),o(v,g.table_select[0],5),g.table_select[1]==14&&(g.table_select[1]=16),o(v,g.table_select[1],5),o(v,g.subblock_gain[0],3),o(v,g.subblock_gain[1],3),o(v,g.subblock_gain[2],3)):(o(v,0,1),g.table_select[0]==14&&(g.table_select[0]=16),o(v,g.table_select[0],5),g.table_select[1]==14&&(g.table_select[1]=16),o(v,g.table_select[1],5),g.table_select[2]==14&&(g.table_select[2]=16),o(v,g.table_select[2],5),Lt(g.region0_count>=0&&g.region0_count<16),Lt(g.region1_count>=0&&g.region1_count<8),o(v,g.region0_count,4),o(v,g.region1_count,3)),o(v,g.preflag,1),o(v,g.scalefac_scale,1),o(v,g.count1table_select,1)}}else for(Lt(y.main_data_begin>=0),o(v,y.main_data_begin,8),o(v,y.private_bits,v.channels_out),x=0,w=0;w<v.channels_out;w++){var g=y.tt[x][w];o(v,g.part2_3_length+g.part2_length,12),o(v,g.big_values/2,9),o(v,g.global_gain,8),o(v,g.scalefac_compress,9),g.block_type!=j.NORM_TYPE?(o(v,1,1),o(v,g.block_type,2),o(v,g.mixed_block_flag,1),g.table_select[0]==14&&(g.table_select[0]=16),o(v,g.table_select[0],5),g.table_select[1]==14&&(g.table_select[1]=16),o(v,g.table_select[1],5),o(v,g.subblock_gain[0],3),o(v,g.subblock_gain[1],3),o(v,g.subblock_gain[2],3)):(o(v,0,1),g.table_select[0]==14&&(g.table_select[0]=16),o(v,g.table_select[0],5),g.table_select[1]==14&&(g.table_select[1]=16),o(v,g.table_select[1],5),g.table_select[2]==14&&(g.table_select[2]=16),o(v,g.table_select[2],5),Lt(g.region0_count>=0&&g.region0_count<16),Lt(g.region1_count>=0&&g.region1_count<8),o(v,g.region0_count,4),o(v,g.region1_count,3)),o(v,g.scalefac_scale,1),o(v,g.count1table_select,1)}M.error_protection&&CRC_writeheader(v,v.header[v.h_ptr].buf);{var D=v.h_ptr;Lt(v.header[D].ptr==v.sideinfo_len*8),v.h_ptr=D+1&ut.MAX_HEADER_BUF-1,v.header[v.h_ptr].write_timing=v.header[D].write_timing+S,v.h_ptr==v.w_ptr&&Fn.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function C(M,S){var v=ae.ht[S.count1table_select+32],y,x=0,w=S.big_values,k=S.big_values;for(Lt(S.count1table_select<2),y=(S.count1-S.big_values)/4;y>0;--y){var g=0,D=0,Y;Y=S.l3_enc[w+0],Y!=0&&(D+=8,S.xr[k+0]<0&&g++),Y=S.l3_enc[w+1],Y!=0&&(D+=4,g*=2,S.xr[k+1]<0&&g++),Y=S.l3_enc[w+2],Y!=0&&(D+=2,g*=2,S.xr[k+2]<0&&g++),Y=S.l3_enc[w+3],Y!=0&&(D++,g*=2,S.xr[k+3]<0&&g++),w+=4,k+=4,c(M,g+v.table[D],v.hlen[D]),x+=v.hlen[D]}return x}function p(M,S,v,y,x){var w=ae.ht[S],k=0;if(S==0)return k;for(var g=v;g<y;g+=2){var D=0,Y=0,z=w.xlen,U=w.xlen,d=0,E=x.l3_enc[g],W=x.l3_enc[g+1];if(E!=0&&(x.xr[g]<0&&d++,D--),S>15){if(E>14){var O=E-15;Lt(O<=w.linmax),d|=O<<1,Y=z,E=15}if(W>14){var me=W-15;Lt(me<=w.linmax),d<<=z,d|=me,Y+=z,W=15}U=16}W!=0&&(d<<=1,x.xr[g+1]<0&&d++,D--),E=E*U+W,Y-=D,D+=w.hlen[E],c(M,w.table[E],D),c(M,d,Y),k+=D+Y}return k}function A(M,S){var v=3*M.scalefac_band.s[3];v>S.big_values&&(v=S.big_values);var y=p(M,S.table_select[0],0,v,S);return y+=p(M,S.table_select[1],v,S.big_values,S),y}function F(M,S){var v,y,x,w;v=S.big_values;var k=S.region0_count+1;return Lt(k<M.scalefac_band.l.length),x=M.scalefac_band.l[k],k+=S.region1_count+1,Lt(k<M.scalefac_band.l.length),w=M.scalefac_band.l[k],x>v&&(x=v),w>v&&(w=v),y=p(M,S.table_select[0],0,x,S),y+=p(M,S.table_select[1],x,w,S),y+=p(M,S.table_select[2],w,v,S),y}function R(M){var S,v,y,x,w=0,k=M.internal_flags,g=k.l3_side;if(M.version==1)for(S=0;S<2;S++)for(v=0;v<k.channels_out;v++){var D=g.tt[S][v],Y=zi.slen1_tab[D.scalefac_compress],z=zi.slen2_tab[D.scalefac_compress];for(x=0,y=0;y<D.sfbdivide;y++)D.scalefac[y]!=-1&&(c(k,D.scalefac[y],Y),x+=Y);for(;y<D.sfbmax;y++)D.scalefac[y]!=-1&&(c(k,D.scalefac[y],z),x+=z);Lt(x==D.part2_length),D.block_type==j.SHORT_TYPE?x+=A(k,D):x+=F(k,D),x+=C(k,D),Lt(x==D.part2_3_length+D.part2_length),w+=x}else for(S=0,v=0;v<k.channels_out;v++){var D=g.tt[S][v],U,d,E=0;if(Lt(D.sfb_partition_table!=null),x=0,y=0,d=0,D.block_type==j.SHORT_TYPE){for(;d<4;d++){var W=D.sfb_partition_table[d]/3,O=D.slen[d];for(U=0;U<W;U++,y++)c(k,Math.max(D.scalefac[y*3+0],0),O),c(k,Math.max(D.scalefac[y*3+1],0),O),c(k,Math.max(D.scalefac[y*3+2],0),O),E+=3*O}x+=A(k,D)}else{for(;d<4;d++){var W=D.sfb_partition_table[d],O=D.slen[d];for(U=0;U<W;U++,y++)c(k,Math.max(D.scalefac[y],0),O),E+=O}x+=F(k,D)}x+=C(k,D),Lt(x==D.part2_3_length),Lt(E==D.part2_length),w+=E+x}return w}function I(){this.total=0}function h(M,S){var v=M.internal_flags,y,x,w,k,g;return g=v.w_ptr,k=v.h_ptr-1,k==-1&&(k=ut.MAX_HEADER_BUF-1),y=v.header[k].write_timing-l,S.total=y,y>=0&&(x=1+k-g,k<g&&(x=1+k-g+ut.MAX_HEADER_BUF),y-=x*8*v.sideinfo_len),w=e.getframebits(M),y+=w,S.total+=w,S.total%8!=0?S.total=1+S.total/8:S.total=S.total/8,S.total+=f+1,y<0&&Fn.err.println(`strange error flushing buffer ... 
`),y}this.flush_bitstream=function(M){var S=M.internal_flags,v,y,x=S.h_ptr-1;if(x==-1&&(x=ut.MAX_HEADER_BUF-1),v=S.l3_side,!((y=h(M,new I))<0)){if(_(M,y),Lt(S.header[x].write_timing+this.getframebits(M)==l),S.ResvSize=0,v.main_data_begin=0,S.findReplayGain){var w=n.GetTitleGain(S.rgdata);Lt(NEQ(w,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),S.RadioGain=Math.floor(w*10+.5)|0}S.findPeakSample&&(S.noclipGainChange=Math.ceil(Math.log10(S.PeakSample/32767)*20*10)|0,S.noclipGainChange>0&&(EQ(M.scale,1)||EQ(M.scale,0))?S.noclipScale=Math.floor(32767/S.PeakSample*100)/100:S.noclipScale=-1)}},this.add_dummy_byte=function(M,S,v){for(var y=M.internal_flags,x;v-- >0;)for(b(y,S,8),x=0;x<ut.MAX_HEADER_BUF;++x)y.header[x].write_timing+=8},this.format_bitstream=function(M){var S=M.internal_flags,v;v=S.l3_side;var y=this.getframebits(M);_(M,v.resvDrain_pre),T(M,y);var x=8*S.sideinfo_len;if(x+=R(M),_(M,v.resvDrain_post),x+=v.resvDrain_post,v.main_data_begin+=(y-x)/8,h(M,new I)!=S.ResvSize&&Fn.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),v.main_data_begin*8!=S.ResvSize&&(Fn.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*v.main_data_begin,S.ResvSize,v.resvDrain_post,v.resvDrain_pre,8*S.sideinfo_len,x-v.resvDrain_post-8*S.sideinfo_len,x,x%8,y),Fn.err.println("This is a fatal error.  It has several possible causes:"),Fn.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Fn.err.println(" 9%%  Your system is overclocked"),Fn.err.println(" 1%%  bug in LAME encoding library"),S.ResvSize=v.main_data_begin*8),l>1e9){var w;for(w=0;w<ut.MAX_HEADER_BUF;++w)S.header[w].write_timing-=l;l=0}return 0},this.copy_buffer=function(M,S,v,y,x){var w=f+1;if(w<=0)return 0;if(y!=0&&w>y)return-1;if(Fn.arraycopy(s,0,S,v,w),f=-1,u=0,x!=0){var k=u4(1);if(k[0]=M.nMusicCRC,i.updateMusicCRC(k,S,v,w),M.nMusicCRC=k[0],w>0&&(M.VBR_seek_table.nBytesWritten+=w),M.decode_on_the_fly){for(var g=c4([2,1152]),D=w,Y=-1,z;Y!=0;)if(Y=r.hip_decode1_unclipped(M.hip,S,v,D,g[0],g[1]),D=0,Y==-1&&(Y=0),Y>0){if(M.findPeakSample){for(z=0;z<Y;z++)g[0][z]>M.PeakSample?M.PeakSample=g[0][z]:-g[0][z]>M.PeakSample&&(M.PeakSample=-g[0][z]);if(M.channels_out>1)for(z=0;z<Y;z++)g[1][z]>M.PeakSample?M.PeakSample=g[1][z]:-g[1][z]>M.PeakSample&&(M.PeakSample=-g[1][z])}if(M.findReplayGain&&n.AnalyzeSamples(M.rgdata,g[0],0,g[1],0,Y,M.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return w},this.init_bit_stream_w=function(M){s=l4(Je.LAME_MAXMP3BUFFER),M.h_ptr=M.w_ptr=0,M.header[M.h_ptr].write_timing=0,f=-1,u=0,l=0}}var d4=Ie.System,kt=Ie.VbrMode,Ho=Ie.ShortBlock,Fr=Ie.new_float,r1=Ie.new_int_n,f4=Ie.new_short_n,ur=Ie.assert;function Je(){var e=this,t=128*1024;Je.V9=410,Je.V8=420,Je.V7=430,Je.V6=440,Je.V5=450,Je.V4=460,Je.V3=470,Je.V2=480,Je.V1=490,Je.V0=500,Je.R3MIX=1e3,Je.STANDARD=1001,Je.EXTREME=1002,Je.INSANE=1003,Je.STANDARD_FAST=1004,Je.EXTREME_FAST=1005,Je.MEDIUM=1006,Je.MEDIUM_FAST=1007;var n=16384+t;Je.LAME_MAXMP3BUFFER=n;var r,a,i,s,l,f=new Fo,u,m,c;this.enc=new j,this.setModules=function(d,E,W,O,me,Se,_e,pe,De){r=d,a=E,i=W,s=O,l=me,u=Se,m=pe,c=De,this.enc.setModules(a,f,s,u)};function b(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=Fr(j.SBMAX_l),this.bo_s_weight=Fr(j.SBMAX_s)}function _(){this.lowerlimit=0}function o(d,E){this.lowpass=E}var B=4294479419;function T(d){var E;return d.class_id=B,E=d.internal_flags=new ut,d.mode=ft.NOT_SET,d.original=1,d.in_samplerate=44100,d.num_channels=2,d.num_samples=-1,d.bWriteVbrTag=!0,d.quality=-1,d.short_blocks=null,E.subblock_gain=-1,d.lowpassfreq=0,d.highpassfreq=0,d.lowpasswidth=-1,d.highpasswidth=-1,d.VBR=kt.vbr_off,d.VBR_q=4,d.ATHcurve=-1,d.VBR_mean_bitrate_kbps=128,d.VBR_min_bitrate_kbps=0,d.VBR_max_bitrate_kbps=0,d.VBR_hard_min=0,E.VBR_min_bitrate=1,E.VBR_max_bitrate=13,d.quant_comp=-1,d.quant_comp_short=-1,d.msfix=-1,E.resample_ratio=1,E.OldValue[0]=180,E.OldValue[1]=180,E.CurrentStep[0]=4,E.CurrentStep[1]=4,E.masking_lower=1,E.nsPsy.attackthre=-1,E.nsPsy.attackthre_s=-1,d.scale=-1,d.athaa_type=-1,d.ATHtype=-1,d.athaa_loudapprox=-1,d.athaa_sensitivity=0,d.useTemporal=null,d.interChRatio=-1,E.mf_samples_to_encode=j.ENCDELAY+j.POSTDELAY,d.encoder_padding=0,E.mf_size=j.ENCDELAY-j.MDCTDELAY,d.findReplayGain=!1,d.decode_on_the_fly=!1,E.decode_on_the_fly=!1,E.findReplayGain=!1,E.findPeakSample=!1,E.RadioGain=0,E.AudiophileGain=0,E.noclipGainChange=0,E.noclipScale=-1,d.preset=0,d.write_id3tag_automatic=!0,0}this.lame_init=function(){var d=new X3;return T(d),d.lame_allocated_gfp=1,d};function C(d){return d>1?0:d<=0?1:Math.cos(Math.PI/2*d)}this.nearestBitrateFullIndex=function(d){var E=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],W=0,O=0,me=0,Se=0;Se=E[16],me=16,O=E[16],W=16;for(var _e=0;_e<16;_e++)if(Math.max(d,E[_e+1])!=d){Se=E[_e+1],me=_e+1,O=E[_e],W=_e;break}return Se-d>d-O?W:me};function p(d,E){var W=44100;return E>=48e3?W=48e3:E>=44100?W=44100:E>=32e3?W=32e3:E>=24e3?W=24e3:E>=22050?W=22050:E>=16e3?W=16e3:E>=12e3?W=12e3:E>=11025?W=11025:E>=8e3&&(W=8e3),d==-1?W:(d<=15960&&(W=44100),d<=15250&&(W=32e3),d<=11220&&(W=24e3),d<=9970&&(W=22050),d<=7230&&(W=16e3),d<=5420&&(W=12e3),d<=4510&&(W=11025),d<=3970&&(W=8e3),E<W?E>44100?48e3:E>32e3?44100:E>24e3?32e3:E>22050?24e3:E>16e3?22050:E>12e3?16e3:E>11025?12e3:E>8e3?11025:8e3:W)}function A(d,E){switch(d){case 44100:return E.version=1,0;case 48e3:return E.version=1,1;case 32e3:return E.version=1,2;case 22050:return E.version=0,0;case 24e3:return E.version=0,1;case 16e3:return E.version=0,2;case 11025:return E.version=0,0;case 12e3:return E.version=0,1;case 8e3:return E.version=0,2;default:return E.version=0,-1}}function F(d,E,W){W<16e3&&(E=2);for(var O=ae.bitrate_table[E][1],me=2;me<=14;me++)ae.bitrate_table[E][me]>0&&Math.abs(ae.bitrate_table[E][me]-d)<Math.abs(O-d)&&(O=ae.bitrate_table[E][me]);return O}function R(d,E,W){W<16e3&&(E=2);for(var O=0;O<=14;O++)if(ae.bitrate_table[E][O]>0&&ae.bitrate_table[E][O]==d)return O;return-1}function I(d,E){var W=[new o(8,2e3),new o(16,3700),new o(24,3900),new o(32,5500),new o(40,7e3),new o(48,7500),new o(56,1e4),new o(64,11e3),new o(80,13500),new o(96,15100),new o(112,15600),new o(128,17e3),new o(160,17500),new o(192,18600),new o(224,19400),new o(256,19700),new o(320,20500)],O=e.nearestBitrateFullIndex(E);d.lowerlimit=W[O].lowpass}function h(d){var E=d.internal_flags,W=32,O=-1;if(E.lowpass1>0){for(var me=999,Se=0;Se<=31;Se++){var _e=Se/31;_e>=E.lowpass2&&(W=Math.min(W,Se)),E.lowpass1<_e&&_e<E.lowpass2&&(me=Math.min(me,Se))}me==999?E.lowpass1=(W-.75)/31:E.lowpass1=(me-.75)/31,E.lowpass2=W/31}if(E.highpass2>0&&E.highpass2<.9*(.75/31)&&(E.highpass1=0,E.highpass2=0,d4.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),E.highpass2>0){for(var pe=-1,Se=0;Se<=31;Se++){var _e=Se/31;_e<=E.highpass1&&(O=Math.max(O,Se)),E.highpass1<_e&&_e<E.highpass2&&(pe=Math.max(pe,Se))}E.highpass1=O/31,pe==-1?E.highpass2=(O+.75)/31:E.highpass2=(pe+.75)/31}for(var Se=0;Se<32;Se++){var De,Ce,_e=Se/31;E.highpass2>E.highpass1?De=C((E.highpass2-_e)/(E.highpass2-E.highpass1+1e-20)):De=1,E.lowpass2>E.lowpass1?Ce=C((_e-E.lowpass1)/(E.lowpass2-E.lowpass1+1e-20)):Ce=1,E.amp_filter[Se]=De*Ce}}function M(d){var E=d.internal_flags;switch(d.quality){default:case 9:E.psymodel=0,E.noise_shaping=0,E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.use_best_huffman=0,E.full_outer_loop=0;break;case 8:d.quality=7;case 7:E.psymodel=1,E.noise_shaping=0,E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.use_best_huffman=0,E.full_outer_loop=0;break;case 6:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=0,E.full_outer_loop=0;break;case 5:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=0,E.full_outer_loop=0;break;case 4:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=0,E.noise_shaping_stop=0,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 3:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.noise_shaping_amp=1,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 2:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=1,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 1:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=2,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break;case 0:E.psymodel=1,E.noise_shaping==0&&(E.noise_shaping=1),E.substep_shaping==0&&(E.substep_shaping=2),E.noise_shaping_amp=2,E.noise_shaping_stop=1,E.subblock_gain==-1&&(E.subblock_gain=1),E.use_best_huffman=1,E.full_outer_loop=0;break}}function S(d){var E=d.internal_flags;d.frameNum=0,d.write_id3tag_automatic&&m.id3tag_write_v2(d),E.bitrate_stereoMode_Hist=r1([16,4+1]),E.bitrate_blockType_Hist=r1([16,4+1+1]),E.PeakSample=0,d.bWriteVbrTag&&u.InitVbrTag(d)}this.lame_init_params=function(d){var E=d.internal_flags;if(E.Class_ID=0,E.ATH==null&&(E.ATH=new e4),E.PSY==null&&(E.PSY=new b),E.rgdata==null&&(E.rgdata=new t4),E.channels_in=d.num_channels,E.channels_in==1&&(d.mode=ft.MONO),E.channels_out=d.mode==ft.MONO?1:2,E.mode_ext=j.MPG_MD_MS_LR,d.mode==ft.MONO&&(d.force_ms=!1),d.VBR==kt.vbr_off&&d.VBR_mean_bitrate_kbps!=128&&d.brate==0&&(d.brate=d.VBR_mean_bitrate_kbps),d.VBR==kt.vbr_off||d.VBR==kt.vbr_mtrh||d.VBR==kt.vbr_mt||(d.free_format=!1),d.VBR==kt.vbr_off&&d.brate==0&&vn.EQ(d.compression_ratio,0)&&(d.compression_ratio=11.025),d.VBR==kt.vbr_off&&d.compression_ratio>0&&(d.out_samplerate==0&&(d.out_samplerate=map2MP3Frequency(int(.97*d.in_samplerate))),d.brate=0|d.out_samplerate*16*E.channels_out/(1e3*d.compression_ratio),E.samplerate_index=A(d.out_samplerate,d),d.free_format||(d.brate=F(d.brate,d.version,d.out_samplerate))),d.out_samplerate!=0&&(d.out_samplerate<16e3?(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,8),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,64)):d.out_samplerate<32e3?(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,8),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,160)):(d.VBR_mean_bitrate_kbps=Math.max(d.VBR_mean_bitrate_kbps,32),d.VBR_mean_bitrate_kbps=Math.min(d.VBR_mean_bitrate_kbps,320))),d.lowpassfreq==0){var W=16e3;switch(d.VBR){case kt.vbr_off:{var O=new _;I(O,d.brate),W=O.lowerlimit;break}case kt.vbr_abr:{var O=new _;I(O,d.VBR_mean_bitrate_kbps),W=O.lowerlimit;break}case kt.vbr_rh:{var me=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(d.VBR_q>=0&&d.VBR_q<=9){var Se=me[d.VBR_q],_e=me[d.VBR_q+1],pe=d.VBR_q_frac;W=linear_int(Se,_e,pe)}else W=19500;break}default:{var me=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(d.VBR_q>=0&&d.VBR_q<=9){var Se=me[d.VBR_q],_e=me[d.VBR_q+1],pe=d.VBR_q_frac;W=linear_int(Se,_e,pe)}else W=19500}}d.mode==ft.MONO&&(d.VBR==kt.vbr_off||d.VBR==kt.vbr_abr)&&(W*=1.5),d.lowpassfreq=W|0}if(d.out_samplerate==0&&(2*d.lowpassfreq>d.in_samplerate&&(d.lowpassfreq=d.in_samplerate/2),d.out_samplerate=p(d.lowpassfreq|0,d.in_samplerate)),d.lowpassfreq=Math.min(20500,d.lowpassfreq),d.lowpassfreq=Math.min(d.out_samplerate/2,d.lowpassfreq),d.VBR==kt.vbr_off&&(d.compression_ratio=d.out_samplerate*16*E.channels_out/(1e3*d.brate)),d.VBR==kt.vbr_abr&&(d.compression_ratio=d.out_samplerate*16*E.channels_out/(1e3*d.VBR_mean_bitrate_kbps)),d.bWriteVbrTag||(d.findReplayGain=!1,d.decode_on_the_fly=!1,E.findPeakSample=!1),E.findReplayGain=d.findReplayGain,E.decode_on_the_fly=d.decode_on_the_fly,E.decode_on_the_fly&&(E.findPeakSample=!0),E.findReplayGain&&r.InitGainAnalysis(E.rgdata,d.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return d.internal_flags=null,-6;switch(E.decode_on_the_fly&&!d.decode_only&&(E.hip!=null&&c.hip_decode_exit(E.hip),E.hip=c.hip_decode_init()),E.mode_gr=d.out_samplerate<=24e3?1:2,d.framesize=576*E.mode_gr,d.encoder_delay=j.ENCDELAY,E.resample_ratio=d.in_samplerate/d.out_samplerate,d.VBR){case kt.vbr_mt:case kt.vbr_rh:case kt.vbr_mtrh:{var De=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];d.compression_ratio=De[d.VBR_q]}break;case kt.vbr_abr:d.compression_ratio=d.out_samplerate*16*E.channels_out/(1e3*d.VBR_mean_bitrate_kbps);break;default:d.compression_ratio=d.out_samplerate*16*E.channels_out/(1e3*d.brate);break}if(d.mode==ft.NOT_SET&&(d.mode=ft.JOINT_STEREO),d.highpassfreq>0?(E.highpass1=2*d.highpassfreq,d.highpasswidth>=0?E.highpass2=2*(d.highpassfreq+d.highpasswidth):E.highpass2=(1+0)*2*d.highpassfreq,E.highpass1/=d.out_samplerate,E.highpass2/=d.out_samplerate):(E.highpass1=0,E.highpass2=0),d.lowpassfreq>0?(E.lowpass2=2*d.lowpassfreq,d.lowpasswidth>=0?(E.lowpass1=2*(d.lowpassfreq-d.lowpasswidth),E.lowpass1<0&&(E.lowpass1=0)):E.lowpass1=(1-0)*2*d.lowpassfreq,E.lowpass1/=d.out_samplerate,E.lowpass2/=d.out_samplerate):(E.lowpass1=0,E.lowpass2=0),h(d),E.samplerate_index=A(d.out_samplerate,d),E.samplerate_index<0)return d.internal_flags=null,-1;if(d.VBR==kt.vbr_off){if(d.free_format)E.bitrate_index=0;else if(d.brate=F(d.brate,d.version,d.out_samplerate),E.bitrate_index=R(d.brate,d.version,d.out_samplerate),E.bitrate_index<=0)return d.internal_flags=null,-1}else E.bitrate_index=1;d.analysis&&(d.bWriteVbrTag=!1),E.pinfo!=null&&(d.bWriteVbrTag=!1),a.init_bit_stream_w(E);for(var Ce=E.samplerate_index+3*d.version+6*(d.out_samplerate<16e3?1:0),he=0;he<j.SBMAX_l+1;he++)E.scalefac_band.l[he]=s.sfBandIndex[Ce].l[he];for(var he=0;he<j.PSFB21+1;he++){var Ue=(E.scalefac_band.l[22]-E.scalefac_band.l[21])/j.PSFB21,rt=E.scalefac_band.l[21]+he*Ue;E.scalefac_band.psfb21[he]=rt}E.scalefac_band.psfb21[j.PSFB21]=576;for(var he=0;he<j.SBMAX_s+1;he++)E.scalefac_band.s[he]=s.sfBandIndex[Ce].s[he];for(var he=0;he<j.PSFB12+1;he++){var Ue=(E.scalefac_band.s[13]-E.scalefac_band.s[12])/j.PSFB12,rt=E.scalefac_band.s[12]+he*Ue;E.scalefac_band.psfb12[he]=rt}E.scalefac_band.psfb12[j.PSFB12]=192,d.version==1?E.sideinfo_len=E.channels_out==1?4+17:4+32:E.sideinfo_len=E.channels_out==1?4+9:4+17,d.error_protection&&(E.sideinfo_len+=2),S(d),E.Class_ID=B;{var P;for(P=0;P<19;P++)E.nsPsy.pefirbuf[P]=700*E.mode_gr*E.channels_out;d.ATHtype==-1&&(d.ATHtype=4)}switch(ur(d.VBR_q<=9),ur(d.VBR_q>=0),d.VBR){case kt.vbr_mt:d.VBR=kt.vbr_mtrh;case kt.vbr_mtrh:{d.useTemporal==null&&(d.useTemporal=!1),i.apply_preset(d,500-d.VBR_q*10,0),d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),d.quality<5&&(d.quality=0),d.quality>5&&(d.quality=5),E.PSY.mask_adjust=d.maskingadjust,E.PSY.mask_adjust_short=d.maskingadjust_short,d.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=d.out_samplerate>44e3,E.iteration_loop=new VBRNewIterationLoop(l);break}case kt.vbr_rh:{i.apply_preset(d,500-d.VBR_q*10,0),E.PSY.mask_adjust=d.maskingadjust,E.PSY.mask_adjust_short=d.maskingadjust_short,d.experimentalY?E.sfb21_extra=!1:E.sfb21_extra=d.out_samplerate>44e3,d.quality>6&&(d.quality=6),d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),E.iteration_loop=new VBROldIterationLoop(l);break}default:{var X;E.sfb21_extra=!1,d.quality<0&&(d.quality=LAME_DEFAULT_QUALITY),X=d.VBR,X==kt.vbr_off&&(d.VBR_mean_bitrate_kbps=d.brate),i.apply_preset(d,d.VBR_mean_bitrate_kbps,0),d.VBR=X,E.PSY.mask_adjust=d.maskingadjust,E.PSY.mask_adjust_short=d.maskingadjust_short,X==kt.vbr_off?E.iteration_loop=new r4(l):E.iteration_loop=new ABRIterationLoop(l);break}}if(ur(d.scale>=0),d.VBR!=kt.vbr_off){if(E.VBR_min_bitrate=1,E.VBR_max_bitrate=14,d.out_samplerate<16e3&&(E.VBR_max_bitrate=8),d.VBR_min_bitrate_kbps!=0&&(d.VBR_min_bitrate_kbps=F(d.VBR_min_bitrate_kbps,d.version,d.out_samplerate),E.VBR_min_bitrate=R(d.VBR_min_bitrate_kbps,d.version,d.out_samplerate),E.VBR_min_bitrate<0)||d.VBR_max_bitrate_kbps!=0&&(d.VBR_max_bitrate_kbps=F(d.VBR_max_bitrate_kbps,d.version,d.out_samplerate),E.VBR_max_bitrate=R(d.VBR_max_bitrate_kbps,d.version,d.out_samplerate),E.VBR_max_bitrate<0))return-1;d.VBR_min_bitrate_kbps=ae.bitrate_table[d.version][E.VBR_min_bitrate],d.VBR_max_bitrate_kbps=ae.bitrate_table[d.version][E.VBR_max_bitrate],d.VBR_mean_bitrate_kbps=Math.min(ae.bitrate_table[d.version][E.VBR_max_bitrate],d.VBR_mean_bitrate_kbps),d.VBR_mean_bitrate_kbps=Math.max(ae.bitrate_table[d.version][E.VBR_min_bitrate],d.VBR_mean_bitrate_kbps)}return d.tune&&(E.PSY.mask_adjust+=d.tune_value_a,E.PSY.mask_adjust_short+=d.tune_value_a),M(d),ur(d.scale>=0),d.athaa_type<0?E.ATH.useAdjust=3:E.ATH.useAdjust=d.athaa_type,E.ATH.aaSensitivityP=Math.pow(10,d.athaa_sensitivity/-10),d.short_blocks==null&&(d.short_blocks=Ho.short_block_allowed),d.short_blocks==Ho.short_block_allowed&&(d.mode==ft.JOINT_STEREO||d.mode==ft.STEREO)&&(d.short_blocks=Ho.short_block_coupled),d.quant_comp<0&&(d.quant_comp=1),d.quant_comp_short<0&&(d.quant_comp_short=0),d.msfix<0&&(d.msfix=0),d.exp_nspsytune=d.exp_nspsytune|1,d.internal_flags.nsPsy.attackthre<0&&(d.internal_flags.nsPsy.attackthre=Fo.NSATTACKTHRE),d.internal_flags.nsPsy.attackthre_s<0&&(d.internal_flags.nsPsy.attackthre_s=Fo.NSATTACKTHRE_S),ur(d.scale>=0),d.scale<0&&(d.scale=1),d.ATHtype<0&&(d.ATHtype=4),d.ATHcurve<0&&(d.ATHcurve=4),d.athaa_loudapprox<0&&(d.athaa_loudapprox=2),d.interChRatio<0&&(d.interChRatio=0),d.useTemporal==null&&(d.useTemporal=!0),E.slot_lag=E.frac_SpF=0,d.VBR==kt.vbr_off&&(E.slot_lag=E.frac_SpF=(d.version+1)*72e3*d.brate%d.out_samplerate|0),s.iteration_init(d),f.psymodel_init(d),ur(d.scale>=0),0};function v(d,E){(d.in_buffer_0==null||d.in_buffer_nsamples<E)&&(d.in_buffer_0=Fr(E),d.in_buffer_1=Fr(E),d.in_buffer_nsamples=E)}this.lame_encode_flush=function(d,E,W,O){var me=d.internal_flags,Se=f4([2,1152]),_e=0,pe,De,Ce,he,Ue=me.mf_samples_to_encode-j.POSTDELAY,rt=y(d);if(me.mf_samples_to_encode<1)return 0;for(pe=0,d.in_samplerate!=d.out_samplerate&&(Ue+=16*d.out_samplerate/d.in_samplerate),Ce=d.framesize-Ue%d.framesize,Ce<576&&(Ce+=d.framesize),d.encoder_padding=Ce,he=(Ue+Ce)/d.framesize;he>0&&_e>=0;){var P=rt-me.mf_size,X=d.frameNum;P*=d.in_samplerate,P/=d.out_samplerate,P>1152&&(P=1152),P<1&&(P=1),De=O-pe,O==0&&(De=0),_e=this.lame_encode_buffer(d,Se[0],Se[1],P,E,W,De),W+=_e,pe+=_e,he-=X!=d.frameNum?1:0}if(me.mf_samples_to_encode=0,_e<0||(De=O-pe,O==0&&(De=0),a.flush_bitstream(d),_e=a.copy_buffer(me,E,W,De,1),_e<0))return _e;if(W+=_e,pe+=_e,De=O-pe,O==0&&(De=0),d.write_id3tag_automatic){if(m.id3tag_write_v1(d),_e=a.copy_buffer(me,E,W,De,0),_e<0)return _e;pe+=_e}return pe},this.lame_encode_buffer=function(d,E,W,O,me,Se,_e){var pe=d.internal_flags,De=[null,null];if(pe.Class_ID!=B)return-3;if(O==0)return 0;v(pe,O),De[0]=pe.in_buffer_0,De[1]=pe.in_buffer_1;for(var Ce=0;Ce<O;Ce++)De[0][Ce]=E[Ce],pe.channels_in>1&&(De[1][Ce]=W[Ce]);return x(d,De[0],De[1],O,me,Se,_e)};function y(d){var E=j.BLKSIZE+d.framesize-j.FFTOFFSET;return E=Math.max(E,512+d.framesize-32),E}function x(d,E,W,O,me,Se,_e){var pe=d.internal_flags,De=0,Ce,he,Ue,rt,P,X=[null,null],ne=[null,null];if(pe.Class_ID!=B)return-3;if(O==0)return 0;if(P=a.copy_buffer(pe,me,Se,_e,0),P<0)return P;if(Se+=P,De+=P,ne[0]=E,ne[1]=W,vn.NEQ(d.scale,0)&&vn.NEQ(d.scale,1))for(he=0;he<O;++he)ne[0][he]*=d.scale,pe.channels_out==2&&(ne[1][he]*=d.scale);if(vn.NEQ(d.scale_left,0)&&vn.NEQ(d.scale_left,1))for(he=0;he<O;++he)ne[0][he]*=d.scale_left;if(vn.NEQ(d.scale_right,0)&&vn.NEQ(d.scale_right,1))for(he=0;he<O;++he)ne[1][he]*=d.scale_right;if(d.num_channels==2&&pe.channels_out==1)for(he=0;he<O;++he)ne[0][he]=.5*(ne[0][he]+ne[1][he]),ne[1][he]=0;rt=y(d),X[0]=pe.mfbuf[0],X[1]=pe.mfbuf[1];for(var ce=0;O>0;){var de=[null,null],Ae=0,Ee=0;de[0]=ne[0],de[1]=ne[1];var ye=new k;if(U(d,X,de,ce,O,ye),Ae=ye.n_in,Ee=ye.n_out,pe.findReplayGain&&!pe.decode_on_the_fly&&r.AnalyzeSamples(pe.rgdata,X[0],pe.mf_size,X[1],pe.mf_size,Ee,pe.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(O-=Ae,ce+=Ae,pe.channels_out==2,pe.mf_size+=Ee,ur(pe.mf_size<=ut.MFSIZE),pe.mf_samples_to_encode<1&&(pe.mf_samples_to_encode=j.ENCDELAY+j.POSTDELAY),pe.mf_samples_to_encode+=Ee,pe.mf_size>=rt){var Me=_e-De;if(_e==0&&(Me=0),Ce=w(d,X[0],X[1],me,Se,Me),Ce<0)return Ce;for(Se+=Ce,De+=Ce,pe.mf_size-=d.framesize,pe.mf_samples_to_encode-=d.framesize,Ue=0;Ue<pe.channels_out;Ue++)for(he=0;he<pe.mf_size;he++)X[Ue][he]=X[Ue][he+d.framesize]}}return De}function w(d,E,W,O,me,Se){var _e=e.enc.lame_encode_mp3_frame(d,E,W,O,me,Se);return d.frameNum++,_e}function k(){this.n_in=0,this.n_out=0}function g(){this.num_used=0}function D(d,E){return E!=0?D(E,d%E):d}function Y(d,E,W){var O=Math.PI*E;d/=W,d<0&&(d=0),d>1&&(d=1);var me=d-.5,Se=.42-.5*Math.cos(2*d*Math.PI)+.08*Math.cos(4*d*Math.PI);return Math.abs(me)<1e-9?O/Math.PI:Se*Math.sin(W*O*me)/(Math.PI*W*me)}function z(d,E,W,O,me,Se,_e,pe,De){var Ce=d.internal_flags,he,Ue=0,rt,P=d.out_samplerate/D(d.out_samplerate,d.in_samplerate);P>ut.BPC&&(P=ut.BPC);var X=Math.abs(Ce.resample_ratio-Math.floor(.5+Ce.resample_ratio))<1e-4?1:0,ne=1/Ce.resample_ratio;ne>1&&(ne=1);var ce=31;ce%2==0&&--ce,ce+=X;var de=ce+1;if(Ce.fill_buffer_resample_init==0){for(Ce.inbuf_old[0]=Fr(de),Ce.inbuf_old[1]=Fr(de),he=0;he<=2*P;++he)Ce.blackfilt[he]=Fr(de);for(Ce.itime[0]=0,Ce.itime[1]=0,Ue=0;Ue<=2*P;Ue++){var Ae=0,Ee=(Ue-P)/(2*P);for(he=0;he<=ce;he++)Ae+=Ce.blackfilt[Ue][he]=Y(he-Ee,ne,ce);for(he=0;he<=ce;he++)Ce.blackfilt[Ue][he]/=Ae}Ce.fill_buffer_resample_init=1}var ye=Ce.inbuf_old[De];for(rt=0;rt<O;rt++){var Me,ge;if(Me=rt*Ce.resample_ratio,Ue=0|Math.floor(Me-Ce.itime[De]),ce+Ue-ce/2>=_e)break;var Ee=Me-Ce.itime[De]-(Ue+.5*(ce%2));ge=0|Math.floor(Ee*2*P+P+.5);var ze=0;for(he=0;he<=ce;++he){var je=0|he+Ue-ce/2,Pe;Pe=je<0?ye[de+je]:me[Se+je],ze+=Pe*Ce.blackfilt[ge][he]}E[W+rt]=ze}if(pe.num_used=Math.min(_e,ce+Ue-ce/2),Ce.itime[De]+=pe.num_used-rt*Ce.resample_ratio,pe.num_used>=de)for(he=0;he<de;he++)ye[he]=me[Se+pe.num_used+he-de];else{var Ve=de-pe.num_used;for(he=0;he<Ve;++he)ye[he]=ye[he+pe.num_used];for(Ue=0;he<de;++he,++Ue)ye[he]=me[Se+Ue];ur(Ue==pe.num_used)}return rt}function U(d,E,W,O,me,Se){var _e=d.internal_flags;if(_e.resample_ratio<.9999||_e.resample_ratio>1.0001)for(var pe=0;pe<_e.channels_out;pe++){var De=new g;Se.n_out=z(d,E[pe],_e.mf_size,d.framesize,W[pe],O,me,De,pe),Se.n_in=De.num_used}else{Se.n_out=Math.min(d.framesize,me),Se.n_in=Se.n_out;for(var Ce=0;Ce<Se.n_out;++Ce)E[0][_e.mf_size+Ce]=W[0][O+Ce],_e.channels_out==2&&(E[1][_e.mf_size+Ce]=W[1][O+Ce])}}}var jn=Ie.VbrMode;function m4(){function e(u,m,c,b,_,o,B,T,C,p,A,F,R,I,h){this.vbr_q=u,this.quant_comp=m,this.quant_comp_s=c,this.expY=b,this.st_lrm=_,this.st_s=o,this.masking_adj=B,this.masking_adj_short=T,this.ath_lower=C,this.ath_curve=p,this.ath_sensitivity=A,this.interch=F,this.safejoint=R,this.sfb21mod=I,this.msfix=h}function t(u,m,c,b,_,o,B,T,C,p,A,F,R,I){this.quant_comp=m,this.quant_comp_s=c,this.safejoint=b,this.nsmsfix=_,this.st_lrm=o,this.st_s=B,this.nsbass=T,this.scale=C,this.masking_adj=p,this.ath_lower=A,this.ath_curve=F,this.interch=R,this.sfscale=I}var n;this.setModules=function(u){n=u};var r=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],a=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function i(u,m,c){var b=u.VBR==jn.vbr_rh?r:a,_=u.VBR_q_frac,o=b[m],B=b[m+1],T=o;o.st_lrm=o.st_lrm+_*(B.st_lrm-o.st_lrm),o.st_s=o.st_s+_*(B.st_s-o.st_s),o.masking_adj=o.masking_adj+_*(B.masking_adj-o.masking_adj),o.masking_adj_short=o.masking_adj_short+_*(B.masking_adj_short-o.masking_adj_short),o.ath_lower=o.ath_lower+_*(B.ath_lower-o.ath_lower),o.ath_curve=o.ath_curve+_*(B.ath_curve-o.ath_curve),o.ath_sensitivity=o.ath_sensitivity+_*(B.ath_sensitivity-o.ath_sensitivity),o.interch=o.interch+_*(B.interch-o.interch),o.msfix=o.msfix+_*(B.msfix-o.msfix),f(u,T.vbr_q),c!=0?u.quant_comp=T.quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=T.quant_comp),c!=0?u.quant_comp_short=T.quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=T.quant_comp_s),T.expY!=0&&(u.experimentalY=T.expY!=0),c!=0?u.internal_flags.nsPsy.attackthre=T.st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=T.st_lrm),c!=0?u.internal_flags.nsPsy.attackthre_s=T.st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=T.st_s),c!=0?u.maskingadjust=T.masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=T.masking_adj),c!=0?u.maskingadjust_short=T.masking_adj_short:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=T.masking_adj_short),c!=0?u.ATHlower=-T.ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-T.ath_lower/10),c!=0?u.ATHcurve=T.ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=T.ath_curve),c!=0?u.athaa_sensitivity=T.ath_sensitivity:Math.abs(u.athaa_sensitivity- -1)>0||(u.athaa_sensitivity=T.ath_sensitivity),T.interch>0&&(c!=0?u.interChRatio=T.interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=T.interch)),T.safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|T.safejoint),T.sfb21mod>0&&(u.exp_nspsytune=u.exp_nspsytune|T.sfb21mod<<20),c!=0?u.msfix=T.msfix:Math.abs(u.msfix- -1)>0||(u.msfix=T.msfix),c==0&&(u.VBR_q=m,u.VBR_q_frac=_)}var s=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(u,m,c){var b=m,_=n.nearestBitrateFullIndex(m);if(u.VBR=jn.vbr_abr,u.VBR_mean_bitrate_kbps=b,u.VBR_mean_bitrate_kbps=Math.min(u.VBR_mean_bitrate_kbps,320),u.VBR_mean_bitrate_kbps=Math.max(u.VBR_mean_bitrate_kbps,8),u.brate=u.VBR_mean_bitrate_kbps,u.VBR_mean_bitrate_kbps>320&&(u.disable_reservoir=!0),s[_].safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|2),s[_].sfscale>0&&(u.internal_flags.noise_shaping=2),Math.abs(s[_].nsbass)>0){var o=int(s[_].nsbass*4);o<0&&(o+=64),u.exp_nspsytune=u.exp_nspsytune|o<<2}return c!=0?u.quant_comp=s[_].quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=s[_].quant_comp),c!=0?u.quant_comp_short=s[_].quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=s[_].quant_comp_s),c!=0?u.msfix=s[_].nsmsfix:Math.abs(u.msfix- -1)>0||(u.msfix=s[_].nsmsfix),c!=0?u.internal_flags.nsPsy.attackthre=s[_].st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=s[_].st_lrm),c!=0?u.internal_flags.nsPsy.attackthre_s=s[_].st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=s[_].st_s),c!=0?u.scale=s[_].scale:Math.abs(u.scale- -1)>0||(u.scale=s[_].scale),c!=0?u.maskingadjust=s[_].masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=s[_].masking_adj),s[_].masking_adj>0?c!=0?u.maskingadjust_short=s[_].masking_adj*.9:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=s[_].masking_adj*.9):c!=0?u.maskingadjust_short=s[_].masking_adj*1.1:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=s[_].masking_adj*1.1),c!=0?u.ATHlower=-s[_].ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-s[_].ath_lower/10),c!=0?u.ATHcurve=s[_].ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=s[_].ath_curve),c!=0?u.interChRatio=s[_].interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=s[_].interch),m}this.apply_preset=function(u,m,c){switch(m){case Je.R3MIX:{m=Je.V3,u.VBR=jn.vbr_mtrh;break}case Je.MEDIUM:{m=Je.V4,u.VBR=jn.vbr_rh;break}case Je.MEDIUM_FAST:{m=Je.V4,u.VBR=jn.vbr_mtrh;break}case Je.STANDARD:{m=Je.V2,u.VBR=jn.vbr_rh;break}case Je.STANDARD_FAST:{m=Je.V2,u.VBR=jn.vbr_mtrh;break}case Je.EXTREME:{m=Je.V0,u.VBR=jn.vbr_rh;break}case Je.EXTREME_FAST:{m=Je.V0,u.VBR=jn.vbr_mtrh;break}case Je.INSANE:return m=320,u.preset=m,l(u,m,c),u.VBR=jn.vbr_off,m}switch(u.preset=m,m){case Je.V9:return i(u,9,c),m;case Je.V8:return i(u,8,c),m;case Je.V7:return i(u,7,c),m;case Je.V6:return i(u,6,c),m;case Je.V5:return i(u,5,c),m;case Je.V4:return i(u,4,c),m;case Je.V3:return i(u,3,c),m;case Je.V2:return i(u,2,c),m;case Je.V1:return i(u,1,c),m;case Je.V0:return i(u,0,c),m}return m>=8&&m<=320?l(u,m,c):(u.preset=0,m)};function f(u,m){var c=0;return m<0&&(c=-1,m=0),m>9&&(c=-1,m=9),u.VBR_q=m,u.VBR_q_frac=0,c}}function h4(){this.setModules=function(e,t){}}function zo(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var i1=Ie.new_float,v4=Ie.new_int;function p4(){this.global_gain=0,this.sfb_count1=0,this.step=v4(39),this.noise=i1(39),this.noise_log=i1(39)}var dr=Ie.System,a1=Ie.VbrMode,Po=Ie.Util,ii=Ie.Arrays,Pi=Ie.new_float,Vi=Ie.assert;function _4(){var e;this.rv=null;var t;this.qupvt=null;var n,r=new h4,a;this.setModules=function(C,p,A,F){e=C,t=p,this.rv=p,n=A,this.qupvt=A,a=F,r.setModules(n,a)},this.ms_convert=function(C,p){for(var A=0;A<576;++A){var F=C.tt[p][0].xr[A],R=C.tt[p][1].xr[A];C.tt[p][0].xr[A]=(F+R)*(Po.SQRT2*.5),C.tt[p][1].xr[A]=(F-R)*(Po.SQRT2*.5)}};function i(C,p,A,F){F=0;for(var R=0;R<=A;++R){var I=Math.abs(C.xr[R]);F+=I,p[R]=Math.sqrt(I*Math.sqrt(I)),p[R]>C.xrpow_max&&(C.xrpow_max=p[R])}return F}this.init_xrpow=function(C,p,A){var F=0,R=0|p.max_nonzero_coeff;if(p.xrpow_max=0,ii.fill(A,R,576,0),F=i(p,A,R,F),F>1e-20){var I=0;(C.substep_shaping&2)!=0&&(I=1);for(var h=0;h<p.psymax;h++)C.pseudohalf[h]=I;return!0}return ii.fill(p.l3_enc,0,576,0),!1};function s(C,p){var A=C.ATH,F=p.xr;if(p.block_type!=j.SHORT_TYPE)for(var R=!1,I=j.PSFB21-1;I>=0&&!R;I--){var h=C.scalefac_band.psfb21[I],M=C.scalefac_band.psfb21[I+1],S=n.athAdjust(A.adjust,A.psfb21[I],A.floor);C.nsPsy.longfact[21]>1e-12&&(S*=C.nsPsy.longfact[21]);for(var v=M-1;v>=h;v--)if(Math.abs(F[v])<S)F[v]=0;else{R=!0;break}}else for(var y=0;y<3;y++)for(var R=!1,I=j.PSFB12-1;I>=0&&!R;I--){var h=C.scalefac_band.s[12]*3+(C.scalefac_band.s[13]-C.scalefac_band.s[12])*y+(C.scalefac_band.psfb12[I]-C.scalefac_band.psfb12[0]),M=h+(C.scalefac_band.psfb12[I+1]-C.scalefac_band.psfb12[I]),x=n.athAdjust(A.adjust,A.psfb12[I],A.floor);C.nsPsy.shortfact[12]>1e-12&&(x*=C.nsPsy.shortfact[12]);for(var v=M-1;v>=h;v--)if(Math.abs(F[v])<x)F[v]=0;else{R=!0;break}}}this.init_outer_loop=function(C,p){p.part2_3_length=0,p.big_values=0,p.count1=0,p.global_gain=210,p.scalefac_compress=0,p.table_select[0]=0,p.table_select[1]=0,p.table_select[2]=0,p.subblock_gain[0]=0,p.subblock_gain[1]=0,p.subblock_gain[2]=0,p.subblock_gain[3]=0,p.region0_count=0,p.region1_count=0,p.preflag=0,p.scalefac_scale=0,p.count1table_select=0,p.part2_length=0,p.sfb_lmax=j.SBPSY_l,p.sfb_smin=j.SBPSY_s,p.psy_lmax=C.sfb21_extra?j.SBMAX_l:j.SBPSY_l,p.psymax=p.psy_lmax,p.sfbmax=p.sfb_lmax,p.sfbdivide=11;for(var A=0;A<j.SBMAX_l;A++)p.width[A]=C.scalefac_band.l[A+1]-C.scalefac_band.l[A],p.window[A]=3;if(p.block_type==j.SHORT_TYPE){var F=Pi(576);p.sfb_smin=0,p.sfb_lmax=0,p.mixed_block_flag!=0&&(p.sfb_smin=3,p.sfb_lmax=C.mode_gr*2+4),p.psymax=p.sfb_lmax+3*((C.sfb21_extra?j.SBMAX_s:j.SBPSY_s)-p.sfb_smin),p.sfbmax=p.sfb_lmax+3*(j.SBPSY_s-p.sfb_smin),p.sfbdivide=p.sfbmax-18,p.psy_lmax=p.sfb_lmax;var R=C.scalefac_band.l[p.sfb_lmax];dr.arraycopy(p.xr,0,F,0,576);for(var A=p.sfb_smin;A<j.SBMAX_s;A++)for(var I=C.scalefac_band.s[A],h=C.scalefac_band.s[A+1],M=0;M<3;M++)for(var S=I;S<h;S++)p.xr[R++]=F[3*S+M];for(var v=p.sfb_lmax,A=p.sfb_smin;A<j.SBMAX_s;A++)p.width[v]=p.width[v+1]=p.width[v+2]=C.scalefac_band.s[A+1]-C.scalefac_band.s[A],p.window[v]=0,p.window[v+1]=1,p.window[v+2]=2,v+=3}p.count1bits=0,p.sfb_partition_table=n.nr_of_sfb_block[0][0],p.slen[0]=0,p.slen[1]=0,p.slen[2]=0,p.slen[3]=0,p.max_nonzero_coeff=575,ii.fill(p.scalefac,0),s(C,p)};function l(C){this.ordinal=C}l.BINSEARCH_NONE=new l(0),l.BINSEARCH_UP=new l(1),l.BINSEARCH_DOWN=new l(2);function f(C,p,A,F,R){var I,h=C.CurrentStep[F],M=!1,S=C.OldValue[F],v=l.BINSEARCH_NONE;for(p.global_gain=S,A-=p.part2_length;;){var y;if(I=a.count_bits(C,R,p,null),h==1||I==A)break;I>A?(v==l.BINSEARCH_DOWN&&(M=!0),M&&(h/=2),v=l.BINSEARCH_UP,y=h):(v==l.BINSEARCH_UP&&(M=!0),M&&(h/=2),v=l.BINSEARCH_DOWN,y=-h),p.global_gain+=y,p.global_gain<0&&(p.global_gain=0,M=!0),p.global_gain>255&&(p.global_gain=255,M=!0)}for(Vi(p.global_gain>=0),Vi(p.global_gain<256);I>A&&p.global_gain<255;)p.global_gain++,I=a.count_bits(C,R,p,null);return C.CurrentStep[F]=S-p.global_gain>=4?4:2,C.OldValue[F]=p.global_gain,p.part2_3_length=I,I}this.trancate_smallspectrums=function(C,p,A,F){var R=Pi(cr.SFBMAX);if(!((C.substep_shaping&4)==0&&p.block_type==j.SHORT_TYPE||(C.substep_shaping&128)!=0)){n.calc_noise(p,A,R,new zo,null);for(var h=0;h<576;h++){var I=0;p.l3_enc[h]!=0&&(I=Math.abs(p.xr[h])),F[h]=I}var h=0,M=8;p.block_type==j.SHORT_TYPE&&(M=6);do{var S,v,y,x,w=p.width[M];if(h+=w,!(R[M]>=1)&&(ii.sort(F,h-w,w),!BitStream.EQ(F[h-1],0))){S=(1-R[M])*A[M],v=0,x=0;do{var k;for(y=1;x+y<w&&!BitStream.NEQ(F[x+h-w],F[x+h+y-w]);y++);if(k=F[x+h-w]*F[x+h-w]*y,S<k){x!=0&&(v=F[x+h-w-1]);break}S-=k,x+=y}while(x<w);if(!BitStream.EQ(v,0))do Math.abs(p.xr[h-w])<=v&&(p.l3_enc[h-w]=0);while(--w>0)}}while(++M<p.psymax);p.part2_3_length=a.noquant_count_bits(C,p,null)}};function u(C){for(var p=0;p<C.sfbmax;p++)if(C.scalefac[p]+C.subblock_gain[C.window[p]]==0)return!1;return!0}function m(C){return Po.FAST_LOG10(.368+.632*C*C*C)}function c(C,p){for(var A=1e-37,F=0;F<p.psymax;F++)A+=m(C[F]);return Math.max(1e-20,A)}function b(C,p,A,F,R){var I;switch(C){default:case 9:{p.over_count>0?(I=A.over_SSD<=p.over_SSD,A.over_SSD==p.over_SSD&&(I=A.bits<p.bits)):I=A.max_noise<0&&A.max_noise*10+A.bits<=p.max_noise*10+p.bits;break}case 0:I=A.over_count<p.over_count||A.over_count==p.over_count&&A.over_noise<p.over_noise||A.over_count==p.over_count&&BitStream.EQ(A.over_noise,p.over_noise)&&A.tot_noise<p.tot_noise;break;case 8:A.max_noise=c(R,F);case 1:I=A.max_noise<p.max_noise;break;case 2:I=A.tot_noise<p.tot_noise;break;case 3:I=A.tot_noise<p.tot_noise&&A.max_noise<p.max_noise;break;case 4:I=A.max_noise<=0&&p.max_noise>.2||A.max_noise<=0&&p.max_noise<0&&p.max_noise>A.max_noise-.2&&A.tot_noise<p.tot_noise||A.max_noise<=0&&p.max_noise>0&&p.max_noise>A.max_noise-.2&&A.tot_noise<p.tot_noise+p.over_noise||A.max_noise>0&&p.max_noise>-.05&&p.max_noise>A.max_noise-.1&&A.tot_noise+A.over_noise<p.tot_noise+p.over_noise||A.max_noise>0&&p.max_noise>-.1&&p.max_noise>A.max_noise-.15&&A.tot_noise+A.over_noise+A.over_noise<p.tot_noise+p.over_noise+p.over_noise;break;case 5:I=A.over_noise<p.over_noise||BitStream.EQ(A.over_noise,p.over_noise)&&A.tot_noise<p.tot_noise;break;case 6:I=A.over_noise<p.over_noise||BitStream.EQ(A.over_noise,p.over_noise)&&(A.max_noise<p.max_noise||BitStream.EQ(A.max_noise,p.max_noise)&&A.tot_noise<=p.tot_noise);break;case 7:I=A.over_count<p.over_count||A.over_noise<p.over_noise;break}return p.over_count==0&&(I=I&&A.bits<p.bits),I}function _(C,p,A,F,R){var I=C.internal_flags,h;p.scalefac_scale==0?h=1.2968395546510096:h=1.6817928305074292;for(var M=0,S=0;S<p.sfbmax;S++)M<A[S]&&(M=A[S]);var v=I.noise_shaping_amp;switch(v==3&&(R?v=2:v=1),v){case 2:break;case 1:M>1?M=Math.pow(M,.5):M*=.95;break;case 0:default:M>1?M=1:M*=.95;break}for(var y=0,S=0;S<p.sfbmax;S++){var x=p.width[S],w;if(y+=x,!(A[S]<M)){if((I.substep_shaping&2)!=0&&(I.pseudohalf[S]=I.pseudohalf[S]==0?1:0,I.pseudohalf[S]==0&&I.noise_shaping_amp==2))return;for(p.scalefac[S]++,w=-x;w<0;w++)F[y+w]*=h,F[y+w]>p.xrpow_max&&(p.xrpow_max=F[y+w]);if(I.noise_shaping_amp==2)return}}}function o(C,p){for(var A=1.2968395546510096,F=0,R=0;R<C.sfbmax;R++){var I=C.width[R],h=C.scalefac[R];if(C.preflag!=0&&(h+=n.pretab[R]),F+=I,(h&1)!=0){h++;for(var M=-I;M<0;M++)p[F+M]*=A,p[F+M]>C.xrpow_max&&(C.xrpow_max=p[F+M])}C.scalefac[R]=h>>1}C.preflag=0,C.scalefac_scale=1}function B(C,p,A){var F,R=p.scalefac;for(F=0;F<p.sfb_lmax;F++)if(R[F]>=16)return!0;for(var I=0;I<3;I++){var h=0,M=0;for(F=p.sfb_lmax+I;F<p.sfbdivide;F+=3)h<R[F]&&(h=R[F]);for(;F<p.sfbmax;F+=3)M<R[F]&&(M=R[F]);if(!(h<16&&M<8)){if(p.subblock_gain[I]>=7)return!0;p.subblock_gain[I]++;var S=C.scalefac_band.l[p.sfb_lmax];for(F=p.sfb_lmax+I;F<p.sfbmax;F+=3){var v,y=p.width[F],x=R[F];if(x=x-(4>>p.scalefac_scale),x>=0){R[F]=x,S+=y*3;continue}R[F]=0;{var w=210+(x<<p.scalefac_scale+1);v=n.IPOW20(w)}S+=y*(I+1);for(var k=-y;k<0;k++)A[S+k]*=v,A[S+k]>p.xrpow_max&&(p.xrpow_max=A[S+k]);S+=y*(3-I-1)}{var v=n.IPOW20(202);S+=p.width[F]*(I+1);for(var k=-p.width[F];k<0;k++)A[S+k]*=v,A[S+k]>p.xrpow_max&&(p.xrpow_max=A[S+k])}}}return!1}function T(C,p,A,F,R){var I=C.internal_flags;_(C,p,A,F,R);var h=u(p);return h?!1:(I.mode_gr==2?h=a.scale_bitcount(p):h=a.scale_bitcount_lsf(I,p),h?(I.noise_shaping>1&&(ii.fill(I.pseudohalf,0),p.scalefac_scale==0?(o(p,F),h=!1):p.block_type==j.SHORT_TYPE&&I.subblock_gain>0&&(h=B(I,p,F)||u(p))),h||(I.mode_gr==2?h=a.scale_bitcount(p):h=a.scale_bitcount_lsf(I,p)),!h):!0)}this.outer_loop=function(C,p,A,F,R,I){var h=C.internal_flags,M=new Ya,S=Pi(576),v=Pi(cr.SFBMAX),y=new zo,x,w=new p4,k=9999999,g=!1,D=!1,Y=0;if(f(h,p,I,R,F),h.noise_shaping==0)return 100;n.calc_noise(p,A,v,y,w),y.bits=p.part2_3_length,M.assign(p);var z=0;for(dr.arraycopy(F,0,S,0,576);!g;){do{var U=new zo,d,E=255;if((h.substep_shaping&2)!=0?d=20:d=3,h.sfb21_extra&&(v[M.sfbmax]>1||M.block_type==j.SHORT_TYPE&&(v[M.sfbmax+1]>1||v[M.sfbmax+2]>1))||!T(C,M,v,F,D))break;M.scalefac_scale!=0&&(E=254);var W=I-M.part2_length;if(W<=0)break;for(;(M.part2_3_length=a.count_bits(h,F,M,w))>W&&M.global_gain<=E;)M.global_gain++;if(M.global_gain>E)break;if(y.over_count==0){for(;(M.part2_3_length=a.count_bits(h,F,M,w))>k&&M.global_gain<=E;)M.global_gain++;if(M.global_gain>E)break}if(n.calc_noise(M,A,v,U,w),U.bits=M.part2_3_length,p.block_type!=j.SHORT_TYPE?x=C.quant_comp:x=C.quant_comp_short,x=b(x,y,U,M,v)?1:0,x!=0)k=p.part2_3_length,y=U,p.assign(M),z=0,dr.arraycopy(F,0,S,0,576);else if(h.full_outer_loop==0&&(++z>d&&y.over_count==0||h.noise_shaping_amp==3&&D&&z>30||h.noise_shaping_amp==3&&D&&M.global_gain-Y>15))break}while(M.global_gain+M.scalefac_scale<255);h.noise_shaping_amp==3?D?g=!0:(M.assign(p),dr.arraycopy(S,0,F,0,576),z=0,Y=M.global_gain,D=!0):g=!0}return Vi(p.global_gain+p.scalefac_scale<=255),C.VBR==a1.vbr_rh||C.VBR==a1.vbr_mtrh?dr.arraycopy(S,0,F,0,576):(h.substep_shaping&1)!=0&&trancate_smallspectrums(h,p,A,F),y.over_count},this.iteration_finish_one=function(C,p,A){var F=C.l3_side,R=F.tt[p][A];a.best_scalefac_store(C,p,A,F),C.use_best_huffman==1&&a.best_huffman_divide(C,R),t.ResvAdjust(C,R)},this.VBR_encode_granule=function(C,p,A,F,R,I,h){var M=C.internal_flags,S=new Ya,v=Pi(576),y=h,x=h+1,w=(h+I)/2,k,g,D=0,Y=M.sfb21_extra;Vi(y<=LameInternalFlags.MAX_BITS_PER_CHANNEL),ii.fill(S.l3_enc,0);do w>y-42?M.sfb21_extra=!1:M.sfb21_extra=Y,g=outer_loop(C,p,A,F,R,w),g<=0?(D=1,x=p.part2_3_length,S.assign(p),dr.arraycopy(F,0,v,0,576),h=x-32,k=h-I,w=(h+I)/2):(I=w+32,k=h-I,w=(h+I)/2,D!=0&&(D=2,p.assign(S),dr.arraycopy(v,0,F,0,576)));while(k>12);M.sfb21_extra=Y,D==2&&dr.arraycopy(S.l3_enc,0,p.l3_enc,0,576),Vi(p.part2_3_length<=y)},this.get_framebits=function(C,p){var A=C.internal_flags;A.bitrate_index=A.VBR_min_bitrate;var F=e.getframebits(C);A.bitrate_index=1,F=e.getframebits(C);for(var R=1;R<=A.VBR_max_bitrate;R++){A.bitrate_index=R;var I=new MeanBits(F);p[R]=t.ResvFrameBegin(C,I),F=I.bits}},this.VBR_old_prepare=function(C,p,A,F,R,I,h,M,S){var v=C.internal_flags,y,x=0,w=1,k=0;v.bitrate_index=v.VBR_max_bitrate;var g=t.ResvFrameBegin(C,new MeanBits(0))/v.mode_gr;get_framebits(C,I);for(var D=0;D<v.mode_gr;D++){var Y=n.on_pe(C,p,M[D],g,D,0);v.mode_ext==j.MPG_MD_MS_LR&&(ms_convert(v.l3_side,D),n.reduce_side(M[D],A[D],g,Y));for(var z=0;z<v.channels_out;++z){var U=v.l3_side.tt[D][z];U.block_type!=j.SHORT_TYPE?(x=1.28/(1+Math.exp(3.5-p[D][z]/300))-.05,y=v.PSY.mask_adjust-x):(x=2.56/(1+Math.exp(3.5-p[D][z]/300))-.14,y=v.PSY.mask_adjust_short-x),v.masking_lower=Math.pow(10,y*.1),init_outer_loop(v,U),S[D][z]=n.calc_xmin(C,F[D][z],U,R[D][z]),S[D][z]!=0&&(w=0),h[D][z]=126,k+=M[D][z]}}for(var D=0;D<v.mode_gr;D++)for(var z=0;z<v.channels_out;z++)k>I[v.VBR_max_bitrate]&&(M[D][z]*=I[v.VBR_max_bitrate],M[D][z]/=k),h[D][z]>M[D][z]&&(h[D][z]=M[D][z]);return w},this.bitpressure_strategy=function(C,p,A,F){for(var R=0;R<C.mode_gr;R++)for(var I=0;I<C.channels_out;I++){for(var h=C.l3_side.tt[R][I],M=p[R][I],S=0,v=0;v<h.psy_lmax;v++)M[S++]*=1+.029*v*v/j.SBMAX_l/j.SBMAX_l;if(h.block_type==j.SHORT_TYPE)for(var v=h.sfb_smin;v<j.SBMAX_s;v++)M[S++]*=1+.029*v*v/j.SBMAX_s/j.SBMAX_s,M[S++]*=1+.029*v*v/j.SBMAX_s/j.SBMAX_s,M[S++]*=1+.029*v*v/j.SBMAX_s/j.SBMAX_s;F[R][I]=0|Math.max(A[R][I],.9*F[R][I])}},this.VBR_new_prepare=function(C,p,A,F,R,I){var h=C.internal_flags,M=1,S=0,v=0,y;if(C.free_format){h.bitrate_index=0;var x=new MeanBits(S);y=t.ResvFrameBegin(C,x),S=x.bits,R[0]=y}else{h.bitrate_index=h.VBR_max_bitrate;var x=new MeanBits(S);t.ResvFrameBegin(C,x),S=x.bits,get_framebits(C,R),y=R[h.VBR_max_bitrate]}for(var w=0;w<h.mode_gr;w++){n.on_pe(C,p,I[w],S,w,0),h.mode_ext==j.MPG_MD_MS_LR&&ms_convert(h.l3_side,w);for(var k=0;k<h.channels_out;++k){var g=h.l3_side.tt[w][k];h.masking_lower=Math.pow(10,h.PSY.mask_adjust*.1),init_outer_loop(h,g),n.calc_xmin(C,A[w][k],g,F[w][k])!=0&&(M=0),v+=I[w][k]}}for(var w=0;w<h.mode_gr;w++)for(var k=0;k<h.channels_out;k++)v>y&&(I[w][k]*=y,I[w][k]/=v);return M},this.calc_target_bits=function(C,p,A,F,R,I){var h=C.internal_flags,M=h.l3_side,S,v,y,x,w=0;h.bitrate_index=h.VBR_max_bitrate;var k=new MeanBits(w);for(I[0]=t.ResvFrameBegin(C,k),w=k.bits,h.bitrate_index=1,w=e.getframebits(C)-h.sideinfo_len*8,R[0]=w/(h.mode_gr*h.channels_out),w=C.VBR_mean_bitrate_kbps*C.framesize*1e3,(h.substep_shaping&1)!=0&&(w*=1.09),w/=C.out_samplerate,w-=h.sideinfo_len*8,w/=h.mode_gr*h.channels_out,S=.93+.07*(11-C.compression_ratio)/(11-5.5),S<.9&&(S=.9),S>1&&(S=1),v=0;v<h.mode_gr;v++){var g=0;for(y=0;y<h.channels_out;y++){if(F[v][y]=int(S*w),p[v][y]>700){var D=int((p[v][y]-700)/1.4),Y=M.tt[v][y];F[v][y]=int(S*w),Y.block_type==j.SHORT_TYPE&&D<w/2&&(D=w/2),D>w*3/2?D=w*3/2:D<0&&(D=0),F[v][y]+=D}F[v][y]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(F[v][y]=LameInternalFlags.MAX_BITS_PER_CHANNEL),g+=F[v][y]}if(g>LameInternalFlags.MAX_BITS_PER_GRANULE)for(y=0;y<h.channels_out;++y)F[v][y]*=LameInternalFlags.MAX_BITS_PER_GRANULE,F[v][y]/=g}if(h.mode_ext==j.MPG_MD_MS_LR)for(v=0;v<h.mode_gr;v++)n.reduce_side(F[v],A[v],w*h.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(x=0,v=0;v<h.mode_gr;v++)for(y=0;y<h.channels_out;y++)F[v][y]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(F[v][y]=LameInternalFlags.MAX_BITS_PER_CHANNEL),x+=F[v][y];if(x>I[0])for(v=0;v<h.mode_gr;v++)for(y=0;y<h.channels_out;y++)F[v][y]*=I[0],F[v][y]/=x}}var s1=Ie.assert;function g4(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var r=t.internal_flags,a,i=r.l3_side,s=e.getframebits(t);n.bits=(s-r.sideinfo_len*8)/r.mode_gr;var l=8*256*r.mode_gr-8;t.brate>320?a=8*int(t.brate*1e3/(t.out_samplerate/1152)/8+.5):(a=8*1440,t.strict_ISO&&(a=8*int(32e4/(t.out_samplerate/1152)/8+.5))),r.ResvMax=a-s,r.ResvMax>l&&(r.ResvMax=l),(r.ResvMax<0||t.disable_reservoir)&&(r.ResvMax=0);var f=n.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return f>a&&(f=a),s1(r.ResvMax%8==0),s1(r.ResvMax>=0),i.resvDrain_pre=0,r.pinfo!=null&&(r.pinfo.mean_bits=n.bits/2,r.pinfo.resvsize=r.ResvSize),f},this.ResvMaxBits=function(t,n,r,a){var i=t.internal_flags,s,l=i.ResvSize,f=i.ResvMax;a!=0&&(l+=n),(i.substep_shaping&1)!=0&&(f*=.9),r.bits=n,l*10>f*9?(s=l-f*9/10,r.bits+=s,i.substep_shaping|=128):(s=0,i.substep_shaping&=127,!t.disable_reservoir&&(i.substep_shaping&1)==0&&(r.bits-=.1*n));var u=l<i.ResvMax*6/10?l:i.ResvMax*6/10;return u-=s,u<0&&(u=0),u},this.ResvAdjust=function(t,n){t.ResvSize-=n.part2_3_length+n.part2_length},this.ResvFrameEnd=function(t,n){var r,a=t.l3_side;t.ResvSize+=n*t.mode_gr;var i=0;a.resvDrain_post=0,a.resvDrain_pre=0,(r=t.ResvSize%8)!=0&&(i+=r),r=t.ResvSize-i-t.ResvMax,r>0&&(i+=r);{var s=Math.min(a.main_data_begin*8,i)/8;a.resvDrain_pre+=8*s,i-=8*s,t.ResvSize-=8*s,a.main_data_begin-=s}a.resvDrain_post+=i,t.ResvSize-=i}}function b4(){var e="http://www.mp3dev.org/",t=3,n=98,r=4,a=0,i=93;this.getLameVersion=function(){return t+"."+n+"."+r},this.getLameShortVersion=function(){return t+"."+n+"."+r},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+n+"r"},this.getPsyVersion=function(){return a+"."+i},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var x4=Ie.System,Vo=Ie.VbrMode,o1=Ie.ShortBlock,y4=Ie.Arrays,Qa=Ie.new_byte,w4=Ie.assert;Ui.NUMTOCENTRIES=100,Ui.MAXFRAMESIZE=2880;function Ui(){var e,t,n;this.setModules=function(w,k,g){e=w,t=k,n=g};var r=1,a=2,i=4,s=8,l=Ui.NUMTOCENTRIES,f=Ui.MAXFRAMESIZE,u=l+4+4+4+4+4,m=u+9+1+1+8+1+1+3+1+1+2+4+2+2,c=128,b=64,_=32,o=null,B="Xing",T="Info",C=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function p(w,k){if(w.nVbrNumFrames++,w.sum+=k,w.seen++,!(w.seen<w.want)&&(w.pos<w.size&&(w.bag[w.pos]=w.sum,w.pos++,w.seen=0),w.pos==w.size)){for(var g=1;g<w.size;g+=2)w.bag[g/2]=w.bag[g];w.want*=2,w.pos/=2}}function A(w,k){if(!(w.pos<=0))for(var g=1;g<l;++g){var D=g/l,Y,z,U=0|Math.floor(D*w.pos);U>w.pos-1&&(U=w.pos-1),Y=w.bag[U],z=w.sum;var d=0|256*Y/z;d>255&&(d=255),k[g]=255&d}}this.addVbrFrame=function(w){var k=w.internal_flags,g=Tables.bitrate_table[w.version][k.bitrate_index];w4(k.VBR_seek_table.bag!=null),p(k.VBR_seek_table,g)};function F(w,k){var g=w[k+0]&255;return g<<=8,g|=w[k+1]&255,g<<=8,g|=w[k+2]&255,g<<=8,g|=w[k+3]&255,g}function R(w,k,g){w[k+0]=255&(g>>24&255),w[k+1]=255&(g>>16&255),w[k+2]=255&(g>>8&255),w[k+3]=255&(g&255)}function I(w,k,g){w[k+0]=255&(g>>8&255),w[k+1]=255&(g&255)}function h(w,k){return new String(w,k,B.length(),o).equals(B)||new String(w,k,T.length(),o).equals(T)}function M(w,k,g){return 255&(w<<k|g&~(-1<<k))}function S(w,k){var g=w.internal_flags;k[0]=M(k[0],8,255),k[1]=M(k[1],3,7),k[1]=M(k[1],1,w.out_samplerate<16e3?0:1),k[1]=M(k[1],1,w.version),k[1]=M(k[1],2,4-3),k[1]=M(k[1],1,w.error_protection?0:1),k[2]=M(k[2],4,g.bitrate_index),k[2]=M(k[2],2,g.samplerate_index),k[2]=M(k[2],1,0),k[2]=M(k[2],1,w.extension),k[3]=M(k[3],2,w.mode.ordinal()),k[3]=M(k[3],2,g.mode_ext),k[3]=M(k[3],1,w.copyright),k[3]=M(k[3],1,w.original),k[3]=M(k[3],2,w.emphasis),k[0]=255;var D=255&(k[1]&241),Y;w.version==1?Y=c:w.out_samplerate<16e3?Y=_:Y=b,w.VBR==Vo.vbr_off&&(Y=w.brate);var z;w.free_format?z=0:z=255&16*e.BitrateIndex(Y,w.version,w.out_samplerate),w.version==1?(k[1]=255&(D|10),D=255&(k[2]&13),k[2]=255&(z|D)):(k[1]=255&(D|2),D=255&(k[2]&13),k[2]=255&(z|D))}this.getVbrTag=function(w){var k=new VBRTagData,g=0;k.flags=0;var D=w[g+1]>>3&1,Y=w[g+2]>>2&3,z=w[g+3]>>6&3,U=w[g+2]>>4&15;if(U=Tables.bitrate_table[D][U],w[g+1]>>4==14?k.samprate=Tables.samplerate_table[2][Y]:k.samprate=Tables.samplerate_table[D][Y],D!=0?z!=3?g+=32+4:g+=17+4:z!=3?g+=17+4:g+=9+4,!h(w,g))return null;g+=4,k.hId=D;var d=k.flags=F(w,g);if(g+=4,(d&r)!=0&&(k.frames=F(w,g),g+=4),(d&a)!=0&&(k.bytes=F(w,g),g+=4),(d&i)!=0){if(k.toc!=null)for(var E=0;E<l;E++)k.toc[E]=w[g+E];g+=l}k.vbrScale=-1,(d&s)!=0&&(k.vbrScale=F(w,g),g+=4),k.headersize=(D+1)*72e3*U/k.samprate,g+=21;var W=w[g+0]<<4;W+=w[g+1]>>4;var O=(w[g+1]&15)<<8;return O+=w[g+2]&255,(W<0||W>3e3)&&(W=-1),(O<0||O>3e3)&&(O=-1),k.encDelay=W,k.encPadding=O,k},this.InitVbrTag=function(w){var k=w.internal_flags,g;w.version==1?g=c:w.out_samplerate<16e3?g=_:g=b,w.VBR==Vo.vbr_off&&(g=w.brate);var D=(w.version+1)*72e3*g/w.out_samplerate,Y=k.sideinfo_len+m;if(k.VBR_seek_table.TotalFrameSize=D,D<Y||D>f){w.bWriteVbrTag=!1;return}k.VBR_seek_table.nVbrNumFrames=0,k.VBR_seek_table.nBytesWritten=0,k.VBR_seek_table.sum=0,k.VBR_seek_table.seen=0,k.VBR_seek_table.want=1,k.VBR_seek_table.pos=0,k.VBR_seek_table.bag==null&&(k.VBR_seek_table.bag=new int[400],k.VBR_seek_table.size=400);var z=Qa(f);S(w,z);for(var U=k.VBR_seek_table.TotalFrameSize,d=0;d<U;++d)t.add_dummy_byte(w,z[d]&255,1)};function v(w,k){var g=k^w;return k=k>>8^C[g&255],k}this.updateMusicCRC=function(w,k,g,D){for(var Y=0;Y<D;++Y)w[0]=v(k[g+Y],w[0])};function y(w,k,g,D,Y){var z=w.internal_flags,U=0,d=w.encoder_delay,E=w.encoder_padding,W=100-10*w.VBR_q-w.quality,O=n.getLameVeryShortVersion(),me,Se=0,_e,pe=[1,5,3,2,4,0,3],De=0|(w.lowpassfreq/100+.5>255?255:w.lowpassfreq/100+.5),Ce=0,he=0,Ue=0,rt=w.internal_flags.noise_shaping,P=0,X=0,ne=0,ce=0,de=0,Ae=(w.exp_nspsytune&1)!=0,Ee=(w.exp_nspsytune&2)!=0,ye=!1,Me=!1,ge=w.internal_flags.nogap_total,ze=w.internal_flags.nogap_current,je=w.ATHtype,Pe=0,Ve;switch(w.VBR){case vbr_abr:Ve=w.VBR_mean_bitrate_kbps;break;case vbr_off:Ve=w.brate;break;default:Ve=w.VBR_min_bitrate_kbps}switch(w.VBR.ordinal()<pe.length?me=pe[w.VBR.ordinal()]:me=0,_e=16*Se+me,z.findReplayGain&&(z.RadioGain>510&&(z.RadioGain=510),z.RadioGain<-510&&(z.RadioGain=-510),he=8192,he|=3072,z.RadioGain>=0?he|=z.RadioGain:(he|=512,he|=-z.RadioGain)),z.findPeakSample&&(Ce=Math.abs(0|z.PeakSample/32767*Math.pow(2,23)+.5)),ge!=-1&&(ze>0&&(Me=!0),ze<ge-1&&(ye=!0)),Pe=je+((Ae?1:0)<<4)+((Ee?1:0)<<5)+((ye?1:0)<<6)+((Me?1:0)<<7),W<0&&(W=0),w.mode){case MONO:P=0;break;case STEREO:P=1;break;case DUAL_CHANNEL:P=2;break;case JOINT_STEREO:w.force_ms?P=4:P=3;break;case NOT_SET:default:P=7;break}w.in_samplerate<=32e3?ne=0:w.in_samplerate==48e3?ne=2:w.in_samplerate>48e3?ne=3:ne=1,(w.short_blocks==o1.short_block_forced||w.short_blocks==o1.short_block_dispensed||w.lowpassfreq==-1&&w.highpassfreq==-1||w.scale_left<w.scale_right||w.scale_left>w.scale_right||w.disable_reservoir&&w.brate<320||w.noATH||w.ATHonly||je==0||w.in_samplerate<=32e3)&&(X=1),ce=rt+(P<<2)+(X<<5)+(ne<<6),de=z.nMusicCRC,R(g,D+U,W),U+=4;for(var Ge=0;Ge<9;Ge++)g[D+U+Ge]=255&O.charAt(Ge);U+=9,g[D+U]=255&_e,U++,g[D+U]=255&De,U++,R(g,D+U,Ce),U+=4,I(g,D+U,he),U+=2,I(g,D+U,Ue),U+=2,g[D+U]=255&Pe,U++,Ve>=255?g[D+U]=255:g[D+U]=255&Ve,U++,g[D+U]=255&d>>4,g[D+U+1]=255&(d<<4)+(E>>8),g[D+U+2]=255&E,U+=3,g[D+U]=255&ce,U++,g[D+U++]=0,I(g,D+U,w.preset),U+=2,R(g,D+U,k),U+=4,I(g,D+U,de),U+=2;for(var ue=0;ue<U;ue++)Y=v(g[D+ue],Y);return I(g,D+U,Y),U+=2,U}function x(w){w.seek(0);var k=Qa(10);w.readFully(k);var g;return new String(k,"ISO-8859-1").startsWith("ID3")?g=0:g=((k[6]&127)<<21|(k[7]&127)<<14|(k[8]&127)<<7|k[9]&127)+k.length,g}this.getLameTagFrame=function(w,k){var g=w.internal_flags;if(!w.bWriteVbrTag||g.Class_ID!=Lame.LAME_ID||g.VBR_seek_table.pos<=0)return 0;if(k.length<g.VBR_seek_table.TotalFrameSize)return g.VBR_seek_table.TotalFrameSize;y4.fill(k,0,g.VBR_seek_table.TotalFrameSize,0),S(w,k);var D=Qa(l);if(w.free_format)for(var Y=1;Y<l;++Y)D[Y]=255&255*Y/100;else A(g.VBR_seek_table,D);var z=g.sideinfo_len;w.error_protection&&(z-=2),w.VBR==Vo.vbr_off?(k[z++]=255&T.charAt(0),k[z++]=255&T.charAt(1),k[z++]=255&T.charAt(2),k[z++]=255&T.charAt(3)):(k[z++]=255&B.charAt(0),k[z++]=255&B.charAt(1),k[z++]=255&B.charAt(2),k[z++]=255&B.charAt(3)),R(k,z,r+a+i+s),z+=4,R(k,z,g.VBR_seek_table.nVbrNumFrames),z+=4;var U=g.VBR_seek_table.nBytesWritten+g.VBR_seek_table.TotalFrameSize;R(k,z,0|U),z+=4,x4.arraycopy(D,0,k,z,D.length),z+=D.length,w.error_protection&&t.CRC_writeheader(g,k);for(var d=0,Y=0;Y<z;Y++)d=v(k[Y],d);return z+=y(w,U,k,z,d),g.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(w,k){var g=w.internal_flags;if(g.VBR_seek_table.pos<=0||(k.seek(k.length()),k.length()==0))return-1;var D=x(k);k.seek(D);var Y=Qa(f),z=getLameTagFrame(w,Y);return z>Y.length?-1:(z<1||k.write(Y,0,z),0)}}var l1=Ie.new_byte,k4=Ie.assert;function S4(){this.setModules=function(e,t){}}function A4(){this.setModules=function(e,t,n){}}function M4(){}function E4(){this.setModules=function(e,t){}}function T4(e,t,n){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,n=128);var r=new Je,a=new S4,i=new Ct,s=new vn,l=new m4,f=new Vt,u=new _4,m=new Ui,c=new b4,b=new E4,_=new g4,o=new zi,B=new A4,T=new M4;r.setModules(i,s,l,f,u,m,c,b,T),s.setModules(i,T,c,m),b.setModules(s,c),l.setModules(r),u.setModules(s,_,f,o),f.setModules(o,_,r.enc.psy),_.setModules(s),o.setModules(f),m.setModules(r,s,c),a.setModules(B,T),B.setModules(c,b,l);var C=r.lame_init();C.num_channels=e,C.in_samplerate=t,C.brate=n,C.mode=ft.STEREO,C.quality=3,C.bWriteVbrTag=!1,C.disable_reservoir=!0,C.write_id3tag_automatic=!1,r.lame_init_params(C);var p=1152,A=0|1.25*p+7200,F=l1(A);this.encodeBuffer=function(R,I){e==1&&(I=R),k4(R.length==I.length),R.length>p&&(p=R.length,A=0|1.25*p+7200,F=l1(A));var h=r.lame_encode_buffer(C,R,I,R.length,F,0,A);return new Int8Array(F.subarray(0,h))},this.flush=function(){var R=r.lame_encode_flush(C,F,0,A);return new Int8Array(F.subarray(0,R))}}function Ja(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}Ja("RIFF"),Ja("WAVE"),Ja("fmt "),Ja("data");class R4{constructor(t){this.bitRate=t.bitRate,this.sampleRate=t.sampleRate,this.dataBuffer=[],this.encoder=new T4(1,this.sampleRate,this.bitRate)}encode(t){const r=this._convertBuffer(t);let a=r.length;for(let i=0;a>=0;i+=1152){const s=r.subarray(i,i+1152),l=this.encoder.encodeBuffer(s);this.dataBuffer.push(new Int8Array(l)),a-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const t=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:t,url:URL.createObjectURL(t)}}_floatTo16BitPCM(t,n){for(let r=0;r<t.length;r++){const a=Math.max(-1,Math.min(1,t[r]));n[r]=a<0?a*32768:a*32767}}_convertBuffer(t){const n=new Float32Array(t),r=new Int16Array(t.length);return this._floatTo16BitPCM(n,r),r}}class C4{constructor(t={}){this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const t={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(t).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this.lameEncoder||(this.lameEncoder=new R4(this.encoderOptions))}stop(){this.stream.getTracks().forEach(n=>n.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let t=null;t=this.lameEncoder.finish(),t.duration=this.duration,this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}pause(){this.stream.getTracks().forEach(t=>t.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(t){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(t),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=t,this.processor.onaudioprocess=n=>{const r=n.inputBuffer.getChannelData(0);let a=0;this.lameEncoder&&this.lameEncoder.encode(r);for(let i=0;i<r.length;++i)a+=r[i]*r[i];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(a/r.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(t){this.micFailed&&this.micFailed(t)}}var c1=window.chrome,Uo=window.navigator,I4=Uo.vendor,B4=typeof window.opr!="undefined",O4=Uo.userAgent.indexOf("Edg")>-1,L4=Uo.userAgent.match("CriOS");function F4(){return L4?!0:c1!==null&&typeof c1!="undefined"&&I4==="Google Inc."&&B4===!1&&O4===!1}function u1(){var e=j4(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function j4(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const N4={name:"RoomFooter",components:{SvgIcon:Dt,EmojiPickerContainer:Fu,RoomFiles:zg,RoomMessageReply:u3,RoomUsersTag:_3,RoomEmojis:w3,RoomTemplatesText:C3},directives:{clickOutside:Ta},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new iu({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(this.recorder.duration*1e3).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=u1();let t=!0;this.getTextareaRef().addEventListener("keyup",n=>{n.key==="Enter"&&!n.shiftKey&&!this.fileDialog&&(e?(this.message=this.message+`
`,setTimeout(()=>this.onChangeInput())):t&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),t=!n.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){u1()&&e||!this.getTextareaRef()||(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const t=F4()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+t,this.cursorRangePosition+t),this.cursorRangePosition=null}))},onChangeInput(){var e,t,n;(((e=this.getTextareaRef())==null?void 0:e.value)||((t=this.getTextareaRef())==null?void 0:t.value)==="")&&(this.message=(n=this.getTextareaRef())==null?void 0:n.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-t*2+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var n;const t=(n=e.clipboardData)==null?void 0:n.items;t&&Array.from(t).forEach(r=>{if(r.type.includes("image")){const a=r.getAsFile();this.onFileChange([a])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:n}=this.getCharPosition("/"),r=this.message.substr(n,n).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+r+this.message.substr(n,this.message.length-1),this.cursorRangePosition=t+e.text.length+r.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async t=>{const n=URL.createObjectURL(t),r=t.name.lastIndexOf(".");this.files.push({loading:!0,name:t.name.substring(0,r),size:t.size,type:t.type,extension:t.name.substring(r+1),localUrl:n});const a=await fetch(n).then(s=>s.blob());let i=this.files.find(s=>s.localUrl===n);i&&(i.blob=a,i.loading=!1,delete i.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,!this.recorder.isRecording)setTimeout(()=>this.recorder.start(),200);else try{this.recorder.stop();const t=this.recorder.records[0];this.files.push({blob:t.blob,name:`audio.${this.format}`,size:t.blob.size,duration:t.duration,type:t.blob.type,audio:!0,localUrl:URL.createObjectURL(t.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var n;let e=this.message.trim();if(!this.files.length&&!e||this.isFileLoading)return;this.selectedUsersTag.forEach(r=>{e=e.replace(`@${r.username}`,`<usertag>${r._id}</usertag>`)});const t=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==e||((n=this.editedMessage.files)==null?void 0:n.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,indexId:this.editedMessage.indexId,newContent:e,files:t,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:e,files:t,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const n=t,r="<usertag>",a="</usertag>";[...t.matchAll(new RegExp(r,"gi"))].map(s=>s.index).forEach(s=>{const l=n.substring(s+r.length,n.indexOf(a,s)),f=this.room.users.find(u=>u._id===l);t=t.replace(`${r}${l}${a}`,`@${(f==null?void 0:f.username)||"unknown"}`),this.selectUserTag(f,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef()||e===":"&&!this.emojisSuggestionEnabled||e==="@"&&(!this.userTagsEnabled||!this.room.users)||e==="/"&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let n=t;for(;n>0&&this.message.charAt(n-1)!==e&&(this.message.charAt(n-1)!==" "||e!==":");)n--;const r=this.message.charAt(n-2),a=!r.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(n-1)===e&&(!r||r===" "||a)){const i=this.message.substring(n,t);e===":"?this.updateEmojis(i):e==="@"?this.updateShowUsersTag(i):e==="/"&&this.updateShowTemplatesText(i)}else this.resetFooterList(e)},updateShowUsersTag(e){this.filteredUsersTag=po(this.room.users,"username",e,!0).filter(t=>t._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:n,endPosition:r}=this.getCharPosition("@"),a=this.message.substr(r,r).length?"":" ";this.message=this.message.substr(0,n)+e.username+a+this.message.substr(r,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=n+e.username.length+a.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=po(this.templatesText,"tag",e,!0)},getCharPosition(e){let n=this.getTextareaRef().selectionStart;for(;n>0&&this.message.charAt(n-1)!==e;)n--;const r=this.getTextareaRef().selectionEnd;return{position:n,endPosition:r}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(n=>n.unicode)},resetFooterList(e=null){e===":"?this.filteredEmojis=[]:e==="@"?this.filteredUsersTag=[]:e==="/"?this.filteredTemplatesText=[]:(this.filteredEmojis=[],this.filteredUsersTag=[],this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!t)&&setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new C4({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},D4={key:0,class:"vac-icon-textarea-left"},H4=ke("div",{class:"vac-dot-audio-record"},null,-1),z4={class:"vac-dot-audio-record-time"},P4=["placeholder"],V4={class:"vac-icon-textarea"},U4={key:1},q4=["accept","capture"];function X4(e,t,n,r,a,i){const s=Xe("room-emojis"),l=Xe("room-users-tag"),f=Xe("room-templates-text"),u=Xe("room-message-reply"),m=Xe("room-files"),c=Xe("svg-icon"),b=Xe("emoji-picker-container"),_=ma("click-outside");return Pn((Q(),se("div",{id:"room-footer",class:nt(["vac-room-footer",{"vac-app-box-shadow":i.shadowFooter}])},[Oe(s,{"filtered-emojis":a.filteredEmojis,"select-item":a.selectEmojiItem,"active-up-or-down":a.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=o=>i.selectEmoji(o)),onActivateItem:t[1]||(t[1]=o=>a.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Oe(l,{"filtered-users-tag":a.filteredUsersTag,"select-item":a.selectUsersTagItem,"active-up-or-down":a.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=o=>i.selectUserTag(o)),onActivateItem:t[3]||(t[3]=o=>a.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Oe(f,{"filtered-templates-text":a.filteredTemplatesText,"select-item":a.selectTemplatesTextItem,"active-up-or-down":a.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=o=>i.selectTemplateText(o)),onActivateItem:t[5]||(t[5]=o=>a.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Oe(u,{room:n.room,"message-reply":a.messageReply,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onResetMessage:i.resetMessage},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Oe(m,{files:a.files,onRemoveFile:i.removeFile,onResetMessage:i.resetMessage},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),ke("div",{class:nt(["vac-box-footer",{"vac-box-footer-border":!a.files.length}])},[n.showAudio&&!a.files.length?(Q(),se("div",D4,[a.isRecording?(Q(),se(st,{key:0},[ke("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...o)=>i.stopRecorder&&i.stopRecorder(...o))},[Re(e.$slots,"audio-stop-icon",{},()=>[Oe(c,{name:"close-outline"})])]),H4,ke("div",z4,Qe(i.recordedTime),1),ke("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=o=>i.toggleRecorder(!1))},[Re(e.$slots,"audio-check-icon",{},()=>[Oe(c,{name:"checkmark"})])])],64)):(Q(),se("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=o=>i.toggleRecorder(!0))},[Re(e.$slots,"microphone-icon",{},()=>[Oe(c,{name:"microphone",class:"vac-icon-microphone"})])]))])):Te("",!0),ke("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:n.textMessages.TYPE_MESSAGE,class:nt(["vac-textarea",{"vac-textarea-outline":a.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...o)=>i.onChangeInput&&i.onChangeInput(...o)),onKeydown:[t[10]||(t[10]=wr((...o)=>i.escapeTextarea&&i.escapeTextarea(...o),["esc"])),t[11]||(t[11]=wr(Rn((...o)=>i.selectItem&&i.selectItem(...o),["exact","prevent"]),["enter"])),t[13]||(t[13]=wr(Rn(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=wr((...o)=>i.selectItem&&i.selectItem(...o),["tab"])),t[15]||(t[15]=wr(o=>i.updateActiveUpOrDown(o,-1),["up"])),t[16]||(t[16]=wr(o=>i.updateActiveUpOrDown(o,1),["down"]))],onPaste:t[12]||(t[12]=(...o)=>i.onPasteImage&&i.onPasteImage(...o))},null,42,P4),ke("div",V4,[a.editedMessage._id?(Q(),se("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...o)=>i.resetMessage&&i.resetMessage(...o))},[Re(e.$slots,"edit-close-icon",{},()=>[Oe(c,{name:"close-outline"})])])):Te("",!0),n.showEmojis?Pn((Q(),se("div",U4,[Re(e.$slots,"emoji-picker",Us({emojiOpened:a.emojiOpened},{addEmoji:i.addEmoji}),()=>[Oe(b,{"emoji-opened":a.emojiOpened,"position-top":!0,"emoji-data-source":n.emojiDataSource,onAddEmoji:i.addEmoji,onOpenEmoji:t[18]||(t[18]=o=>a.emojiOpened=o)},{"emoji-picker-icon":Ke(()=>[Re(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[_,()=>a.emojiOpened=!1]]):Te("",!0),n.showFiles?(Q(),se("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...o)=>i.launchFilePicker&&i.launchFilePicker(...o))},[Re(e.$slots,"paperclip-icon",{},()=>[Oe(c,{name:"paperclip"})])])):Te("",!0),n.textareaActionEnabled?(Q(),se("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...o)=>i.textareaActionHandler&&i.textareaActionHandler(...o))},[Re(e.$slots,"custom-action-icon",{},()=>[Oe(c,{name:"deleted"})])])):Te("",!0),n.showFiles?(Q(),se("input",{key:4,ref:"file",type:"file",multiple:"",accept:n.acceptedFiles,capture:n.captureFiles,style:{display:"none"},onChange:t[21]||(t[21]=o=>i.onFileChange(o.target.files))},null,40,q4)):Te("",!0),n.showSendIcon?(Q(),se("div",{key:5,class:nt(["vac-svg-button",{"vac-send-disabled":i.isMessageEmpty}]),onClick:t[22]||(t[22]=(...o)=>i.sendMessage&&i.sendMessage(...o))},[Re(e.$slots,"send-icon",{},()=>[Oe(c,{name:"send",param:i.isMessageEmpty||i.isFileLoading?"disabled":""},null,8,["param"])])],2)):Te("",!0)])],2)],2)),[[xa,Object.keys(n.room).length&&n.showFooter]])}var Y4=xt(N4,[["render",X4]]);const K4={name:"MessageReply",components:{AudioPlayer:Lo,SvgIcon:Dt,FormatMessage:Mi},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(n=>n._id===e);return t?t.username:""},firstFile(){var e,t;return(t=(e=this.message.replyMessage)==null?void 0:e.files)!=null&&t.length?this.message.replyMessage.files[0]:{}},isAudio(){return Ra(this.firstFile)},isImage(){return Zr(this.firstFile)},isVideo(){return Ti(this.firstFile)},isOtherFile(){var e;return((e=this.message.replyMessage.files)==null?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},G4={class:"vac-reply-message"},W4={class:"vac-reply-username"},Z4={key:0,class:"vac-image-reply-container"},Q4={key:1,class:"vac-video-reply-container"},J4={controls:""},$4=["src"],eb={key:3,class:"vac-file-container"},tb={class:"vac-text-ellipsis"},nb={key:0,class:"vac-text-ellipsis vac-text-extension"},rb={class:"vac-reply-content"};function ib(e,t,n,r,a,i){const s=Xe("audio-player"),l=Xe("svg-icon"),f=Xe("format-message");return Q(),se("div",G4,[ke("div",W4,Qe(i.replyUsername),1),i.isImage?(Q(),se("div",Z4,[ke("div",{class:"vac-message-image vac-message-image-reply",style:St({"background-image":`url('${i.firstFile.url}')`})},null,4)])):i.isVideo?(Q(),se("div",Q4,[ke("video",J4,[ke("source",{src:i.firstFile.url},null,8,$4)])])):i.isAudio?(Q(),dt(s,{key:2,src:i.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=u=>e.progressTime=u),onHoverAudioProgress:t[1]||(t[1]=u=>e.hoverAudioProgress=u)},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["src"])):i.isOtherFile?(Q(),se("div",eb,[ke("div",null,[Re(e.$slots,"file-icon",{},()=>[Oe(l,{name:"file"})])]),ke("div",tb,Qe(i.firstFile.name),1),i.firstFile.extension?(Q(),se("div",nb,Qe(i.firstFile.extension),1)):Te("",!0)])):Te("",!0),ke("div",rb,[Oe(f,{"message-id":n.message.replyMessage._id,content:n.message.replyMessage.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var ab=xt(K4,[["render",ib]]);const sb={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const r=54*Math.PI;return{radius:35,stroke:4,normalizedRadius:27,circumference:r}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},ob={ref:"progress",class:"vac-progress-wrapper"},lb=["height","width"],cb=["stroke-dasharray","stroke-width","r","cx","cy"],ub={class:"vac-progress-text"},db=ke("span",{class:"vac-progress-pourcent"},"%",-1);function fb(e,t,n,r,a,i){return Q(),dt(It,{name:"vac-fade-spinner",appear:""},{default:Ke(()=>[ke("div",ob,[(Q(),se("svg",{height:a.radius*2,width:a.radius*2},[ke("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":a.circumference+" "+a.circumference,style:St({strokeDashoffset:i.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":a.stroke,fill:"transparent",r:a.normalizedRadius,cx:a.radius,cy:a.radius},null,12,cb)],8,lb)),ke("div",{class:"vac-progress-content",style:St({height:a.radius*2-19+"px",width:a.radius*2-19+"px"})},[ke("div",ub,[Vn(Qe(n.progress),1),db])],4)],512)]),_:1})}var d1=xt(sb,[["render",fb]]);const mb={name:"MessageFile",components:{SvgIcon:Dt,Loader:ki,ProgressBar:d1},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return this.file.url.indexOf("blob:http")!==-1?!1:this.imageLoading},isImage(){return Zr(this.file)},isVideo(){return Ti(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!Zr(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},hb={class:"vac-message-file-container"},vb={key:0,class:"vac-image-buttons"},pb={controls:""},_b=["src"];function gb(e,t,n,r,a,i){const s=Xe("progress-bar"),l=Xe("loader"),f=Xe("svg-icon");return Q(),se("div",hb,[i.isImage?(Q(),se("div",{key:0,ref:"imageRef"+n.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=u=>a.imageHover=!0),onMouseleave:t[3]||(t[3]=u=>a.imageHover=!1),onClick:t[4]||(t[4]=u=>i.openFile(u,"preview"))},[n.file.progress>=0?(Q(),dt(s,{key:0,progress:n.file.progress,style:St({top:`${a.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(Q(),dt(l,{key:1,show:i.isImageLoading,type:"message-file","message-id":n.message._id,style:St({top:`${a.imageResponsive.loaderTop}px`})},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["show","message-id","style"])),ke("div",{class:nt(["vac-message-image",{"vac-blur-loading":i.isImageLoading&&n.message.senderId===n.currentUserId}]),style:St({"background-image":`url('${i.isImageLoading&&n.file.preview||n.file.url}')`,"max-height":`${a.imageResponsive.maxHeight}px`})},[Oe(It,{name:"vac-fade-image"},{default:Ke(()=>[!n.messageSelectionEnabled&&a.imageHover&&!i.isImageLoading?(Q(),se("div",vb,[ke("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=u=>i.openFile(u,"preview"))},[Re(e.$slots,"eye-icon_"+n.message._id,{},()=>[Oe(f,{name:"eye"})])]),ke("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=u=>i.openFile(u,"download"))},[Re(e.$slots,"document-icon_"+n.message._id,{},()=>[Oe(f,{name:"document"})])])])):Te("",!0)]),_:3})],6)],544)):i.isVideo?(Q(),se("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Rn(u=>i.openFile(u,"preview"),["prevent"]))},[n.file.progress>=0?(Q(),dt(s,{key:0,progress:n.file.progress},null,8,["progress"])):Te("",!0),ke("video",pb,[ke("source",{src:n.file.url},null,8,_b)])])):Te("",!0)])}var bb=xt(mb,[["render",gb]]);const xb={name:"MessageFiles",components:{SvgIcon:Dt,FormatMessage:Mi,ProgressBar:d1,MessageFile:bb},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>zc(e))},otherFiles(){return this.message.files.filter(e=>!zc(e))}},methods:{openFile(e,t,n){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:n}))}}},yb={class:"vac-message-files-container"},wb=["onClick"],kb={class:"vac-svg-button"},Sb={class:"vac-text-ellipsis"},Ab={key:0,class:"vac-text-ellipsis vac-text-extension"};function Mb(e,t,n,r,a,i){const s=Xe("message-file"),l=Xe("progress-bar"),f=Xe("svg-icon"),u=Xe("format-message");return Q(),se("div",yb,[(Q(!0),se(st,null,$e(i.imageVideoFiles,(m,c)=>(Q(),se("div",{key:c+"iv"},[Oe(s,{file:m,"current-user-id":n.currentUserId,message:n.message,index:c,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=b=>e.$emit("open-file",b))},_t({_:2},[$e(e.$slots,(b,_)=>({name:_,fn:Ke(o=>[Re(e.$slots,_,pt(vt(o)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(Q(!0),se(st,null,$e(i.otherFiles,(m,c)=>(Q(),se("div",{key:c+"a",class:"vac-file-wrapper"},[m.progress>=0?(Q(),dt(l,{key:0,progress:m.progress,style:{top:"44px"}},null,8,["progress"])):Te("",!0),ke("div",{class:nt(["vac-file-container",{"vac-file-container-progress":m.progress>=0}]),onClick:b=>i.openFile(b,m,"download")},[ke("div",kb,[Re(e.$slots,"document-icon",{},()=>[Oe(f,{name:"document"})])]),ke("div",Sb,Qe(m.name),1),m.extension?(Q(),se("div",Ab,Qe(m.extension),1)):Te("",!0)],10,wb)]))),128)),Oe(u,{"message-id":n.message._id,content:n.message.content,users:n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:t[1]||(t[1]=m=>e.$emit("open-user-tag",m))},null,8,["message-id","content","users","text-formatting","link-options"])])}var Eb=xt(xb,[["render",Mb]]);const Tb={name:"MessageActions",components:{SvgIcon:Dt,EmojiPickerContainer:Fu},directives:{clickOutside:Ta},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=Lu(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,n=this.$refs.actionIcon.getBoundingClientRect().top;e.getBoundingClientRect().top-n>t+50?this.menuOptionsTop=30:this.menuOptionsTop=-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},Rb={class:"vac-message-actions-wrapper"},Cb={key:"3"},Ib={class:"vac-menu-list"},Bb=["onClick"];function Ob(e,t,n,r,a,i){const s=Xe("svg-icon"),l=Xe("emoji-picker-container"),f=ma("click-outside");return Q(),se("div",Rb,[ke("div",{class:"vac-options-container",style:St({display:n.hoverAudioProgress?"none":"initial",width:i.filteredMessageActions.length&&n.showReactionEmojis?"70px":"45px"})},[Oe(Js,{name:"vac-slide-left",tag:"span"},{default:Ke(()=>[i.isMessageActions||i.isMessageReactions?(Q(),se("div",{key:"1",class:nt(["vac-blur-container",{"vac-options-me":n.message.senderId===n.currentUserId}])},null,2)):Te("",!0),i.isMessageActions?(Q(),se("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...u)=>i.openOptions&&i.openOptions(...u))},[Re(e.$slots,"dropdown-icon_"+n.message._id,{},()=>[Oe(s,{name:"dropdown",param:"message"})])],512)):Te("",!0),i.isMessageReactions?Pn((Q(),se("div",Cb,[Re(e.$slots,"emoji-picker",Us({emojiOpened:a.emojiOpened},{addEmoji:i.sendMessageReaction}),()=>[Oe(l,{class:"vac-message-emojis",style:St({right:i.isMessageActions?"30px":"5px"}),"emoji-opened":a.emojiOpened,"emoji-reaction":!0,"position-right":n.message.senderId===n.currentUserId,"message-id":n.message._id,"emoji-data-source":n.emojiDataSource,onAddEmoji:i.sendMessageReaction,onOpenEmoji:i.openEmoji},_t({_:2},[$e(e.$slots,(u,m)=>({name:m,fn:Ke(c=>[Re(e.$slots,m,pt(vt(c)))])}))]),1032,["style","emoji-opened","position-right","message-id","emoji-data-source","onAddEmoji","onOpenEmoji"])])])),[[f,i.closeEmoji]]):Te("",!0)]),_:3})],4),i.filteredMessageActions.length?(Q(),dt(It,{key:0,name:n.message.senderId===n.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Ke(()=>[a.optionsOpened?Pn((Q(),se("div",{key:0,ref:"menuOptions",class:nt(["vac-menu-options",{"vac-menu-left":n.message.senderId!==n.currentUserId}]),style:St({top:`${a.menuOptionsTop}px`})},[ke("div",Ib,[(Q(!0),se(st,null,$e(i.filteredMessageActions,u=>(Q(),se("div",{key:u.name},[ke("div",{class:"vac-menu-item",onClick:m=>i.messageActionHandler(u)},Qe(u.title),9,Bb)]))),128))])],6)),[[f,i.closeOptions]]):Te("",!0)]),_:1},8,["name"])):Te("",!0)])}var Lb=xt(Tb,[["render",Ob]]);const Fb={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},jb=["onClick"];function Nb(e,t,n,r,a,i){return n.message.deleted?Te("",!0):(Q(),dt(Js,{key:0,name:"vac-slide-left",tag:"span"},{default:Ke(()=>[(Q(!0),se(st,null,$e(n.message.reactions,(s,l)=>Pn((Q(),se("button",{key:l+0,class:nt(["vac-button-reaction",{"vac-reaction-me":s.indexOf(n.currentUserId)!==-1}]),style:St({float:n.message.senderId===n.currentUserId?"right":"left"}),onClick:f=>i.sendMessageReaction({unicode:l},s)},[Vn(Qe(l),1),ke("span",null,Qe(s.length),1)],14,jb)),[[xa,s.length]])),128))]),_:1}))}var Db=xt(Fb,[["render",Nb]]);function Hb(e){if(!((r,a)=>a.every(i=>{let s=!1;return(i.type[0]==="array"&&Array.isArray(r[i.key])||i.type.find(l=>l===typeof r[i.key]))&&(s=!0),s&&qo(r,i.key)}))(e,[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}]))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function zb(e){if(!((r,a)=>a.every(i=>i.type.find(l=>l===typeof r[i.key])&&qo(r,i.key)))(e,[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}]))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function Pb(e){if(!((r,a)=>a.every(i=>i.type.find(l=>l===typeof r[i.key])&&qo(r,i.key)))(e,[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}]))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function qo(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==null&&e[t]!==void 0}const Vb={name:"RoomMessage",components:{SvgIcon:Dt,FormatMessage:Mi,AudioPlayer:Lo,MessageReply:ab,MessageFiles:Eb,MessageActions:Lb,MessageReactions:Db,Loader:ki},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId?!1:this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isSticker(){return this.message.sticker===!0},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return(e=this.message.files)==null?void 0:e.some(t=>Ra(t))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){if(!e.length||!this.showNewMessagesDivider){this.newMessage={};return}this.newMessage=e.reduce((t,n)=>n.index<t.index?n:t)}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){Pb(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&t.indexOf(this.currentUserId)!==-1}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},Ub=["id"],qb={key:0,class:"vac-card-info vac-card-date"},Xb={key:1,class:"vac-line-new"},Yb={key:2,class:"vac-card-info vac-card-system"},Kb={key:1,class:"vac-avatar-offset"},Gb={key:0,class:"vac-progress-time"},Wb={class:"vac-text-timestamp"},Zb={key:0,class:"vac-icon-edited"},Qb={key:1,class:"vac-icon-safe"},Jb={key:2,class:"vac-icon-unsafe"},$b={key:3},e5=[ke("div",{class:"vac-failure-text"},"!",-1)],t5={key:3,class:"vac-avatar-current-offset"};function n5(e,t,n,r,a,i){const s=Xe("format-message"),l=Xe("message-reply"),f=Xe("loader"),u=Xe("message-files"),m=Xe("audio-player"),c=Xe("svg-icon"),b=Xe("message-actions"),_=Xe("message-reactions");return Q(),se("div",{id:n.message._id,ref:"message",class:"vac-message-wrapper"},[i.showDate?(Q(),se("div",qb,Qe(n.message.date),1)):Te("",!0),a.newMessage._id===n.message._id?(Q(),se("div",Xb,Qe(n.textMessages.NEW_MESSAGES),1)):Te("",!0),n.message.system?(Q(),se("div",Yb,[Re(e.$slots,"message_"+n.message._id,{},()=>[Oe(s,{"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-messages":n.textMessages,"text-formatting":n.textFormatting,"link-options":n.linkOptions,onOpenUserTag:i.openUserTag},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(Q(),se("div",{key:3,class:nt(["vac-message-box",{"vac-offset-current":n.message.senderId===n.currentUserId}]),onClick:t[8]||(t[8]=(...o)=>i.selectMessage&&i.selectMessage(...o))},[Re(e.$slots,"message_"+n.message._id,{},()=>[n.message.senderId!==n.currentUserId?Re(e.$slots,"message-avatar_"+n.message._id,{key:0},()=>[n.message.avatar?(Q(),se("div",{key:0,class:"vac-avatar",style:St({"background-image":`url('${n.message.avatar}')`})},null,4)):Te("",!0)]):Te("",!0),i.hasSenderUserAvatar&&!n.message.avatar?(Q(),se("div",Kb)):Te("",!0),ke("div",{class:nt(["vac-message-container",{"vac-message-container-offset":i.messageOffset}])},[ke("div",{class:nt(["vac-message-card",{"vac-message-highlight":i.isMessageHover,"vac-message-current":n.message.senderId===n.currentUserId&&!i.isSticker,"vac-message-deleted":n.message.deleted,"vac-item-clickable":n.messageSelectionEnabled,"vac-message-selected":i.isMessageSelected,"vac-message-sticker":i.isSticker}]),onMouseover:t[5]||(t[5]=(...o)=>i.onHoverMessage&&i.onHoverMessage(...o)),onMouseleave:t[6]||(t[6]=(...o)=>i.onLeaveMessage&&i.onLeaveMessage(...o))},[i.showUsername?(Q(),se("div",{key:0,class:nt(["vac-text-username",{"vac-username-reply":!n.message.deleted&&n.message.replyMessage}])},[ke("span",null,Qe(n.message.username),1)],2)):Te("",!0),!n.message.deleted&&n.message.replyMessage?(Q(),dt(l,{key:1,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Te("",!0),n.message.loading===!0?(Q(),dt(f,{key:2,show:n.message.loading===!0,infinite:!0,type:"infinite-messages",style:{height:"50px",width:"50px",position:"relative",left:"0",right:"0",transform:"none"}},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["show"])):Te("",!0),!!n.message.deleted||!n.message.files||!n.message.files.length?(Q(),dt(s,{key:3,"message-id":n.message._id,content:n.message.content,deleted:!!n.message.deleted,users:n.roomUsers,"text-formatting":n.textFormatting,"text-messages":n.textMessages,"link-options":n.linkOptions,onOpenUserTag:i.openUserTag},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])):!i.isAudio||n.message.files.length>1?(Q(),dt(u,{key:4,"current-user-id":n.currentUserId,message:n.message,"room-users":n.roomUsers,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"message-selection-enabled":n.messageSelectionEnabled,onOpenFile:i.openFile,onOpenUserTag:i.openUserTag},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Q(),se(st,{key:5},[Oe(m,{"message-id":n.message._id,src:n.message.files[0].url,"message-selection-enabled":n.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=o=>a.progressTime=o),onHoverAudioProgress:t[1]||(t[1]=o=>a.hoverAudioProgress=o)},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["message-id","src","message-selection-enabled"]),n.message.deleted?Te("",!0):(Q(),se("div",Gb,Qe(a.progressTime),1))],64)),ke("div",Wb,[n.message.edited&&!n.message.deleted?(Q(),se("div",Zb,[Re(e.$slots,"pencil-icon_"+n.message._id,{},()=>[Oe(c,{name:"pencil"})])])):Te("",!0),n.message.encrypted===!0?(Q(),se("div",Qb,[Re(e.$slots,"safe-icon_"+n.message._id,{},()=>[Oe(c,{name:"safe"})])])):Te("",!0),n.message.encrypted===!1?(Q(),se("div",Jb,[Re(e.$slots,"safe-icon_"+n.message._id,{},()=>[Oe(c,{name:"unsafe"})])])):Te("",!0),ke("span",null,Qe(n.message.timestamp),1),i.isCheckmarkVisible?(Q(),se("span",$b,[Re(e.$slots,"checkmark-icon_"+n.message._id,{},()=>[Oe(c,{name:n.message.distributed?"double-checkmark":"checkmark",param:n.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Te("",!0)]),Oe(b,{"current-user-id":n.currentUserId,message:n.message,"message-actions":n.messageActions,"show-reaction-emojis":n.showReactionEmojis,"message-hover":a.messageHover,"hover-message-id":a.hoverMessageId,"hover-audio-progress":a.hoverAudioProgress,"emoji-data-source":n.emojiDataSource,onUpdateMessageHover:t[2]||(t[2]=o=>a.messageHover=o),onUpdateOptionsOpened:t[3]||(t[3]=o=>a.optionsOpened=o),onUpdateEmojiOpened:t[4]||(t[4]=o=>a.emojiOpened=o),onMessageActionHandler:i.messageActionHandler,onSendMessageReaction:i.sendMessageReaction},_t({_:2},[$e(e.$slots,(o,B)=>({name:B,fn:Ke(T=>[Re(e.$slots,B,pt(vt(T)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","onMessageActionHandler","onSendMessageReaction"])],34),Oe(_,{"current-user-id":n.currentUserId,message:n.message,onSendMessageReaction:i.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Re(e.$slots,"message-failure_"+n.message._id,{},()=>[n.message.failure&&n.message.senderId===n.currentUserId?(Q(),se("div",{key:0,class:nt(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":n.message.avatar&&n.message.senderId===n.currentUserId}]),onClick:t[7]||(t[7]=o=>e.$emit("open-failed-message",{message:n.message}))},e5,2)):Te("",!0)]),n.message.senderId===n.currentUserId?Re(e.$slots,"message-avatar_"+n.message._id,{key:2},()=>[n.message.avatar?(Q(),se("div",{key:0,class:"vac-avatar vac-avatar-current",style:St({"background-image":`url('${n.message.avatar}')`})},null,4)):Te("",!0)]):Te("",!0),i.hasCurrentUserAvatar&&!n.message.avatar?(Q(),se("div",t5)):Te("",!0)])],2))],8,Ub)}var r5=xt(Vb,[["render",n5]]);const i5={name:"ChatRoom",components:{Loader:ki,SvgIcon:Dt,RoomHeader:Wp,RoomFooter:Y4,RoomMessage:r5},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((n,r)=>{this.showNewMessagesDivider&&!n.seen&&n.senderId!==this.currentUserId&&this.newMessages.push({_id:n._id,index:r})}),(t==null?void 0:t.length)===(e==null?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(n=>{n[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,n=new ResizeObserver(a=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),n.disconnect())});for(var r=0;r<e.children.length;r++)n.observe(e.children[r])},touchStart(e){if(!this.singleRoom&&e.changedTouches.length===1){const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;addEventListener("touchend",r=>this.touchEnd(r,t,n),{once:!0})}},touchEnd(e,t,n){if(e.changedTouches.length===1){const r=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,i=r-t>100,s=Math.abs(a-n)>50;i&&!s&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const n=this.$refs.scrollContainer;!n||(e(),setTimeout(()=>{n.scrollTo({top:n.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:n}){if(t!==this.messages.length-1)return;const r=n.offsetHeight+60;setTimeout(()=>{const a=this.$refs.scrollContainer;let i=!1;a&&(i=this.getBottomScroll(a)>r),e.senderId===this.currentUserId?i?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():i?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId){this.loadingMoreMessages=!1,this.showLoader=!1;return}this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":this.initReplyMessage=t,setTimeout(()=>{this.initReplyMessage=null});return;case"editMessage":this.initEditMessage=t,setTimeout(()=>{this.initEditMessage=null});return;case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":this.selectedMessages=[t],this.messageSelectionEnabled=!0;return;default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:n,scrollTop:r}=e;return t-n-r},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e&&(e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth")))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},a5={class:"vac-container-center vac-room-empty"},s5={class:"vac-messages-container"},o5={key:0,class:"vac-text-started"},l5={key:1,class:"vac-text-started"},c5={key:0,id:"infinite-loader-messages"},u5={key:2},d5={key:0,class:"vac-badge-counter vac-messages-count"};function f5(e,t,n,r,a,i){const s=Xe("room-header"),l=Xe("loader"),f=Xe("room-message"),u=Xe("svg-icon"),m=Xe("room-footer");return Pn((Q(),se("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Rn((...c)=>i.onDropFiles&&i.onDropFiles(...c),["prevent"])),onDragenter:t[13]||(t[13]=Rn(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Rn(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Rn(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...c)=>i.touchStart&&i.touchStart(...c))},[i.showNoRoom?Re(e.$slots,"no-room-selected",{key:0},()=>[ke("div",a5,[ke("div",null,Qe(n.textMessages.ROOM_EMPTY),1)])]):(Q(),dt(s,{key:1,"current-user-id":n.currentUserId,"text-messages":n.textMessages,"single-room":n.singleRoom,"show-rooms-list":n.showRoomsList,"is-mobile":n.isMobile,"room-info-enabled":n.roomInfoEnabled,"menu-actions":n.menuActions,room:i.room,"message-selection-enabled":a.messageSelectionEnabled,"message-selection-actions":n.messageSelectionActions,"selected-messages-total":a.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=c=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=c=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=c=>e.$emit("menu-action-handler",c)),onMessageSelectionActionHandler:i.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=c=>a.messageSelectionEnabled=!1)},_t({_:2},[$e(e.$slots,(c,b)=>({name:b,fn:Ke(_=>[Re(e.$slots,b,pt(vt(_)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])),ke("div",{id:"messages-list",ref:"scrollContainer",class:"vac-container-scroll",onScroll:t[5]||(t[5]=(...c)=>i.onContainerScroll&&i.onContainerScroll(...c))},[Oe(l,{show:a.loadingMessages,type:"messages"},_t({_:2},[$e(e.$slots,(c,b)=>({name:b,fn:Ke(_=>[Re(e.$slots,b,pt(vt(_)))])}))]),1032,["show"]),ke("div",s5,[ke("div",{class:nt({"vac-messages-hidden":a.loadingMessages})},[Oe(It,{name:"vac-fade-message"},{default:Ke(()=>[ke("div",null,[i.showNoMessages?(Q(),se("div",o5,[Re(e.$slots,"messages-empty",{},()=>[Vn(Qe(n.textMessages.MESSAGES_EMPTY),1)])])):Te("",!0),i.showMessagesStarted?(Q(),se("div",l5,Qe(n.textMessages.CONVERSATION_STARTED)+" "+Qe(n.messages[0].date),1)):Te("",!0)])]),_:3}),n.messages.length&&!n.messagesLoaded?(Q(),se("div",c5,[Oe(l,{show:!0,infinite:!0,type:"infinite-messages"},_t({_:2},[$e(e.$slots,(c,b)=>({name:b,fn:Ke(_=>[Re(e.$slots,b,pt(vt(_)))])}))]),1024)])):Te("",!0),(Q(),dt(Js,{key:n.roomId,name:"vac-fade-message",tag:"span"},{default:Ke(()=>[(Q(!0),se(st,null,$e(n.messages,(c,b)=>(Q(),se("div",{key:c.indexId||c._id},[Oe(f,{"current-user-id":n.currentUserId,message:c,index:b,messages:n.messages,"edited-message-id":a.editedMessageId,"message-actions":n.messageActions,"room-users":i.room.users,"text-messages":n.textMessages,"new-messages":a.newMessages,"show-reaction-emojis":n.showReactionEmojis,"show-new-messages-divider":n.showNewMessagesDivider,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"username-options":n.usernameOptions,"message-selection-enabled":a.messageSelectionEnabled,"selected-messages":a.selectedMessages,"emoji-data-source":n.emojiDataSource,onMessageAdded:i.onMessageAdded,onMessageActionHandler:i.messageActionHandler,onOpenFile:i.openFile,onOpenUserTag:i.openUserTag,onOpenFailedMessage:t[4]||(t[4]=_=>e.$emit("open-failed-message",_)),onSendMessageReaction:i.sendMessageReaction,onSelectMessage:i.selectMessage,onUnselectMessage:i.unselectMessage},_t({_:2},[$e(e.$slots,(_,o)=>({name:o,fn:Ke(B=>[Re(e.$slots,o,pt(vt(B)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],544),a.loadingMessages?Te("",!0):(Q(),se("div",u5,[Oe(It,{name:"vac-bounce"},{default:Ke(()=>[a.scrollIcon?(Q(),se("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...c)=>i.scrollToBottom&&i.scrollToBottom(...c))},[Oe(It,{name:"vac-bounce"},{default:Ke(()=>[a.scrollMessagesCount?(Q(),se("div",d5,Qe(a.scrollMessagesCount),1)):Te("",!0)]),_:1}),Re(e.$slots,"scroll-icon",{},()=>[Oe(u,{name:"dropdown",param:"scroll"})])])):Te("",!0)]),_:3})])),Oe(m,{room:i.room,"room-id":n.roomId,"room-message":n.roomMessage,"text-messages":n.textMessages,"show-send-icon":n.showSendIcon,"show-files":n.showFiles,"show-audio":n.showAudio,"show-emojis":n.showEmojis,"show-footer":n.showFooter,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"textarea-action-enabled":n.textareaActionEnabled,"textarea-auto-focus":n.textareaAutoFocus,"user-tags-enabled":n.userTagsEnabled,"emojis-suggestion-enabled":n.emojisSuggestionEnabled,"templates-text":n.templatesText,"text-formatting":n.textFormatting,"link-options":n.linkOptions,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"init-reply-message":a.initReplyMessage,"init-edit-message":a.initEditMessage,"dropped-files":a.droppedFiles,"emoji-data-source":n.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=c=>a.editedMessageId=c),onEditMessage:t[8]||(t[8]=c=>e.$emit("edit-message",c)),onSendMessage:t[9]||(t[9]=c=>e.$emit("send-message",c)),onTypingMessage:t[10]||(t[10]=c=>e.$emit("typing-message",c)),onTextareaActionHandler:t[11]||(t[11]=c=>e.$emit("textarea-action-handler",c))},_t({_:2},[$e(e.$slots,(c,b)=>({name:b,fn:Ke(_=>[Re(e.$slots,b,pt(vt(_)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","capture-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[xa,n.isMobile&&!n.showRoomsList||!n.isMobile||n.singleRoom]])}var m5=xt(i5,[["render",f5]]);const h5={name:"MediaPreview",components:{SvgIcon:Dt},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return Zr(this.file)},isVideo(){return Ti(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},v5={key:0,class:"vac-media-preview-container"},p5={key:1,class:"vac-media-preview-container"},_5={controls:"",autoplay:""},g5=["src"],b5={class:"vac-svg-button"};function x5(e,t,n,r,a,i){const s=Xe("svg-icon");return Q(),se("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Rn((...l)=>i.closeModal&&i.closeModal(...l),["stop"])),onKeydown:t[1]||(t[1]=wr((...l)=>i.closeModal&&i.closeModal(...l),["esc"]))},[Oe(It,{name:"vac-bounce-preview",appear:""},{default:Ke(()=>[i.isImage?(Q(),se("div",v5,[ke("div",{class:"vac-image-preview",style:St({"background-image":`url('${n.file.url}')`})},null,4)])):i.isVideo?(Q(),se("div",p5,[ke("video",_5,[ke("source",{src:n.file.url},null,8,g5)])])):Te("",!0)]),_:1}),ke("div",b5,[Re(e.$slots,"preview-close-icon",{},()=>[Oe(s,{name:"close-outline",param:"preview"})])])],544)}var y5=xt(h5,[["render",x5]]),w5={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const k5={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",colorTimestampUnsafe:"#ff0000",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",colorTimestampUnsafe:"#ff0000",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},S5=({general:e,container:t,header:n,footer:r,sidemenu:a,content:i,dropdown:s,message:l,markdown:f,room:u,emoji:m,icons:c})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":n.background,"--chat-header-color-name":n.colorRoomName,"--chat-header-color-info":n.colorRoomInfo,"--chat-footer-bg-color":r.background,"--chat-border-style-input":r.borderStyleInput,"--chat-border-color-input-selected":r.borderInputSelected,"--chat-footer-bg-color-reply":r.backgroundReply,"--chat-footer-bg-color-tag-active":r.backgroundTagActive,"--chat-footer-bg-color-tag":r.backgroundTag,"--chat-content-bg-color":i.background,"--chat-sidemenu-bg-color":a.background,"--chat-sidemenu-bg-color-hover":a.backgroundHover,"--chat-sidemenu-bg-color-active":a.backgroundActive,"--chat-sidemenu-color-active":a.colorActive,"--chat-sidemenu-border-color-search":a.borderColorSearch,"--chat-dropdown-bg-color":s.background,"--chat-dropdown-bg-color-hover":s.backgroundHover,"--chat-message-bg-color":l.background,"--chat-message-bg-color-me":l.backgroundMe,"--chat-message-color-started":l.colorStarted,"--chat-message-bg-color-deleted":l.backgroundDeleted,"--chat-message-bg-color-selected":l.backgroundSelected,"--chat-message-color-deleted":l.colorDeleted,"--chat-message-color-username":l.colorUsername,"--chat-message-color-timestamp":l.colorTimestamp,"--chat-message-color-timestamp-unsafe":l.colorTimestampUnsafe,"--chat-message-bg-color-date":l.backgroundDate,"--chat-message-color-date":l.colorDate,"--chat-message-bg-color-system":l.backgroundSystem,"--chat-message-color-system":l.colorSystem,"--chat-message-color":l.color,"--chat-message-bg-color-media":l.backgroundMedia,"--chat-message-bg-color-reply":l.backgroundReply,"--chat-message-color-reply-username":l.colorReplyUsername,"--chat-message-color-reply-content":l.colorReply,"--chat-message-color-tag":l.colorTag,"--chat-message-bg-color-image":l.backgroundImage,"--chat-message-color-new-messages":l.colorNewMessages,"--chat-message-bg-color-scroll-counter":l.backgroundScrollCounter,"--chat-message-color-scroll-counter":l.colorScrollCounter,"--chat-message-bg-color-reaction":l.backgroundReaction,"--chat-message-border-style-reaction":l.borderStyleReaction,"--chat-message-bg-color-reaction-hover":l.backgroundReactionHover,"--chat-message-border-style-reaction-hover":l.borderStyleReactionHover,"--chat-message-color-reaction-counter":l.colorReactionCounter,"--chat-message-bg-color-reaction-me":l.backgroundReactionMe,"--chat-message-border-style-reaction-me":l.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":l.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":l.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":l.colorReactionCounterMe,"--chat-message-bg-color-audio-record":l.backgroundAudioRecord,"--chat-message-bg-color-audio-line":l.backgroundAudioLine,"--chat-message-bg-color-audio-progress":l.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":l.backgroundAudioProgressSelector,"--chat-message-color-file-extension":l.colorFileExtension,"--chat-markdown-bg":f.background,"--chat-markdown-border":f.border,"--chat-markdown-color":f.color,"--chat-markdown-color-multi":f.colorMulti,"--chat-room-color-username":u.colorUsername,"--chat-room-color-message":u.colorMessage,"--chat-room-color-timestamp":u.colorTimestamp,"--chat-room-color-online":u.colorStateOnline,"--chat-room-color-offline":u.colorStateOffline,"--chat-room-bg-color-badge":u.backgroundCounterBadge,"--chat-room-color-badge":u.colorCounterBadge,"--chat-emoji-bg-color":m.background,"--chat-icon-color-search":c.search,"--chat-icon-color-add":c.add,"--chat-icon-color-toggle":c.toggle,"--chat-icon-color-menu":c.menu,"--chat-icon-color-close":c.close,"--chat-icon-color-close-image":c.closeImage,"--chat-icon-color-file":c.file,"--chat-icon-color-paperclip":c.paperclip,"--chat-icon-color-close-outline":c.closeOutline,"--chat-icon-color-close-preview":c.closePreview,"--chat-icon-color-send":c.send,"--chat-icon-color-send-disabled":c.sendDisabled,"--chat-icon-color-emoji":c.emoji,"--chat-icon-color-emoji-reaction":c.emojiReaction,"--chat-icon-color-document":c.document,"--chat-icon-color-pencil":c.pencil,"--chat-icon-color-checkmark":c.checkmark,"--chat-icon-color-checkmark-seen":c.checkmarkSeen,"--chat-icon-color-eye":c.eye,"--chat-icon-color-dropdown-message":c.dropdownMessage,"--chat-icon-bg-dropdown-message":c.dropdownMessageBackground,"--chat-icon-color-dropdown-room":c.dropdownRoom,"--chat-icon-color-dropdown-scroll":c.dropdownScroll,"--chat-icon-color-microphone":c.microphone,"--chat-icon-color-audio-play":c.audioPlay,"--chat-icon-color-audio-pause":c.audioPause,"--chat-icon-color-audio-cancel":c.audioCancel,"--chat-icon-color-audio-confirm":c.audioConfirm});var A5=`.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}@keyframes move-bg{0%{background-position:0% center}to{background-position:200% center}}@keyframes blink{50%{opacity:0}}@keyframes shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}.markdown p{margin:0}.markdown ol{display:flex;flex-direction:column;list-style-position:inside}.markdown ul{display:flex;flex-direction:column}.markdown code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.markdown p code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.markdown img,.markdown p>img{max-width:200px;max-height:200px}.markdown .vac-effects-rainbow{background:linear-gradient(to right,rgb(252,104,110),rgb(255,255,110),rgb(155,255,110),rgb(252,102,255),rgb(153,100,255),rgb(114,255,255),rgb(252,104,110));background-size:200% 200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;-webkit-animation:move-bg 3s linear infinite;animation:move-bg 3s linear infinite;animation-direction:reverse;margin:0}.markdown .vac-effects-blink{-webkit-animation:blink 1s linear infinite;animation:blink 1s steps(1,end) infinite;margin:0}.markdown .vac-effects-gold{background:linear-gradient(to right,#FEDB37,#FDB931,#9f7928,#8A6E2F,#FEDB37);background-size:200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;-webkit-animation:move-bg 3s linear infinite;animation:move-bg 3s linear infinite;animation-direction:reverse;margin:0}.markdown .vac-effects-bronze{background:linear-gradient(to right,#ffdeca,#ca7345,#a14521,#732100,#ffdeca);background-size:200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;-webkit-animation:move-bg 3s linear infinite;animation:move-bg 3s linear infinite;animation-direction:reverse;margin:0}.markdown .vac-effects-silver{background:linear-gradient(to right,#fff,#555,#555,#555,#fff);background-size:200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;-webkit-animation:move-bg 3s linear infinite;animation:move-bg 3s linear infinite;animation-direction:reverse;margin:0}.markdown .vac-effects-shake{display:inline-flex;margin:0}.markdown .vac-effects-shake-letter{animation:shake .5s linear infinite}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:99;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;width:calc(100% - 30px)}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{margin-left:auto}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-message-sticker{background-color:transparent!important;box-shadow:none!important}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;max-width:50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:100px;box-sizing:content-box}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{margin-left:50%;justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited,.vac-message-wrapper .vac-icon-safe,.vac-message-wrapper .vac-icon-unsafe{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg,.vac-message-wrapper .vac-icon-safe svg,.vac-message-wrapper .vac-icon-unsafe svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-safe{fill:var(--chat-message-color-timestamp)}.vac-message-wrapper .vac-icon-unsafe{fill:var(--chat-message-color-timestamp-unsafe)}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%;max-width:80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-offset-current{margin-left:20%}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px}.vac-player-bar .vac-player-progress{width:190px}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line)}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}
`;const M5={name:"ChatContainer",components:{RoomsList:Op,Room:m5,MediaPreview:y5},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},captureFiles:{type:String,default:void 0},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...w5,...this.textMessagesCasted}},cssVars(){const e=k5[this.theme],t={};return Object.keys(e).map(n=>{t[n]={...e[n],...this.stylesCasted[n]||{}}}),S5(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const n=e.index||0,r=t.index||0;return this.roomsOrder==="asc"?n<r?-1:r<n?1:0:n>r?-1:r>n?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if((!e[0]||!e.find(n=>n.roomId===this.room.roomId))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const n=e.find(r=>r.roomId===this.roomId)||{};this.fetchRoom({room:n})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const n=this.roomsCasted.find(r=>r.roomId===e);this.fetchRoom({room:n})}else t&&!e&&(this.room={})}},room(e){!e||Object.entries(e).length===0||(Hb(e),e.users.forEach(t=>{zb(t)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return e==="true"||e===!0},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?typeof e=="object"?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&t.action==="preview"?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},E5={class:"vac-chat-container"};function T5(e,t,n,r,a,i){const s=Xe("rooms-list"),l=Xe("room"),f=Xe("media-preview");return Q(),se("div",{class:"vac-card-window",style:St([{height:n.height},i.cssVars])},[ke("div",E5,[i.singleRoomCasted?Te("",!0):(Q(),dt(s,{key:0,"current-user-id":n.currentUserId,rooms:i.orderedRooms,"loading-rooms":i.loadingRoomsCasted,"rooms-loaded":i.roomsLoadedCasted,room:a.room,"room-actions":i.roomActionsCasted,"custom-search-room-enabled":n.customSearchRoomEnabled,"text-messages":i.t,"show-search":i.showSearchCasted,"show-add-room":i.showAddRoomCasted,"show-rooms-list":a.showRoomsList&&i.roomsListOpenedCasted,"text-formatting":i.textFormattingCasted,"link-options":i.linkOptionsCasted,"is-mobile":a.isMobile,"scroll-distance":n.scrollDistance,onFetchRoom:i.fetchRoom,onFetchMoreRooms:i.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=u=>a.loadingMoreRooms=u),onAddRoom:i.addRoom,onSearchRoom:i.searchRoom,onRoomActionHandler:i.roomActionHandler},_t({_:2},[$e(a.slots,u=>({name:u.slot,fn:Ke(m=>[Re(e.$slots,u.slot,pt(vt(m)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Oe(l,{"current-user-id":n.currentUserId,rooms:i.roomsCasted,"room-id":a.room.roomId||"","load-first-room":i.loadFirstRoomCasted,messages:i.messagesCasted,"room-message":n.roomMessage,"messages-loaded":i.messagesLoadedCasted,"menu-actions":i.menuActionsCasted,"message-actions":i.messageActionsCasted,"message-selection-actions":i.messageSelectionActionsCasted,"auto-scroll":i.autoScrollCasted,"show-send-icon":i.showSendIconCasted,"show-files":i.showFilesCasted,"show-audio":i.showAudioCasted,"audio-bit-rate":n.audioBitRate,"audio-sample-rate":n.audioSampleRate,"show-emojis":i.showEmojisCasted,"show-reaction-emojis":i.showReactionEmojisCasted,"show-new-messages-divider":i.showNewMessagesDividerCasted,"show-footer":i.showFooterCasted,"text-messages":i.t,"single-room":i.singleRoomCasted,"show-rooms-list":a.showRoomsList&&i.roomsListOpenedCasted,"text-formatting":i.textFormattingCasted,"link-options":i.linkOptionsCasted,"is-mobile":a.isMobile,"loading-rooms":i.loadingRoomsCasted,"room-info-enabled":i.roomInfoEnabledCasted,"textarea-action-enabled":i.textareaActionEnabledCasted,"textarea-auto-focus":i.textareaAutoFocusCasted,"user-tags-enabled":i.userTagsEnabledCasted,"emojis-suggestion-enabled":i.emojisSuggestionEnabledCasted,"scroll-distance":n.scrollDistance,"accepted-files":n.acceptedFiles,"capture-files":n.captureFiles,"templates-text":i.templatesTextCasted,"username-options":i.usernameOptionsCasted,"emoji-data-source":n.emojiDataSource,onToggleRoomsList:i.toggleRoomsList,onRoomInfo:i.roomInfo,onFetchMessages:i.fetchMessages,onSendMessage:i.sendMessage,onEditMessage:i.editMessage,onDeleteMessage:i.deleteMessage,onOpenFile:i.openFile,onOpenUserTag:i.openUserTag,onOpenFailedMessage:i.openFailedMessage,onMenuActionHandler:i.menuActionHandler,onMessageActionHandler:i.messageActionHandler,onMessageSelectionActionHandler:i.messageSelectionActionHandler,onSendMessageReaction:i.sendMessageReaction,onTypingMessage:i.typingMessage,onTextareaActionHandler:i.textareaActionHandler},_t({_:2},[$e(a.slots,u=>({name:u.slot,fn:Ke(m=>[Re(e.$slots,u.slot,pt(vt(m)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","capture-files","templates-text","username-options","emoji-data-source","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Oe(It,{name:"vac-fade-preview",appear:""},{default:Ke(()=>[a.showMediaPreview?(Q(),dt(f,{key:0,file:a.previewFile,onCloseMediaPreview:t[1]||(t[1]=u=>a.showMediaPreview=!1)},_t({_:2},[$e(a.slots,u=>({name:u.slot,fn:Ke(m=>[Re(e.$slots,u.slot,pt(vt(m)))])}))]),1032,["file"])):Te("",!0)]),_:3})],4)}var R5=xt(M5,[["render",T5],["styles",[A5]]]);const f1=Jf(R5),m1="vue-advanced-chat";function C5(){customElements.get(m1)||customElements.define(m1,f1)}fr.VueAdvancedChat=f1,fr.register=C5,Object.defineProperties(fr,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
